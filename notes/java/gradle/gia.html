<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>gia</title>
<!-- 2017-05-02 Tue 10:49 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="your name" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>

         <link href="http://fonts.googleapis.com/css?family=Droid+Sans+Mono|Galdeano|Open+Sans:600italic,400,600|Roboto+Condensed:400,700" rel="stylesheet" type="text/css">
         <link rel="stylesheet" type="text/css" href="/static/css/main.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="http://harrifeng.github.io/sitemap.html"> UP </a>
 |
 <a accesskey="H" href="http://harrifeng.github.io/index.html"> HOME </a>
</div><div id="preamble" class="status">

         <div id="header">
            <div id="header-top">
                <div id="blog-title">Harrifeng's Path</div>
                <div id="blog-sub-title">纸上得来终觉浅,绝知此事要Coding</div>
            </div>
            <div id="nav">
                <ul>
                    <li><a href="/">首页</a></li>
                    <li><a href="/about.html">About Me</a></li>
                    <li>
                    </li>
                </ul>
            </div>
         </div>
</div>
<div id="content">
<h1 class="title">gia</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Chapter 01: Introduction to project automation</a>
<ul>
<li><a href="#sec-1-1">Life without project automation</a></li>
<li><a href="#sec-1-2">Benefits of project automation</a></li>
<li><a href="#sec-1-3">Types of project automation</a></li>
<li><a href="#sec-1-4">Build tools</a>
<ul>
<li><a href="#sec-1-4-1">What's a build tool?</a></li>
</ul>
</li>
<li><a href="#sec-1-5">Java build tools</a>
<ul>
<li><a href="#sec-1-5-1">Apache Ant</a></li>
<li><a href="#sec-1-5-2">Apache Maven</a></li>
<li><a href="#sec-1-5-3">Requirement for a next-generation build tool</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-2">Chapter 02: Next-generation builds with Grale</a>
<ul>
<li><a href="#sec-2-1">Gradle is Groovy</a></li>
<li><a href="#sec-2-2">Getting started with Gradle</a></li>
<li><a href="#sec-2-3">Listing available tasks of a project</a>
<ul>
<li><a href="#sec-2-3-1">Task execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">Chapter 03: Building a Gradle project by example</a>
<ul>
<li><a href="#sec-3-1">Introducing the case study</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Chapter 01: Introduction to project automation</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Life without project automation</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>太依赖IDE会导致项目的port不太好处理,测试部署都是难题
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Benefits of project automation</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>使用类似ant和maven一类的project automation工具的好处如下:
<ul class="org-ul">
<li>不再用自己手动的发布产品,因为那很容易出错
</li>
<li>能够重复很多常用操作,比如项目总是先编译,然后测试,然后发布.写好automation
工具每次重复就好了
</li>
<li>使得你的build更容易port,而不仅仅是在IDE里面工作
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Types of project automation</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>就算是automation,也分好几种:
<ul class="org-ul">
<li>On-demand builds: 通常是用户在command line里面触动某些脚本来开始一个测试
</li>
<li>Triggered builds: 通常是每次有代码提交,都会触发一次的编译以及测试
</li>
<li>Scheduled builds: 编译测试主代码库总是在特定的时间,比如每天早上1点,或者没
15分钟进行一次.
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">Build tools</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>前面说的系统,完全可以用shell script实现,但是这个东西不太容易从Unix port到
Windows
</li>
</ul>
</div>
<div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1">What's a build tool?</h4>
<div class="outline-text-4" id="text-1-4-1">
<ul class="org-ul">
<li>我们看下图,能够正确的按照这个路数,先compile代码,然后拷贝到指定文件夹,最后
zip打包发布, 这个工具就是我们想要的.
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">Java build tools</h3>
<div class="outline-text-3" id="text-1-5">
</div><div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1">Apache Ant</h4>
<div class="outline-text-4" id="text-1-5-1">
<ul class="org-ul">
<li>最早的automation工具自然也就是ant啦,虽然ant是java写的,但是大部分的ant代码
却是使用xml来书写的.
</li>
<li>ant自己没有dependency manager,所以你得再把ant和ivy配置一下,以期实现dependency
manager的功能.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-5-2" class="outline-4">
<h4 id="sec-1-5-2">Apache Maven</h4>
<div class="outline-text-4" id="text-1-5-2">
<ul class="org-ul">
<li>Maven修复了'ant由于没有dependency manager而导致的跨工程整合非常困难'这个问题
成为了第二代automation 工具
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-5-3" class="outline-4">
<h4 id="sec-1-5-3">Requirement for a next-generation build tool</h4>
<div class="outline-text-4" id="text-1-5-3">
<ul class="org-ul">
<li>第三代就是gradle啦
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Chapter 02: Next-generation builds with Grale</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>Gradle 是下一代的JVM-based building工具,它从Ant和Maven吸取了优点,自己增加了
DSL(domain-specific language)来替代原来的xml
</li>
<li>就像git会给svn使用者一个平缓过渡一样,Gradle也为Ant使用者提供了类似功能
</li>
</ul>
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Gradle is Groovy</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Ant和Maven使用的XML,其阅读和书写非常容易,但是当xml的行数增长以后,维护起来非
常困难.
</li>
<li>Gradle的DSL是在Groovy语言基础上书写的
</li>
<li>Gradle学习了Maven的convention概念,如果用户follow某个convention,他不需要考虑
太多类似"source文件夹叫什么名字,测试文件夹放哪里"之类的问题
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Getting started with Gradle</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>先看看gradle的helloworld程序
<div class="org-src-container">

<pre class="src src-groovy"><span style="color: #b58900;">task</span> <span style="color: #268bd2;">helloWorld</span> <span style="color: #2aa198;">{</span>
    doLast <span style="color: #b58900;">{</span>
        println <span style="color: #2aa198;">'Hello World'</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">c:/Code/tmp &gt;&gt;&gt; gradle -q helloWorld           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hello World                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>上面的groovy代码就是Gradle的DSL啦:
<ul class="org-ul">
<li>task helloWorld说明是创建了一个叫做helloWorld的task(脑补class Solution)
</li>
<li>doLast是一个action: 意思是这个task的'最后一个'action. Groovy和ruby差不多
是一个喜欢"一件事情,多种做法"的语言, doLast也可以通过&lt;&lt;方法进行
<div class="org-src-container">

<pre class="src src-groovy"><span style="color: #b58900;">task</span> <span style="color: #268bd2;">helloWorld</span> &lt;&lt; <span style="color: #2aa198;">{</span>
    println <span style="color: #2aa198;">'Hello world!'</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
</ul>
</li>
<li>下面再来一个例子:多次重复"Gradle rocks!"
<div class="org-src-container">

<pre class="src src-groovy"><span style="color: #b58900;">task</span> <span style="color: #268bd2;">startSession</span> &lt;&lt; <span style="color: #2aa198;">{</span>
    chant<span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">chant</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    ant.echo<span style="color: #b58900;">(</span>message: <span style="color: #2aa198;">'Repeat after me...'</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

3.times <span style="color: #2aa198;">{</span>
    task <span style="color: #2aa198;">"yayGradle$it"</span> &lt;&lt; <span style="color: #b58900;">{</span>
        println <span style="color: #2aa198;">'Gradle rocks'</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

yayGradle0.dependsOn startSession
yayGradle2.<span style="color: #b58900;">dependsOn</span> <span style="color: #268bd2;">yayGradle1</span>, <span style="color: #268bd2;">yayGradle0</span>
task groupTherapy<span style="color: #2aa198;">(</span>dependsOn: yayGradle2<span style="color: #2aa198;">)</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">c:/Code/tmp &gt;&gt;&gt; gradle groupTherapy            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">:startSession                                  //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ant:echo] Repeat after me...                  //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">:yayGradle0                                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Gradle rocks                                   //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">:yayGradle1                                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Gradle rocks                                   //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">:yayGradle2                                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Gradle rocks                                   //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">:groupTherapy                                  //</span>
<span style="color: #93a1a1;">//                                                </span><span style="color: #93a1a1;">//</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">BUILD SUCCESSFUL                               //</span>
<span style="color: #93a1a1;">//                                                </span><span style="color: #93a1a1;">//</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Total time: 2.883 secs                         //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>这里我们看到了更多的ruby的影子:
<ul class="org-ul">
<li>3.times就是重复三次
</li>
<li>task "yayGradle$it"意思就是创建三个task名字是yayGradle+&lt;digit&gt;的组合, $it
就是groovy里面负责把times的loop index存到$it里面
</li>
<li>dependOn就是排列多个task的相互依赖关系
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Listing available tasks of a project</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>ant里面是ant -p build.xml, gradle的相似内容如下
<pre class="example">
c:/Code/tmp &gt;&gt;&gt; gradle -q tasks

------------------------------------------------------------
All tasks runnable from root project
------------------------------------------------------------

Build Setup tasks
-----------------
init - Initializes a new Gradle build. [incubating]
wrapper - Generates Gradle wrapper files. [incubating]

Help tasks
----------
components - Displays the components produced by root project 'tmp'. [incubating]
dependencies - Displays all dependencies declared in root project 'tmp'.
dependencyInsight - Displays the insight into a specific dependency in root project 'tmp'.
help - Displays a help message.
projects - Displays the sub-projects of root project 'tmp'.
properties - Displays the properties of root project 'tmp'.
tasks - Displays the tasks runnable from root project 'tmp'.

Other tasks
-----------
groupTherapy

To see all tasks and more detail, run with --all.
</pre>
</li>
<li>我们也看到了,如果想要更加详细的信息(比如我们3.times定义的那些tasks)
<pre class="example">
c:/Code/tmp &gt;&gt;&gt; gradle -q tasks --all

------------------------------------------------------------
All tasks runnable from root project
------------------------------------------------------------

Build Setup tasks
-----------------
init - Initializes a new Gradle build. [incubating]
wrapper - Generates Gradle wrapper files. [incubating]

Help tasks
----------
components - Displays the components produced by root project 'tmp'. [incubating]
dependencies - Displays all dependencies declared in root project 'tmp'.
dependencyInsight - Displays the insight into a specific dependency in root project 'tmp'.
help - Displays a help message.
projects - Displays the sub-projects of root project 'tmp'.
properties - Displays the properties of root project 'tmp'.
tasks - Displays the tasks runnable from root project 'tmp'.

Other tasks
-----------
groupTherapy
    startSession
    yayGradle0
    yayGradle1
    yayGradle2
</pre>
</li>
</ul>
</div>
<div id="outline-container-sec-2-3-1" class="outline-4">
<h4 id="sec-2-3-1">Task execution</h4>
<div class="outline-text-4" id="text-2-3-1">
<ul class="org-ul">
<li>我们的gradle 每个细小task在每次的命令行只能执行一次, 比如先后执行yayGradle0
yayGradle2的话,就会跟单独执行yayGradle2是一样的.因为虽然先执行yayGradle0的话
执行过startSession和yayGradle0了,第二次执行yayGrale2的话就不会再执行(seperator
是一个单独输出一行分隔符的task)
<pre class="example">
c:/Code/tmp &gt;&gt;&gt; gradle yayGradle0 seperator yayGradle2
:startSession
[ant:echo] Repeat after me...
:yayGradle0
Gradle rocks
:seperator
-----------------------
:yayGradle1
Gradle rocks
:yayGradle2
Gradle rocks

BUILD SUCCESSFUL

Total time: 2.91 secs
</pre>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Chapter 03: Building a Gradle project by example</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Introducing the case study</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

         <!-- Disqus Comment BEGIN -->
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              var disqus_shortname = 'harrifeng';

              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

         <!-- Disqus Comment END -->
</div>
</body>
</html>
