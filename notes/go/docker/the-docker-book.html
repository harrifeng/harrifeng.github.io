<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>the-docker-book</title>
<!-- 2017-05-02 Tue 10:51 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="your name" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>

         <link href="http://fonts.googleapis.com/css?family=Droid+Sans+Mono|Galdeano|Open+Sans:600italic,400,600|Roboto+Condensed:400,700" rel="stylesheet" type="text/css">
         <link rel="stylesheet" type="text/css" href="/static/css/main.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="http://harrifeng.github.io/sitemap.html"> UP </a>
 |
 <a accesskey="H" href="http://harrifeng.github.io/index.html"> HOME </a>
</div><div id="preamble" class="status">

         <div id="header">
            <div id="header-top">
                <div id="blog-title">Harrifeng's Path</div>
                <div id="blog-sub-title">纸上得来终觉浅,绝知此事要Coding</div>
            </div>
            <div id="nav">
                <ul>
                    <li><a href="/">首页</a></li>
                    <li><a href="/about.html">About Me</a></li>
                    <li>
                    </li>
                </ul>
            </div>
         </div>
</div>
<div id="content">
<h1 class="title">the-docker-book</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Chapter 1: Introduction</a>
<ul>
<li><a href="#sec-1-1">Introducing Docker</a></li>
<li><a href="#sec-1-2">Docker client and Server</a></li>
<li><a href="#sec-1-3">Docker images</a></li>
<li><a href="#sec-1-4">Registries</a></li>
<li><a href="#sec-1-5">Containers</a></li>
<li><a href="#sec-1-6">Docker's technical components</a></li>
</ul>
</li>
<li><a href="#sec-2">Chapter 2: Installing Docker</a>
<ul>
<li><a href="#sec-2-1">Requirements</a></li>
<li><a href="#sec-2-2">Boot2Docker installation on Windows and OSX</a></li>
<li><a href="#sec-2-3">Using Boot2Docker with this book</a></li>
<li><a href="#sec-2-4">The Docker daemon</a></li>
<li><a href="#sec-2-5">Configuring the Docker daemon</a></li>
<li><a href="#sec-2-6">Checking that the Docker daemon is running</a>
<ul>
<li><a href="#sec-2-6-1">Ubuntu like</a></li>
<li><a href="#sec-2-6-2">RedHat like</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">Chapter 3: Getting Started with Docker</a>
<ul>
<li><a href="#sec-3-1">Ensuring Docker is ready</a></li>
<li><a href="#sec-3-2">Building our first container</a></li>
<li><a href="#sec-3-3">Working with our first container</a></li>
<li><a href="#sec-3-4">Container naming</a></li>
<li><a href="#sec-3-5">Staring a stopped container</a></li>
<li><a href="#sec-3-6">Attaching to a container</a></li>
<li><a href="#sec-3-7">Creating daemonized containers</a></li>
<li><a href="#sec-3-8">Seeing what's happening inside our container</a></li>
<li><a href="#sec-3-9">Inspecting the container's processes</a></li>
<li><a href="#sec-3-10">Stopping a daemonized container</a></li>
<li><a href="#sec-3-11">Finding out more about our container</a></li>
<li><a href="#sec-3-12">Deleting a container</a></li>
</ul>
</li>
<li><a href="#sec-4">Chapter 4: Working with Docker images and repositories</a>
<ul>
<li><a href="#sec-4-1">What is a Docker image?</a></li>
<li><a href="#sec-4-2">Listing Docker images</a></li>
<li><a href="#sec-4-3">Pulling images</a></li>
<li><a href="#sec-4-4">Searching for images</a></li>
<li><a href="#sec-4-5">Building our own images</a>
<ul>
<li><a href="#sec-4-5-1">Building images with a Dockerfile</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Chapter 1: Introduction</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>首先我们要区分两个概念:
<ul class="org-ul">
<li>hypervisor virtualiation: 是指在一个物理机器上面,通过中间层,运行多个相互独
立的"虚拟机(machine)". hypervisor 隔绝的是多个machine
</li>
<li>container: 是在user space运行的,不会创建独立的Machine. 所以container又叫做
system-level virtualization. container隔绝的是多个user space instance
</li>
</ul>
</li>
<li>正是由于两者的差异, container可以说是不如hypervisor"灵活":
<ul class="org-ul">
<li>container只可以在ubuntu上面运行RedHat
</li>
<li>hypervisor不仅仅可以在ubuntu上面运行RedHat,还能在ubuntu上面运行windows
</li>
</ul>
</li>
<li>相比于拥有完整操作系统的hypervisor, docker有优点也有缺点:
<ul class="org-ul">
<li>缺点是可能没那么安全
</li>
<li>优点是比较节省资源
</li>
</ul>
</li>
<li>docker是新一代的container,旨在让container技术更加的容易使用.
</li>
</ul>
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Introducing Docker</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>docker相比于其他container,有如下的优点:
<ul class="org-ul">
<li>轻量级: docker非常的轻量而且快速, 因为基于copy-on-write model, 只有需要改
的地方才做了改动
</li>
<li>有了docker, 开发人员和运维人员的职责分开了: 开发人员专注于开发好container
里面的内容, 运维人员维护管理好container就好了.在docker的帮助下,运维人员可
以"百分百"的确认, 开发人员写的代码,和自己部署的代码是同一套,避免了在dev下
成立,但是运维的时候失败的问题
</li>
</ul>
</li>
<li>Docker的组成部分有如下:
<ul class="org-ul">
<li>Docker Client和Docker server
</li>
<li>Docker Images
</li>
<li>Registries
</li>
<li>Docker Containers
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Docker client and Server</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>Docker整体上来看,是一个CS结构的应用, Docker Client是通过和Docker Server(或者
是daemon)交流来获取能力的.
</li>
<li>你可以把Client以及Server放在同一个或者不同的机器上面
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Docker images</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>image是Docker世界的基石.container就是从image开始启动的.
</li>
<li>image是通过一系列指令来创建的, 比如:
<ul class="org-ul">
<li>添加一个文件
</li>
<li>运行一个命令
</li>
<li>打开一个端口
</li>
</ul>
</li>
<li>你可以把image想象成container的"source code", 而且image像git管理的代码一样,可
以方便的进行分享,存储和升级.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">Registries</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>Docker通过Registry来存储你的image,就像repo存储你的git code一样.
</li>
<li>registry也是区分public和private的, 和git的repo一样
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">Containers</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>container就是启动了的image,里面可能有一个或者多个运行的process
</li>
<li>对, 如果把image看做是静态代码的话, container就是code的运行时态
</li>
<li>container保存的是process,所以就像process可以created, started, stopped, restarted,
destroyed一样, container也可以有这些过程
</li>
<li>对于docker来说,container的运行方法是完全一样的,就好像对于船坞(docker)来说,集
装箱都是一样的,堆起来就可以
</li>
<li>container里面有什么并不重要, docker会按照自己永远不变的程式运行它,就像船坞对
待集装箱一样,拿一个一样大小的夹子,夹起来,放到卡车上
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">Docker's technical components</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li>docker需要x64位的Linux kernel支持(推荐version3.8以后版本)
</li>
<li>docker的一些基本要求如下:
<ul class="org-ul">
<li>Linux container format: libcontainer
</li>
<li>Linux kernel namespces: 用来隔绝filesystem, process, network
</li>
<li>Filesystem isolation: 每个container都有自己的root filesystem
</li>
<li>Process isolation: 每个container都有自己的process系统
</li>
<li>Network isolation: 不同的container有不同的virtual interface 和 IP Address
</li>
<li>Resource isolation and grouping: 像CPU和memory这种资源的分配,靠的是cgroups
命令(Linux下面的特性)
</li>
<li>Copy-on-Write: 文件系统是copy-on-write的,也就是所有container用一套基础,有
改动才增加一层.
</li>
<li>Logging: STDOUT, STDERR, STDIN都会被保存然后留以后进行分析
</li>
<li>Interactive shell: 可以创建一个shell连接STDIN
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Chapter 2: Installing Docker</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Requirements</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Docker的安装需要一些基本的要求:
<ul class="org-ul">
<li>64-bit architecture, 32-bit的不支持
</li>
<li>需要Linux 3.8 以上版本的内核(某些2.6版本的可能也行)
</li>
<li>The kernel 必须支持一些storage driver:
<ol class="org-ol">
<li>Device Mapper (默认支持)
</li>
<li>AUFS
</li>
<li>vfs
</li>
<li>btrfs
</li>
</ol>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Boot2Docker installation on Windows and OSX</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>Windows和Mac是没有Linux kernel支持的,所以需要virtualbox的支持, virtualbox其
实内部就是装了一个tinyCoreLinux
</li>
<li>安装了virtualBox的tinyCoreLinux以后,你要能够连接这个Linux的话,那么就得有个
command line连接这个tinyCoreLinux.这个工具就是The Docker client
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Using Boot2Docker with this book</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>如果是Boot2Docker来运行本书的例子的话,有时候你要连接localhost, 本书里面的
localhost并不是127.0.01,而是tinyCoreLinux,所以要知道这个tinyCoreLinux的ip地
址(也就是VirtualBox虚拟机的地址),需要如下命令
<pre class="example">
c:\code&gt;boot2docker ip
boot2docker ip

The VM's Host only interface IP address is: 192.168.59.103
</pre>
</li>
<li>boot2docker是不支持-v这个参数的,因为tinyCoreLinux里面的盘分享给docker instance
是没有意义的.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">The Docker daemon</h3>
<div class="outline-text-3" id="text-2-4">
<ul class="org-ul">
<li>安装Docker以后,我们必须确认Docker daemon是否在运行
</li>
<li>Docker的daemon是root-privileged的
</li>
<li>docker 命令行命令其实就是作为这个daemon(server)的client, 也同时需要root权限
</li>
<li>docker daemon是监听如下的一个Unix socket来接受incoming Docker request
<pre class="example">
&gt; ls -al /var/run/docker.sock
srw-rw----    1 root     docker           0 Mar 15 03:49 /var/run/docker.sock
</pre>
</li>
<li>从上面的输出我们可以看到:如果一个机器上面有个用户组名字是docker, 那么这个这
个group docker就会被设置成/var/run/docker.sock的owner,也就不用sudo就可以调用
了, 在linux下安装docker不一定会创建docker group的,但是boot2docker默认为我们
创建了docker group
<pre class="example">
&gt; cat /etc/group
root:x:0:
lp:x:7:lp
nogroup:x:65534:
staff:x:50:docker
docker:x:100:docker
</pre>
</li>
<li>需要极为注意的是docker group虽然用起来方便,但的确是一个太高权限的group,有可
能成为他人利用漏洞, 在向此group加成员的时候,要十分小心
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">Configuring the Docker daemon</h3>
<div class="outline-text-3" id="text-2-5">
<ul class="org-ul">
<li>默认情况下, docker daemon是绑定了某个端口的(比如2376)
<pre class="example">
&gt; sudo netstat -ltnp
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      623/sshd
tcp        0      0 :::22                   :::*                    LISTEN      623/sshd
tcp        0      0 :::2376                 :::*                    LISTEN      701/docker
</pre>
</li>
<li>如果我们想把docker dameon, 换到2375这个端口,那么要使用参数-H, 下面这个例子
就说明docker已经成功启动了.
<pre class="example">
sudo netstat -ltnp
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      623/sshd
tcp        0      0 :::22                   :::*                    LISTEN      623/sshd
tcp        0      0 :::2376                 :::*                    LISTEN      701/docker
sudo kill -9 701
sudo netstat -ltnp
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      623/sshd
tcp        0      0 :::22                   :::*                    LISTEN      623/sshd
sudo docker -d -H tcp://0.0.0.0:2375
2015/03/15 13:05:53 docker daemon: 1.3.1 4e9bbfa; execdriver: native; graphdriver:
[ccef5f24] +job serveapi(tcp://0.0.0.0:2375)
[info] Listening for HTTP on tcp (0.0.0.0:2375)
[info] /!\ DON'T BIND ON ANOTHER IP ADDRESS THAN 127.0.0.1 IF YOU DON'T KNOW WHAT YOU'RE DOING /!\
[ccef5f24] +job init_networkdriver()
[ccef5f24] -job init_networkdriver() = OK (0)
[info] Loading containers:
..[info] : done.
[ccef5f24] +job acceptconnections()
[ccef5f24] -job acceptconnections() = OK (0)
</pre>
</li>
<li>我们甚至可以使用-H来指定不是/var/run/docker.sock的另外的一个unix socket文件
<pre class="example">
$ sudo /usr/bin/docker -d -H unix://home/docker/docker.sock
</pre>
</li>
<li>需要注意的是-d参数的作用是开启"debug模式", 你会在前一个例子中发现大量的[info]
等,就是开启debug模式的结果
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6">Checking that the Docker daemon is running</h3>
<div class="outline-text-3" id="text-2-6">
</div><div id="outline-container-sec-2-6-1" class="outline-4">
<h4 id="sec-2-6-1">Ubuntu like</h4>
<div class="outline-text-4" id="text-2-6-1">
<ul class="org-ul">
<li>可以使用如下命令来查看docker的状态
<pre class="example">
&gt; sudo status docker
[ OK ]
</pre>
</li>
<li>可以使用start 和stop来启动docker
<pre class="example">
&gt; sudo stop docker
&gt; sudo start docker
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-6-2" class="outline-4">
<h4 id="sec-2-6-2">RedHat like</h4>
<div class="outline-text-4" id="text-2-6-2">
<ul class="org-ul">
<li>可以使用如下命令开启关闭
<pre class="example">
&gt; sudo service docker stop
&gt; sudo service docker start
</pre>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Chapter 3: Getting Started with Docker</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Ensuring Docker is ready</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>首先,我们要确认docker binary存在并且运行良好
<pre class="example">
&gt; docker info
Containers: 2
Images: 18
Storage Driver: aufs
 Root Dir: /mnt/sda1/var/lib/docker/aufs
 Dirs: 22
Execution Driver: native-0.2
Kernel Version: 3.16.4-tinycore64
Operating System: Boot2Docker 1.3.1 (TCL 5.4); master : 9a31a68 - Fri Oct 31 03:14:34 UTC 2014
Debug mode (server): true
Debug mode (client): false
Fds: 11
Goroutines: 11
EventsListeners: 0
Init Path: /usr/local/bin/docker
</pre>
</li>
<li>docker这个binary在前面的章节是server的作用,在这里已经是client的作用了.就是
发送request去docker daemon,然后得到反馈以后进行处理
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Building our first container</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>我们下面使用docker run来创建Docker container(从image变成container),没有image
下载的过程是因为原来下载过ubuntu image.
<pre class="example">
docker run -i -t ubuntu /bin/bash
root@1cdeb856c365:
</pre>
</li>
<li>分析一下这个命令:
<ul class="org-ul">
<li>docker run是命令主体.是创建container(从image开始)
</li>
<li>-i和-t两个参数的意思是: -i保证STDIN为container开启. -t保证为container提供
一个pseudo-tty,也就是给container一个interactive shell
</li>
<li>下面ubuntu的意思是我们要使用image ubuntu, 这个image是base image(也就是没
有x/y这种结构,而是只有y).base image是docker inc提供的.我们这里没有网络操作
是因为本地有image, 如果没有image,那么会从网络下载
</li>
<li>/bin/bash, docker得到这个image以后,会在当前file system里面创建一个新的container
然后在这个container的/bin/bash命令,也就是
<pre class="example">
root@1cdeb856c365:
</pre>
</li>
</ul>
</li>
<li>Note: 如果我们需要所有的run的用法可以使用
<pre class="example">
docker help run

Usage: docker run [OPTIONS] IMAGE [COMMAND] [ARG...]

Run a command in a new container

  -a, --attach=[]            Attach to STDIN, STDOUT or STDERR.
  --add-host=[]              Add a custom host-to-IP mapping (host:ip)
  -c, --cpu-shares=0         CPU shares (relative weight)
  --cap-add=[]               Add Linux capabilities
  --cap-drop=[]              Drop Linux capabilities
  --cidfile=""               Write the container ID to the file
  --cpuset=""                CPUs in which to allow execution (0-3, 0,1)
  -d, --detach=false         Detached mode: run the container in the background and print the new container ID
  --device=[]                Add a host device to the container (e.g. --device=/dev/sdc:/dev/xvdc)
  --dns=[]                   Set custom DNS servers
  --dns-search=[]            Set custom DNS search domains
  -e, --env=[]               Set environment variables
  --entrypoint=""            Overwrite the default ENTRYPOINT of the image
  --env-file=[]              Read in a line delimited file of environment variables
  --expose=[]                Expose a port from the container without publishing it to your host
  -h, --hostname=""          Container host name
  -i, --interactive=false    Keep STDIN open even if not attached
  --link=[]                  Add link to another container in the form of name:alias
  --lxc-conf=[]              (lxc exec-driver only) Add custom lxc options --lxc-conf="lxc.cgroup.cpuset.cpus = 0,1"
  -m, --memory=""            Memory limit (format: &lt;number&gt;&lt;optional unit&gt;, where unit = b, k, m or g)
  --name=""                  Assign a name to the container
  --net="bridge"             Set the Network mode for the container
                               'bridge': creates a new network stack for the container on the docker bridge
                               'none': no networking for this container
                               'container:&lt;name|id&gt;': reuses another container network stack
                               'host': use the host network stack inside the container.  Note: the host mode gives the container full access to local system services such as D-bus and is therefore considered insecure.
  -P, --publish-all=false    Publish all exposed ports to the host interfaces
  -p, --publish=[]           Publish a container's port to the host
                               format: ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort | containerPort
                               (use 'docker port' to see the actual mapping)
  --privileged=false         Give extended privileges to this container
  --restart=""               Restart policy to apply when a container exits (no, on-failure[:max-retry], always)
  --rm=false                 Automatically remove the container when it exits (incompatible with -d)
  --security-opt=[]          Security Options
  --sig-proxy=true           Proxy received signals to the process (even in non-TTY mode). SIGCHLD, SIGSTOP, and SIGKILL are not proxied.
  -t, --tty=false            Allocate a pseudo-TTY
  -u, --user=""              Username or UID
  -v, --volume=[]            Bind mount a volume (e.g., from the host: -v /host:/container, from Docker: -v /container)
  --volumes-from=[]          Mount volumes from the specified container(s)
  -w, --workdir=""           Working directory inside the container
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Working with our first container</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>我们来详细的看看,我们在这个shell里面能做什么, root@后面有一系列的ID,其实是
这个新的container的ID,也是它的hostname
<pre class="example">
root@1cdeb856c365:/# hostname
hostname
1cdeb856c365
</pre>
</li>
<li>hostname也一般会反映在文件/etc/hosts里面
<pre class="example">
root@1cdeb856c365:/# cat /etc/hosts
cat /etc/hosts
172.17.0.2  1cdeb856c365
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
127.0.0.1   localhost
::1 localhost ip6-localhost ip6-loopback
</pre>
</li>
<li>这个container的网络配置也是完整的: 一个localhost, 一个eth0, 其IP地址为172.17.0.2
<pre class="example">
root@1cdeb856c365:/# ip a
ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
6: eth0: &lt;BROADCAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.2/16 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:acff:fe11:2/64 scope link
       valid_lft forever preferred_lft forever
</pre>
</li>
<li>可以查看当前运行的进程
<pre class="example">
root@1cdeb856c365:/# ps -aux
ps -aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.1  18168  3240 ?        Ss   12:06   0:00 /bin/bash
root        23  0.0  0.1  15568  2092 ?        R+   12:21   0:00 ps -aux
</pre>
</li>
<li>还能安装文件
<pre class="example">
root@1cdeb856c365:/# apt-get install vim
apt-get install vim
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following extra packages will be installed:
  libgpm2 libpython2.7 libpython2.7-minimal libpython2.7-stdlib vim-runtime
Suggested packages:
  gpm ctags vim-doc vim-scripts
The following NEW packages will be installed:
  libgpm2 libpython2.7 libpython2.7-minimal libpython2.7-stdlib vim
  vim-runtime
0 upgraded, 6 newly installed, 0 to remove and 0 not upgraded.
Need to get 9083 kB of archives.
After this operation, 42.9 MB of additional disk space will be used.
Do you want to continue? [Y/n]
</pre>
</li>
<li>如果你不想使用这个container了以后,就输入exit,然后这个container就stop运行了
可以通过docker ps -a(不加-a就只显示running的container)来查看所有的container,
以及他们的状态
<pre class="example">
docker ps -a
CONTAINER ID        IMAGE                              COMMAND                CREATED             STATUS                      PORTS                     NAMES
2eb46e8ca9ff        dockerfile/ubuntu-desktop:latest   "bash -c 'vncserver    33 hours ago        Exited (0) 22 minutes ago   0.0.0.0:5901-&gt;5901/tcp    determined_einstein
a7c56bda446d        creack/firefox-vnc:latest          "x11vnc -forever -us   33 hours ago        Exited (0) 22 minutes ago   0.0.0.0:49153-&gt;5900/tcp   jolly_fermat
1cdeb856c365        ubuntu:14.04                       "/bin/bash"            5 days ago          Exited (0) 18 seconds ago                             cocky_yonath
</pre>
</li>
<li>docker ps -l是上一次运行的container,非常好用
<pre class="example">
docker ps -l
CONTAINER ID        IMAGE                              COMMAND                CREATED             STATUS                      PORTS                    NAMES
2eb46e8ca9ff        dockerfile/ubuntu-desktop:latest   "bash -c 'vncserver    33 hours ago        Exited (0) 23 minutes ago   0.0.0.0:5901-&gt;5901/tcp   determined_einstein
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">Container naming</h3>
<div class="outline-text-3" id="text-3-4">
<ul class="org-ul">
<li>ps -a的最后一行就是NAMES, 如果你在创建container的时候输入名字,这个名字就是
随机的, 我们可以使用&#x2013;name来"取名字"
<pre class="example">
&gt; docker run --name terminal_test -i -t ubuntu /bin/bash
&gt; docker ps -l
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                      PORTS               NAMES
24497ca19cb1        ubuntu:14.04        "/bin/bash"         39 seconds ago      Exited (0) 33 seconds ago                       terminal_test
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">Staring a stopped container</h3>
<div class="outline-text-3" id="text-3-5">
<ul class="org-ul">
<li>一旦你exit, 这个docker的status就是Exited了,所以你得start(或者restart)它
<pre class="example">
&gt; docker ps -l
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                      PORTS               NAMES
24497ca19cb1        ubuntu:14.04        "/bin/bash"         39 seconds ago      Exited (0) 33 seconds ago                       terminal_test
&gt; docker start terminal_test
terminal_test
&gt; docker ps -l
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
24497ca19cb1        ubuntu:14.04        "/bin/bash"         2 minutes ago       Up 11 seconds                           terminal_test
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6">Attaching to a container</h3>
<div class="outline-text-3" id="text-3-6">
<ul class="org-ul">
<li>一旦这个container进入了start的状态,那么下一步就是attach到它,所以我们又可以
进入它的bash命令行了
<pre class="example">
docker ps -l
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
24497ca19cb1        ubuntu:14.04        "/bin/bash"         2 minutes ago       Up 11 seconds                           terminal_test
docker attach terminal_test

root@24497ca19cb1:/# hostname
hostname
24497ca19cb1
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7">Creating daemonized containers</h3>
<div class="outline-text-3" id="text-3-7">
<ul class="org-ul">
<li>一般来说,在linux上面, 我们需要创建interactive container的需求,远不如创建后台
运行的longer-running container的需求多, 这个时候是使用参数-d
<pre class="example">
sudo docker run --name daemon_dave -d ubuntu /bin/sh -c "while true; do echo hello world; sleep 1; done"
1d1dd2f1477189f9d2c1d7acc0b382a1e8af5d0f6dcc5b46ab6b22aa7066c328
docker ps -l
CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS               NAMES
1d1dd2f14771        ubuntu:14.04        "/bin/sh -c 'while t   4 seconds ago       Up 3 seconds                            daemon_dave
</pre>
</li>
<li>刚才的时候,我们是有interactive的shell的,所以attach了以后,就立马联系到terminal
而这里没有terminal,我们就返回新创建的container的ID而已
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-8" class="outline-3">
<h3 id="sec-3-8">Seeing what's happening inside our container</h3>
<div class="outline-text-3" id="text-3-8">
<ul class="org-ul">
<li>我可以使用logs命令来查看,terminal里面已经输出了什么. 这个命令的结果是不变的
<pre class="example">
docker logs daemon_dave
hello world
hello world
hello world
hello world
hello world
hello world
hello world
hello world
hello world
hello world
hello world
hello world
</pre>
</li>
<li>我们还可以像tail -f 一样, 使用log -f查看动态的文件改动
<pre class="example">
docker logs -f daemon_dave
hello world
hello world
hello world
hello world
hello world
hello world
...
</pre>
</li>
<li>&#x2013;tail参数可以查看某些行的信息
<pre class="example">
docker logs --tail 3 daemon_dave
hello world
hello world
hello world
</pre>
</li>
<li>参数-t是加上时间戳
<pre class="example">
docker logs -t --tail 3 daemon_dave
2015-03-22T12:52:04.366423061Z hello world
2015-03-22T12:52:05.376884111Z hello world
2015-03-22T12:52:06.387534534Z hello world
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-9" class="outline-3">
<h3 id="sec-3-9">Inspecting the container's processes</h3>
<div class="outline-text-3" id="text-3-9">
<ul class="org-ul">
<li>我们也可以使用top命令来查看container里面的process情况
<pre class="example">
docker top daemon_dave
PID                 USER                COMMAND
1110                root                /bin/sh -c while true; do echo hello world; sleep 1; done
2143                root                sleep 1
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-10" class="outline-3">
<h3 id="sec-3-10">Stopping a daemonized container</h3>
<div class="outline-text-3" id="text-3-10">
<ul class="org-ul">
<li>杀掉一个container的方法就是:
<ul class="org-ul">
<li>docker stop (发送SIGTERM signal)
</li>
<li>docker kill (发送SIGKILL signal)
</li>
</ul>
</li>
<li>下面是stop的例子(注意docker ps -n x是查看最近x个container的情况)
<pre class="example">
docker stop daemon_dave
daemon_dave
docker ps -n 3
CONTAINER ID        IMAGE                              COMMAND                CREATED             STATUS                       PORTS                    NAMES
1d1dd2f14771        ubuntu:14.04                       "/bin/sh -c 'while t   20 minutes ago      Exited (-1) 34 seconds ago                            daemon_dave
24497ca19cb1        ubuntu:14.04                       "/bin/bash"            31 minutes ago      Exited (0) 21 minutes ago                             terminal_test
2eb46e8ca9ff        dockerfile/ubuntu-desktop:latest   "bash -c 'vncserver    33 hours ago        Exited (0) 57 minutes ago    0.0.0.0:5901-&gt;5901/tcp   determined_einstein
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-11" class="outline-3">
<h3 id="sec-3-11">Finding out more about our container</h3>
<div class="outline-text-3" id="text-3-11">
<ul class="org-ul">
<li>使用inspect会得到更多关于container的信息, 以json数组的形式返回
<pre class="example">
docker inspect daemon_dave
[{
    "Args": [
        "-c",
        "while true; do echo hello world; sleep 1; done"
    ],
    "Config": {
        "AttachStderr": false,
        "AttachStdin": false,
        "AttachStdout": false,
        "Cmd": [
            "/bin/sh",
            "-c",
            "while true; do echo hello world; sleep 1; done"
        ],
        "CpuShares": 0,
        "Cpuset": "",
        "Domainname": "",
        "Entrypoint": null,
        "Env": [
            "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
        ],
        "ExposedPorts": null,
        "Hostname": "1d1dd2f14771",
        "Image": "ubuntu",
        "Memory": 0,
    ...
}
]
</pre>
</li>
<li>当然了不是每个人都会使用Emacs的shell,如果我们想知道其中某些部分的信息, 我们
可以使用-f(&#x2013;format)参数来取得一部分的信息
<pre class="example">
docker start daemon_dave
daemon_dave
docker inspect --format '{{.NetworkSettings.IPAddress}}' daemon_dave
172.17.0.7
docker inspect --format '{{.State.Running}}' daemon_dave
true
</pre>
</li>
<li>我们还可以同时inspect两个container, 如果不加format就是返回一个json数组,不过
成员不再是一个,而是两个
<pre class="example">
docker inspect --format '{{.State.Running}}' daemon_dave terminal_test
true
false
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-12" class="outline-3">
<h3 id="sec-3-12">Deleting a container</h3>
<div class="outline-text-3" id="text-3-12">
<ul class="org-ul">
<li>我们使用rm命令来删除container,但是container必须是stop状态的
<pre class="example">
docker ps -a
CONTAINER ID        IMAGE                              COMMAND                CREATED             STATUS                         PORTS                     NAMES
1d1dd2f14771        ubuntu:14.04                       "/bin/sh -c 'while t   31 minutes ago      Up 3 minutes                                             daemon_dave
24497ca19cb1        ubuntu:14.04                       "/bin/bash"            42 minutes ago      Exited (0) 33 minutes ago                                terminal_test
2eb46e8ca9ff        dockerfile/ubuntu-desktop:latest   "bash -c 'vncserver    34 hours ago        Exited (0) About an hour ago   0.0.0.0:5901-&gt;5901/tcp    determined_einstein
a7c56bda446d        creack/firefox-vnc:latest          "x11vnc -forever -us   34 hours ago        Exited (0) About an hour ago   0.0.0.0:49153-&gt;5900/tcp   jolly_fermat
1cdeb856c365        ubuntu:14.04                       "/bin/bash"            5 days ago          Exited (0) 46 minutes ago                                cocky_yonath
5273e0466f56        dockerui/dockerui:latest           "./dockerui"           6 days ago          Exited (0) 5 days ago          0.0.0.0:9000-&gt;9000/tcp    ecstatic_mcclintock
docker stop daemon_dave
daemon_dave
docker rm daemon_dave
daemon_dave
docker ps -a
CONTAINER ID        IMAGE                              COMMAND                CREATED             STATUS                         PORTS                     NAMES
24497ca19cb1        ubuntu:14.04                       "/bin/bash"            42 minutes ago      Exited (0) 33 minutes ago                                terminal_test
2eb46e8ca9ff        dockerfile/ubuntu-desktop:latest   "bash -c 'vncserver    34 hours ago        Exited (0) About an hour ago   0.0.0.0:5901-&gt;5901/tcp    determined_einstein
a7c56bda446d        creack/firefox-vnc:latest          "x11vnc -forever -us   34 hours ago        Exited (0) About an hour ago   0.0.0.0:49153-&gt;5900/tcp   jolly_fermat
1cdeb856c365        ubuntu:14.04                       "/bin/bash"            5 days ago          Exited (0) 46 minutes ago                                cocky_yonath
5273e0466f56        dockerui/dockerui:latest           "./dockerui"           6 days ago          Exited (0) 5 days ago          0.0.0.0:9000-&gt;9000/tcp    ecstatic_mcclintock
</pre>
</li>
<li>还有一个命令特别厉害可以删除所有的container
<pre class="example">
&gt; docker ps -a
CONTAINER ID        IMAGE                              COMMAND                CREATED             STATUS                         PORTS                     NAMES
24497ca19cb1        ubuntu:14.04                       "/bin/bash"            42 minutes ago      Exited (0) 33 minutes ago                                terminal_test
2eb46e8ca9ff        dockerfile/ubuntu-desktop:latest   "bash -c 'vncserver    34 hours ago        Exited (0) About an hour ago   0.0.0.0:5901-&gt;5901/tcp    determined_einstein
a7c56bda446d        creack/firefox-vnc:latest          "x11vnc -forever -us   34 hours ago        Exited (0) About an hour ago   0.0.0.0:49153-&gt;5900/tcp   jolly_fermat
1cdeb856c365        ubuntu:14.04                       "/bin/bash"            5 days ago          Exited (0) 46 minutes ago                                cocky_yonath
5273e0466f56        dockerui/dockerui:latest           "./dockerui"           6 days ago          Exited (0) 5 days ago          0.0.0.0:9000-&gt;9000/tcp    ecstatic_mcclintock
&gt; docker rm `docker ps -a -q`
24497ca19cb1
2eb46e8ca9ff
a7c56bda446d
1cdeb856c365
5273e0466f56
docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</pre>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Chapter 4: Working with Docker images and repositories</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">What is a Docker image?</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>Docker image是由多个filesystem layer组成的.最底层的filesystem是bootfs(也就
相当于Linux分区里面的/boot)
</li>
<li>bootfs的上面一层是rootfs
</li>
<li>TODO
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Listing Docker images</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li>列出docker所有的images的方法如下
<pre class="example">
&gt; docker images
REPOSITORY           TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
ubuntu               trusty              d0955f21bf24        2 weeks ago         188.3 MB
ubuntu               trusty-20150320     d0955f21bf24        2 weeks ago         188.3 MB
ubuntu               14.04               d0955f21bf24        2 weeks ago         188.3 MB
ubuntu               14.04.2             d0955f21bf24        2 weeks ago         188.3 MB
ubuntu               latest              d0955f21bf24        2 weeks ago         188.3 MB
ubuntu               precise             9c5e4be642b7        2 weeks ago         131.9 MB
ubuntu               precise-20150320    9c5e4be642b7        2 weeks ago         131.9 MB
ubuntu               12.04               9c5e4be642b7        2 weeks ago         131.9 MB
ubuntu               12.04.5             9c5e4be642b7        2 weeks ago         131.9 MB
creack/firefox-vnc   latest              a41e7b939b8a        23 months ago       557.6 MB
</pre>
</li>
<li>首先我们注意到的是我们列出image,但是第一行确实repository. 我们可以把repository
理解为一类image的集合
</li>
<li>repository是建立在不同的registry上面的(但是默认的都是Docker Hub,我们也就不
再考虑其他registry了)
</li>
<li>可以看到,我们有两种image集合(repository):
<ul class="org-ul">
<li>类似ubuntu这种image是top-level repository, 是Docker Inc管理,由相应vender
提供的. 这种image具有公信力.
</li>
<li>类似creack/firefox-vnc是由一个username=&gt; creack提供的名字叫做firefox-vnc
的image. 叫做user repository, 当然这个username是Docker Hub上面的username
</li>
</ul>
</li>
<li>同一类image(repository)里面,区分不同版本的方法是:tag. 比如这里ubuntu
repository就有很多tag:
<ul class="org-ul">
<li>14.04
</li>
<li>14.04.2
</li>
<li>trusty
</li>
<li>12.04
</li>
<li>12.04.5
</li>
<li>precise
</li>
</ul>
</li>
<li>除了TAG以外,我们还发现了Image ID, 而且我们发现所谓的14.04, 14.04.2, trusty等
等都是一个Image ID, 这也就说明了一个问题,这些tag虽然不同,但是指的缺是同一个
image. 好比git也是可以给commit打tag的,不同tag也可以打给同一个commit, 但是ID
是唯一的!
</li>
<li>既然已经类比了git,那么我们就类比多一点(以后会发现相似的地方更多):
<ul class="org-ul">
<li>docker repository &lt;==&gt; git repository
</li>
<li>docker image &lt;==&gt; git commit
</li>
<li>docker image id &lt;==&gt; git commit hash id
</li>
<li>docker tag &lt;==&gt; git tag
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">Pulling images</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>我们可以使用pull command来更新repository(git也是使用git pull来&lt;rep&gt;更新某个
repository)
<pre class="example">
docker pull fedora
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">Searching for images</h3>
<div class="outline-text-3" id="text-4-4">
<ul class="org-ul">
<li>当然我们可以搜索image啦, 所谓搜索image,其实叫做搜索repository更合适,因为其实
github搜索项目名字,搜索的其实也就是repository的列表. 而我们这里搜索出来的其
实就是repository的列表
<pre class="example">
docker search puppet
NAME                                 DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
devopsil/puppet                      Dockerfile for a container with puppet ins...   6                    [OK]
layerworx/puppetmaster               Standard dockerized Puppetmaster server bu...   5                    [OK]
macadmins/munki-puppet               Basic munki nginx image with Puppet used f...   5                    [OK]
devopsil/puppet-yum                                                                  4                    [OK]
layerworx/puppet                     A Puppet enabled container running the 3.7...   3                    [OK]
macadmins/puppetmaster               Simple puppetmaster based on CentOS 6           3                    [OK]
rfkrocktk/puppet                                                                     2                    [OK]
simpledrupalcloud/puppet                                                             1                    [OK]
devopsil/puppetmaster                                                                1                    [OK]
lukasz/docker-puppet-openssl-nginx   This image is derived from https://index.d...   1                    [OK]
scrothers/puppet                                                                     1                    [OK]
farodin91/puppet                                                                     0                    [OK]
razic/puppet                                                                         0                    [OK]
kassis/puppet-spec                                                                   0                    [OK]
m0ikz/puppet                                                                         0                    [OK]
solict/provisionous-puppet-centos    CentOS provisions with Puppet included          0                    [OK]
solict/provisionous-puppet-debian    Debian provisions with Puppet included          0                    [OK]
solict/provisionous-puppet-ubuntu    Ubuntu provisions with Puppet included          0                    [OK]
muccg/puppet-base                    Base images that use puppet and librarian-...   0                    [OK]
jeyk/puppet                                                                          0                    [OK]
fr3nd/puppet                                                                         0                    [OK]
pataquets/puppet                                                                     0                    [OK]
pmoust/puppet                        Puppet docker image based on Ubuntu 14.04 ...   0                    [OK]
viljaste/puppet                                                                      0                    [OK]
vmule/puppet-apt                                                                     0                    [OK]
</pre>
</li>
<li>我们来下载其中一个image集合(repository),如下
<pre class="example">
docker@boot2docker:~$ docker search jamtur01/puppetmaster
NAME                           DESCRIPTION   STARS     OFFICIAL   AUTOMATED
jamtur01/docker-puppetmaster                 1                    [OK]
jamtur01/puppetmaster                        0
docker@boot2docker:~$ docker pull jamtur01/puppetmaster
Pulling repository jamtur01/puppetmaster
99200e07340a: Download complete
511136ea3c5a: Download complete
3e76c0a80540: Download complete
be88c4c27e80: Download complete
bfab314f3b76: Download complete
e809f156dc98: Download complete
0ef6ede68afa: Download complete
Status: Downloaded newer image for jamtur01/puppetmaster:latest
</pre>
</li>
<li>然后,我们可以看到已经在image里面了
<pre class="example">
docker images
REPOSITORY              TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
ubuntu                  trusty              d0955f21bf24        2 weeks ago         188.3 MB
ubuntu                  trusty-20150320     d0955f21bf24        2 weeks ago         188.3 MB
ubuntu                  14.04               d0955f21bf24        2 weeks ago         188.3 MB
ubuntu                  14.04.2             d0955f21bf24        2 weeks ago         188.3 MB
ubuntu                  latest              d0955f21bf24        2 weeks ago         188.3 MB
ubuntu                  precise             9c5e4be642b7        2 weeks ago         131.9 MB
ubuntu                  precise-20150320    9c5e4be642b7        2 weeks ago         131.9 MB
ubuntu                  12.04               9c5e4be642b7        2 weeks ago         131.9 MB
ubuntu                  12.04.5             9c5e4be642b7        2 weeks ago         131.9 MB
jamtur01/puppetmaster   latest              99200e07340a        10 months ago       312.4 MB
creack/firefox-vnc      latest              a41e7b939b8a        23 months ago       557.6 MB
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5">Building our own images</h3>
<div class="outline-text-3" id="text-4-5">
<ul class="org-ul">
<li>创建一个image的办法有两个:
<ul class="org-ul">
<li>docker commit (已经被弃用)
</li>
<li>docker build with Dockerfile
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-sec-4-5-1" class="outline-4">
<h4 id="sec-4-5-1">Building images with a Dockerfile</h4>
<div class="outline-text-4" id="text-4-5-1">
<ul class="org-ul">
<li>Dockerfile就是专门为docker专门准备的一门DSL
</li>
<li>我们来先看看第一个例子
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

         <!-- Disqus Comment BEGIN -->
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              var disqus_shortname = 'harrifeng';

              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

         <!-- Disqus Comment END -->
</div>
</body>
</html>
