<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>go_learn_note</title>
<!-- 2017-05-02 Tue 10:51 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="your name" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>

         <link href="http://fonts.googleapis.com/css?family=Droid+Sans+Mono|Galdeano|Open+Sans:600italic,400,600|Roboto+Condensed:400,700" rel="stylesheet" type="text/css">
         <link rel="stylesheet" type="text/css" href="/static/css/main.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="http://harrifeng.github.io/sitemap.html"> UP </a>
 |
 <a accesskey="H" href="http://harrifeng.github.io/index.html"> HOME </a>
</div><div id="preamble" class="status">

         <div id="header">
            <div id="header-top">
                <div id="blog-title">Harrifeng's Path</div>
                <div id="blog-sub-title">纸上得来终觉浅,绝知此事要Coding</div>
            </div>
            <div id="nav">
                <ul>
                    <li><a href="/">首页</a></li>
                    <li><a href="/about.html">About Me</a></li>
                    <li>
                    </li>
                </ul>
            </div>
         </div>
</div>
<div id="content">
<h1 class="title">go_learn_note</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">第一章 类型</a>
<ul>
<li><a href="#sec-1-1">变量</a></li>
<li><a href="#sec-1-2">常量</a></li>
<li><a href="#sec-1-3">基本类型</a></li>
<li><a href="#sec-1-4">引用类型</a></li>
<li><a href="#sec-1-5">类型转换</a></li>
<li><a href="#sec-1-6">字符串</a></li>
<li><a href="#sec-1-7">指针</a></li>
<li><a href="#sec-1-8">自定义类型</a></li>
</ul>
</li>
<li><a href="#sec-2">第二章 表达式</a>
<ul>
<li><a href="#sec-2-1">保留字</a></li>
<li><a href="#sec-2-2">运算符</a></li>
<li><a href="#sec-2-3">初始化</a></li>
<li><a href="#sec-2-4">控制流</a>
<ul>
<li><a href="#sec-2-4-1">if</a></li>
<li><a href="#sec-2-4-2">for (while)</a></li>
<li><a href="#sec-2-4-3">range</a></li>
<li><a href="#sec-2-4-4">switch</a></li>
<li><a href="#sec-2-4-5">goto, break, continue</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">第三章 函数</a>
<ul>
<li><a href="#sec-3-1">函数定义</a></li>
<li><a href="#sec-3-2">变参类型</a></li>
<li><a href="#sec-3-3">返回值</a></li>
<li><a href="#sec-3-4">匿名函数</a></li>
<li><a href="#sec-3-5">延迟调用</a></li>
<li><a href="#sec-3-6">错误处理</a></li>
</ul>
</li>
<li><a href="#sec-4">第四章 数据</a>
<ul>
<li><a href="#sec-4-1">Array</a></li>
<li><a href="#sec-4-2">Slice</a>
<ul>
<li><a href="#sec-4-2-1">reslice</a></li>
<li><a href="#sec-4-2-2">append</a></li>
<li><a href="#sec-4-2-3">copy</a></li>
</ul>
</li>
<li><a href="#sec-4-3">Map</a></li>
<li><a href="#sec-4-4">Struct</a>
<ul>
<li><a href="#sec-4-4-1">匿名字段</a></li>
<li><a href="#sec-4-4-2">面向对象</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-5">第五章 方法</a>
<ul>
<li><a href="#sec-5-1">方法定义</a></li>
<li><a href="#sec-5-2">匿名字段</a></li>
<li><a href="#sec-5-3">方法集</a></li>
<li><a href="#sec-5-4">表达式</a></li>
</ul>
</li>
<li><a href="#sec-6">第六章 接口</a>
<ul>
<li><a href="#sec-6-1">接口定义</a></li>
<li><a href="#sec-6-2">执行机制</a></li>
<li><a href="#sec-6-3">接口转换</a></li>
<li><a href="#sec-6-4">接口检查</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">第一章 类型</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">变量</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>Go是静态类型语言,不能在运行期改变变量的类型
</li>
<li>在函数外,使用var来定义变量,初始值为0;如果提供初始化值,可省略变量类型,由编译
器自动推导
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">var</span> globalX int
<span style="color: #859900; font-weight: bold;">var</span> globalY = <span style="color: #2aa198;">"abc"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>globalX<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>globalY<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">abc                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>在函数内部,还可以使用`:=`初始化,需要注意是新创建的local变量,还是更改了global
变量!
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">var</span> globalX int

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    localX := 123
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>globalX<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>localX<span style="color: #b58900;">)</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Be careful! `:=` can also change the global value</span>
    globalX := 456
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>globalX<span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Error !You can not REDEFINE one variable</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">localX := 789</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">But of cause, you can change it value</span>
    localX = 987
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>localX<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">123                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">456                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">987                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>定义多个变量的方式有如下几种
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">var</span> x, y, z int
<span style="color: #859900; font-weight: bold;">var</span> s, n = <span style="color: #2aa198;">"abc"</span>, 123

<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #2aa198;">(</span>
    a int
    b float32
<span style="color: #2aa198;">)</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    n, s := 0x1234, <span style="color: #2aa198;">"Hello, World!"</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>x, s, n<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0 Hello, World! 4660                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>多变量赋值是先计算相关值,然后从左到右依次赋值
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    data, i := <span style="color: #b58900;">[</span>3<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2<span style="color: #b58900;">}</span>, 0
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>i<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>data<span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">When assigning multiple values in one line</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">You should:</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[1] make sure all the value: (i =&gt; 0) and (data[i] =&gt; data[0])</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[2] assign value base on [1]: i = 2, data[0] = 100</span>
    i, data<span style="color: #b58900;">[</span>i<span style="color: #b58900;">]</span> = 2, 100
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>i<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>data<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 2]                                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[100 1 2]                                      //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>"_"是特殊变量,用户忽略占位符
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">(</span><span style="color: #b58900;">int</span>, <span style="color: #b58900;">string</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> 1, <span style="color: #2aa198;">"abc"</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    _, s := <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">o                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">abc                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>"_"的占位符作用还可以体现在规避'编译器认为没使用的局部变量是error'
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">var</span> s string  <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">global variable unused is OK</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Error ! =&gt; i declared and not used</span>
    i := 0
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">use following to block previous error</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">_ = i</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>前面介绍过,一个变量是无法重定义(redefine)的,但是两个变量却可以重定义!这个是
go特别的地方:
<ul class="org-ul">
<li>可以在同一个block里面重定义已定义的变量(但是要两个变量一块的情况):这个也是
可以理解的,这是由go的特性决定的.比如下面的例子,我们s已经定义了,我们想再定义
一个y,而且两个定义写到一句里面(其实函数返回两个值就是这种情况).你不能苛求
我定义y的时候,能把s的值也写对啊,所以s就可以redefine了!
<div class="org-src-container">

<pre class="src src-go">s := <span style="color: #2aa198;">"abc"</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">same level, can redefine if define two variable at once</span>
s, y := <span style="color: #2aa198;">"hello"</span>, 20
</pre>
</div>
</li>
<li>不同的block里面的就不存在所谓的"重定义"了,因为即便是变量名相同,也其实是两个
不同的变量了
</li>
</ul>
</li>
<li>重定义例子如下
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #2aa198;">"abc"</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>&amp;s<span style="color: #b58900;">)</span>

    s, y := <span style="color: #2aa198;">"hello"</span>, 20
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>&amp;s, y<span style="color: #b58900;">)</span>

    <span style="color: #b58900;">{</span>
        s, z := 1000, 30
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span>&amp;s, z<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x82023e080                                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x82023e080 20                                 //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x82023e0b0 30                                 //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">常量</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>常亮必须是编译期可以确定的数字,字符串,布尔值
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">const</span> x, y int = 1, 2
<span style="color: #859900; font-weight: bold;">const</span> s = <span style="color: #2aa198;">"Hello, World!"</span>

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #2aa198;">(</span>
    a, b      = 10, 100
    c    bool = <span style="color: #268bd2; font-weight: bold;">false</span>
<span style="color: #2aa198;">)</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">one day const, always const</span>
    <span style="color: #859900; font-weight: bold;">const</span> x = <span style="color: #2aa198;">"xxx"</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">only x is used</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">unused const variable will not incur Error</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>x<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>常量还可以是len, cap, unsafe.Sizeof等编译器可确定结果的函数返回值
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">(</span>
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"unsafe"</span>
<span style="color: #2aa198;">)</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">const</span> <span style="color: #b58900;">(</span>
        a = <span style="color: #2aa198;">"abc"</span>
        b = <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>a<span style="color: #268bd2;">)</span>
        c = unsafe.<span style="color: #268bd2;">Sizeof</span><span style="color: #268bd2;">(</span>b<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>a, b, c<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">abc 3 8                                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>常量和iota是好朋友,iota能够提供"自增枚举值":
<ul class="org-ul">
<li>提供从0开始的自增枚举值是最简单的
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">const</span> <span style="color: #b58900;">(</span>
        Sunday = <span style="color: #268bd2; font-weight: bold;">iota</span>
        Monday
        Tuesday
        Wednesday
        Thursday
        Friday
        Saturday
    <span style="color: #b58900;">)</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0 1 2 3 4 5 6                                  //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>当前行的规则和"前面一行"的规则相同. 所以MB也是 1 &lt;&lt; (10 * iota) 只不过iota是2了
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">const</span> <span style="color: #b58900;">(</span>
        _        = <span style="color: #268bd2; font-weight: bold;">iota</span>             <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">itoa = 0</span>
        KB int64 = 1 &lt;&lt; <span style="color: #268bd2;">(</span>10 * <span style="color: #268bd2; font-weight: bold;">iota</span><span style="color: #268bd2;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">itoa = 1</span>
        MB                          <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Same with KB, but itoa = 2 here</span>
        GB
        TB
    <span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>KB, MB, GB, TB<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1024 1048576 1073741824 1099511627776          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>还可以在一组赋值中,多次使用iota
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">const</span> <span style="color: #b58900;">(</span>
        A, B = <span style="color: #268bd2; font-weight: bold;">iota</span>, <span style="color: #268bd2; font-weight: bold;">iota</span> &lt;&lt; 10
        C, D
    <span style="color: #b58900;">)</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>A, B, C, D<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0 0 1 1024                                     //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>如果iota的自增被打断,需要"显示"恢复,所谓显示,就是再输入一次iota
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">const</span> <span style="color: #b58900;">(</span>
        A = <span style="color: #268bd2; font-weight: bold;">iota</span>
        B
        C = <span style="color: #2aa198;">"c"</span>
        D        <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">same with previous</span>
        E = <span style="color: #268bd2; font-weight: bold;">iota</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">return to interrupted increasing number</span>
        F
    <span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>A, B, C, D, E, F<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0 1 c c 4 5                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>如果想让函数的参数"只有枚举类型和常量"可以访问,而普通变量无法轻易的作为函
数参数,那么可以使用"枚举+自定义类型"的方式
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Color</span> <span style="color: #b58900;">int</span>

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #2aa198;">(</span>
    Black Color = <span style="color: #268bd2; font-weight: bold;">iota</span>
    Red
    Blue
<span style="color: #2aa198;">)</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">(</span>c <span style="color: #b58900;">Color</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Color number is "</span>, c<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    c := Black
    <span style="color: #268bd2;">test</span><span style="color: #b58900;">(</span>c<span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Const is auto convert</span>
    <span style="color: #268bd2;">test</span><span style="color: #b58900;">(</span>1<span style="color: #b58900;">)</span>

    x := 1
    _ = x
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Error! can not use x (type int) as type Color in function argument</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">test(x)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Color number is  0                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Color number is  1                             //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">基本类型</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>go的类型更加明确,支持Unicode,支持常用数据结构,简单的几个类型如下
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="left" />

<col  class="right" />

<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Type</th>
<th scope="col" class="right">Length</th>
<th scope="col" class="right">Default</th>
<th scope="col" class="left">Range</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">bool</td>
<td class="right">1</td>
<td class="right">false</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">byte</td>
<td class="right">1</td>
<td class="right">0</td>
<td class="left">unit8</td>
</tr>

<tr>
<td class="left">rune</td>
<td class="right">4</td>
<td class="right">0</td>
<td class="left">Unicode Code Point, int32</td>
</tr>

<tr>
<td class="left">int,uint</td>
<td class="right">4 or 8</td>
<td class="right">0</td>
<td class="left">32bit or 64bit</td>
</tr>

<tr>
<td class="left">float32</td>
<td class="right">4</td>
<td class="right">0.0</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">float64</td>
<td class="right">8</td>
<td class="right">0.0</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">引用类型</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>引用类型(reference type)包括slice, map和channel.它们有复杂的内部结构使用的
时候需要:
<ul class="org-ul">
<li>申请内存
</li>
<li>初始化相关属性
</li>
</ul>
</li>
<li>内置函数new计算类型大小,为期分配零值内存,返回指针.而make是分配内存,初始化成
员列表,返回对象而非指针
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    a := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 0, 0<span style="color: #b58900;">}</span>
    a<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> = 10

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>a<span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">make return object</span>
    b := <span style="color: #657b83; font-weight: bold;">make</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">[]</span><span style="color: #b58900;">int</span>, 3<span style="color: #b58900;">)</span>
    b<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> = 10

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>b<span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">new return the pointer</span>
    c := <span style="color: #657b83; font-weight: bold;">new</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>*c<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">类型转换</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>不支持隐式类型转换,即便是从窄转向宽也不行
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">var</span> b byte = 100
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">var n int = b // Error: implicit convertation is not supported</span>
<span style="color: #859900; font-weight: bold;">var</span> n int = <span style="color: #268bd2;">int</span><span style="color: #2aa198;">(</span>b<span style="color: #2aa198;">)</span>              <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">ok for explicit convertation</span>
</pre>
</div>
</li>
<li>同样不能将其他类型当成bool值使用
<div class="org-src-container">

<pre class="src src-go">a := 100
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Error: non-bool a (type int) used as if condition</span>
<span style="color: #859900; font-weight: bold;">if</span> a <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">//</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">字符串</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li>字符串是immutable类型,内部指针指向UTF-8字节数组:
<ul class="org-ul">
<li>默认值是空字符串""
</li>
<li>用索引号访问某个字节,如s[i]
</li>
<li>不能用序列号获取字节元素指针,&amp;s[i]非法
</li>
<li>不可变类型,无法修改字节数组
</li>
<li>字节数组尾部不包含NULL
</li>
</ul>
</li>
<li>使用索引号访问字符(byte)
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #2aa198;">"abc"</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span> == <span style="color: #2aa198;">'\x61'</span>, s<span style="color: #268bd2;">[</span>1<span style="color: #268bd2;">]</span> == <span style="color: #2aa198;">'b'</span>, s<span style="color: #268bd2;">[</span>2<span style="color: #268bd2;">]</span> == 0x63<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true true true                                 //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>使用"`"定义不做转义处理的原始字符串,支持跨行
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #2aa198;">`a</span>
<span style="color: #2aa198;">b\r\n\x00</span>
<span style="color: #2aa198;">c`</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">a                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">b\r\n\x00                                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">c                                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>连接字符串时, "+"必须在上一行的末尾
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">'+' should be at the tail of the line</span>
    s := <span style="color: #2aa198;">"Hello, "</span> +
        <span style="color: #2aa198;">"World!"</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hello, World!                                  //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>支持用两个索引号返回子串，子串依然指向原字节数组
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #2aa198;">"Hello, World!"</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #268bd2;">[</span>:5<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #268bd2;">[</span>7:<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #268bd2;">[</span>1:5<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hello                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">World!                                         //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">ello                                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>单引号字符常量表示Unicode Code Point
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%T\n"</span>, <span style="color: #2aa198;">'a'</span><span style="color: #b58900;">)</span>

    <span style="color: #859900; font-weight: bold;">var</span> c1, c2 rune = <span style="color: #2aa198;">'\u6211'</span>, <span style="color: #2aa198;">'&#20204;'</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>c1 == <span style="color: #2aa198;">'&#25105;'</span>, <span style="color: #268bd2;">string</span><span style="color: #268bd2;">(</span>c2<span style="color: #268bd2;">)</span> == <span style="color: #2aa198;">"\xe4\xbb\xac"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">int32                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true true                                      //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>要修改字符串，可以先将其转换成[]rune或者[]byte，完成后再转换成为string，无论
哪种转换，都会重新分配内存，并复制字节数组
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #2aa198;">"abcd"</span>
    bs := <span style="color: #b58900;">[]</span><span style="color: #268bd2;">byte</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>

    bs<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> = <span style="color: #2aa198;">'B'</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">string</span><span style="color: #268bd2;">(</span>bs<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

    u := <span style="color: #2aa198;">"&#30005;&#33041;"</span>
    us := <span style="color: #b58900;">[]</span><span style="color: #268bd2;">rune</span><span style="color: #b58900;">(</span>u<span style="color: #b58900;">)</span>
    us<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> = <span style="color: #2aa198;">'&#35805;'</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">string</span><span style="color: #268bd2;">(</span>us<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">aBcd                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&#30005;&#35805;                                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>for 循环遍历也会使用byte和rune两种方式
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #2aa198;">"abc&#27721;&#23383;"</span>

    <span style="color: #859900; font-weight: bold;">for</span> i := 0; i &lt; <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>; i++ <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">Printf</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"%c, "</span>, s<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span><span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">()</span>

    <span style="color: #859900; font-weight: bold;">for</span> _, r := <span style="color: #859900; font-weight: bold;">range</span> s <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">Printf</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"%c,"</span>, r<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">a, b, c, &#230;, &#177;, &#137;, &#229;, &#173;, &#151;,               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">a,b,c,&#27721;,&#23383;,                                   //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7">指针</h3>
<div class="outline-text-3" id="text-1-7">
<ul class="org-ul">
<li>支持指针类型*T, 指针的指针**T, 以及包含包名前缀的*&lt;package&gt;.T
</li>
<li>go的指针的特点有如下:
<ul class="org-ul">
<li>默认值nil，没有NULL常量
</li>
<li>操作符"&amp;"取变量地址, "*"透过指针访问目标对象
</li>
<li>不支持指针运算，不支持"-&gt;"运算符，直接使用"."访问目标成员
</li>
</ul>
</li>
<li>例子如下
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">data</span> <span style="color: #859900; font-weight: bold;">struct</span><span style="color: #b58900;">{</span> a int <span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">var</span> d = <span style="color: #b58900;">data</span><span style="color: #b58900;">{</span>1234<span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">var</span> p *data

    p = &amp;d

    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%p, %v\n"</span>, p, p.a<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0xc082008310, 1234                             //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>不能对指针做加减法等运算
<div class="org-src-container">

<pre class="src src-go">x := 1234
p := &amp;x
p++
</pre>
</div>
</li>
<li>可以在unsafe.Pointer和任意类型指针间进行转换
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">(</span>
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"unsafe"</span>
<span style="color: #2aa198;">)</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    x := 0x12345678

    p := unsafe.<span style="color: #268bd2;">Pointer</span><span style="color: #b58900;">(</span>&amp;x<span style="color: #b58900;">)</span>
    n := <span style="color: #b58900;">(</span>*<span style="color: #268bd2;">[</span>4<span style="color: #268bd2;">]</span><span style="color: #b58900;">byte</span><span style="color: #b58900;">)(</span>p<span style="color: #b58900;">)</span>

    <span style="color: #859900; font-weight: bold;">for</span> i := 0; i &lt; <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #b58900;">(</span>n<span style="color: #b58900;">)</span>; i++ <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">Printf</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"%X "</span>, n<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span><span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">78 56 34 12                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>返回局部变量指针是安全的，编译器会根据需要将其分配在GC heap上
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> *<span style="color: #b58900;">int</span> <span style="color: #2aa198;">{</span>
    x := 100
    <span style="color: #859900; font-weight: bold;">return</span> &amp;x
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>将Point而转换成uintptr，可变相实现指针运算
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">(</span>
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"unsafe"</span>
<span style="color: #2aa198;">)</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    d := <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        s string
        x int
    <span style="color: #b58900;">}{</span><span style="color: #2aa198;">"abc"</span>, 100<span style="color: #b58900;">}</span>

    p := <span style="color: #268bd2;">uintptr</span><span style="color: #b58900;">(</span>unsafe.<span style="color: #268bd2;">Pointer</span><span style="color: #268bd2;">(</span>&amp;d<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
    p += unsafe.<span style="color: #268bd2;">Offsetof</span><span style="color: #b58900;">(</span>d.x<span style="color: #b58900;">)</span>
    p2 := unsafe.<span style="color: #268bd2;">Pointer</span><span style="color: #b58900;">(</span>p<span style="color: #b58900;">)</span>
    px := <span style="color: #b58900;">(</span>*int<span style="color: #b58900;">)(</span>p2<span style="color: #b58900;">)</span>
    *px = 200

    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%#v\n"</span>, d<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">struct { s string; x int }{s:"abc", x:200}     //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8">自定义类型</h3>
<div class="outline-text-3" id="text-1-8">
<ul class="org-ul">
<li>类型其实可以分成两大类：
<ul class="org-ul">
<li>命名类型，包括bool, int, string
</li>
<li>未命名类型，包括array, slice, map
</li>
</ul>
</li>
<li>具有相同声明的未命名类型被视为同一类型,比如：
<ul class="org-ul">
<li>具有相同基类型的指针
</li>
<li>具有相同元素类型和长度的array
</li>
<li>具有相同元素类型的slice
</li>
<li>具有相同键值类型的map
</li>
<li>具有相同元素类型和传输方向的channel
</li>
<li>具有相同字段序列(字段名，类型，标签，顺序）的匿名struct
</li>
<li>签名相同（参数和返回值，不包括参数名称）的function
</li>
<li>方法集相同(方法名，方法签名相同，和次序无关）的interface
</li>
</ul>
</li>
<li>a和b就不被认为是相同类型（不可以相互赋值）
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>

    <span style="color: #859900; font-weight: bold;">var</span> a <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        x int <span style="color: #2aa198;">`a`</span>
    <span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">var</span> b <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        x int <span style="color: #2aa198;">`ab`</span>
    <span style="color: #b58900;">}</span>

    _ = a
    _ = b
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Error! cannot use a (type struct { x int "a" })</span>
    <span style="color: #93a1a1;">//</span><span style="color: #93a1a1;">as type struct { x int "ab" } in assignment</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">b = a</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>可用type在全局或函数内定义新类型
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">bigint</span> <span style="color: #b58900;">int64</span>

    <span style="color: #859900; font-weight: bold;">var</span> x bigint = 100

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>x<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">100                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>新类型不是原类型的别名，除拥有相同的数据类型结构外，它们之间没有任何关系，不
会持有原类型任何信息。除非目标类型是未命名类型，否则必须显示转换
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    x := 1234
    <span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">bigint</span> <span style="color: #b58900;">int64</span>
    <span style="color: #859900; font-weight: bold;">var</span> b bigint = <span style="color: #268bd2;">bigint</span><span style="color: #b58900;">(</span>x<span style="color: #b58900;">)</span>
    <span style="color: #859900; font-weight: bold;">var</span> b2 int64 = <span style="color: #268bd2;">int64</span><span style="color: #b58900;">(</span>b<span style="color: #b58900;">)</span>

    <span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">myslice</span> <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span>
    <span style="color: #859900; font-weight: bold;">var</span> s myslice = <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>1, 2, 3<span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">var</span> s2 <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span> = s

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>b2<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s2<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1234                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[1 2 3]                                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">第二章 表达式</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">保留字</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>所有保留字如下
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">break</span>        <span style="color: #859900; font-weight: bold;">default</span>        <span style="color: #859900; font-weight: bold;">func</span>
<span style="color: #859900; font-weight: bold;">case</span>         <span style="color: #859900; font-weight: bold;">defer</span>          <span style="color: #859900; font-weight: bold;">go</span>
<span style="color: #859900; font-weight: bold;">chan</span>         <span style="color: #859900; font-weight: bold;">else</span>           <span style="color: #859900; font-weight: bold;">goto</span>
<span style="color: #859900; font-weight: bold;">const</span>        <span style="color: #859900; font-weight: bold;">fallthrough</span>    <span style="color: #859900; font-weight: bold;">if</span>
<span style="color: #859900; font-weight: bold;">continue</span>     <span style="color: #859900; font-weight: bold;">for</span>            <span style="color: #859900; font-weight: bold;">import</span>
<span style="color: #859900; font-weight: bold;">interface</span>      <span style="color: #859900; font-weight: bold;">select</span>
<span style="color: #859900; font-weight: bold;">map</span>            <span style="color: #859900; font-weight: bold;">struct</span>
<span style="color: #859900; font-weight: bold;">package</span>        <span style="color: #859900; font-weight: bold;">switch</span>
<span style="color: #859900; font-weight: bold;">range</span>          <span style="color: #859900; font-weight: bold;">type</span>
<span style="color: #859900; font-weight: bold;">return</span>         <span style="color: #859900; font-weight: bold;">var</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">运算符</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>几个常规的运算符.需要特别注意x$^y,其意义是把x中的某些bit上的值,值为零(无论
原来是1是0), 至于哪些位置y中所有为1,是由y中有哪些位置为1来决定的
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    a := 0x011
    b := 0x101
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>a &amp; b<span style="color: #b58900;">)</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>0x0001<span style="color: #b58900;">)</span>

    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>a | b<span style="color: #b58900;">)</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>0x0111<span style="color: #b58900;">)</span>

    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>a ^ b<span style="color: #b58900;">)</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>0x0110<span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">clear 1 to 0 on 0th and 3th from 0x101 for 0x011</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>a &amp;^ b<span style="color: #b58900;">)</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>0x010<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">273                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">273                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">272                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">272                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">16                                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">16                                             //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>不支持运算符重载
</li>
<li>尤其要注意的是"++", "&#x2013;"是语句而非表达式,这样做的原因,是为了防止一些低级错误
<div class="org-src-container">

<pre class="src src-go">n := 0
p := &amp;n
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">b := n++                     // syntax error</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">if n++ == 1 {}               // syntax error</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">++n                          // syntax error</span>

n++
*p++                            <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">(*p)++</span>
</pre>
</div>
</li>
<li>没有"~",取反也用"^"
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    x := 1
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>x<span style="color: #b58900;">)</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>^x<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">-2                                             //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">初始化</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>初始化复合类型,必须使用type,左括号必须在类型的尾部,而不是另起一行
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    a := <span style="color: #859900; font-weight: bold;">struct</span><span style="color: #b58900;">{</span> x int <span style="color: #b58900;">}{</span>100<span style="color: #b58900;">}</span>
    b := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>1, 2, 3<span style="color: #b58900;">}</span>

    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>a<span style="color: #b58900;">)</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>b<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{100}                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[1 2 3]                                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>初始化以','分割,可以分几行,但是最后一行必须是以','或者'}'结尾,这里可以放心
因为gofmt会帮助你.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">控制流</h3>
<div class="outline-text-3" id="text-2-4">
</div><div id="outline-container-sec-2-4-1" class="outline-4">
<h4 id="sec-2-4-1">if</h4>
<div class="outline-text-4" id="text-2-4-1">
<ul class="org-ul">
<li>if的写法和c有如下区别:
<ul class="org-ul">
<li>条件表达式括号省略了
</li>
<li>可以定义局部变量
</li>
<li>左括号必须在最后
</li>
</ul>
</li>
<li>注意!不支持三元操作符 "a &gt; b ? a : b"
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-4-2" class="outline-4">
<h4 id="sec-2-4-2">for (while)</h4>
<div class="outline-text-4" id="text-2-4-2">
<ul class="org-ul">
<li>go中只有for,没有while:
<ul class="org-ul">
<li>常见的for循环,各种语言都有
<div class="org-src-container">

<pre class="src src-go">s := <span style="color: #2aa198;">"abc"</span>

<span style="color: #859900; font-weight: bold;">for</span> i, n := 0, <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #2aa198;">(</span>s<span style="color: #2aa198;">)</span>; i &lt; n; i++ <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>s<span style="color: #268bd2;">[</span>i<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>替代while (n &gt; 0)
<div class="org-src-container">

<pre class="src src-go">n := <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #2aa198;">(</span>s<span style="color: #2aa198;">)</span>
<span style="color: #859900; font-weight: bold;">for</span> n &gt; 0 <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>s<span style="color: #268bd2;">[</span>n<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>
    n--
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>替代while(true)
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">for</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-4-3" class="outline-4">
<h4 id="sec-2-4-3">range</h4>
<div class="outline-text-4" id="text-2-4-3">
<ul class="org-ul">
<li>range操作的核心是返回(key,value), (key, value)并不是只有map有,其他的几种类
型如果能使用range的话,也有其`key`和`value`
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">1st value (key)</th>
<th scope="col" class="left">2nd value(value)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">string</td>
<td class="left">index</td>
<td class="left">s[index]</td>
</tr>

<tr>
<td class="left">array/slice</td>
<td class="left">index</td>
<td class="left">s[index]</td>
</tr>

<tr>
<td class="left">map</td>
<td class="left">key</td>
<td class="left">value</td>
</tr>

<tr>
<td class="left">channel</td>
<td class="left">element</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</li>
<li>range的使用方法如下, 不想使用的部分使用`_`
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">string/array/slice they are the same</span>
    s := <span style="color: #2aa198;">"abc"</span>
    <span style="color: #859900; font-weight: bold;">for</span> i, j := <span style="color: #859900; font-weight: bold;">range</span> s <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">printf</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"%d  %c\n"</span>, i, j<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">for</span> _, c := <span style="color: #859900; font-weight: bold;">range</span> s <span style="color: #b58900;">{</span>
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span>c<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>

    <span style="color: #93a1a1;">//</span><span style="color: #93a1a1;">map</span>
    m := <span style="color: #859900; font-weight: bold;">map</span><span style="color: #b58900;">[</span><span style="color: #b58900;">string</span><span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span><span style="color: #2aa198;">"a"</span>: 1, <span style="color: #2aa198;">"b"</span>: 2<span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">for</span> k, v := <span style="color: #859900; font-weight: bold;">range</span> m <span style="color: #b58900;">{</span>
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span>k, v<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0  a                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1  b                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2  c                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">97                                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">98                                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">99                                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">a 1                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">b 2                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>range会涉及到"值拷贝",也就是说:
<ul class="org-ul">
<li>如果range所处理的类型是值, 那么key, value返回的都是copy value,典型的例子
就是array,下面的例子中`a`虽然已经开始被置为999,但是因为其"原始值"1已经
在range调用那一刻被拷贝出来了,所以a= v + 100的时候, v还是1
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">array is not reference type, everytime range will</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">copy the value to i and v</span>
    a := <span style="color: #b58900;">[</span>3<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2<span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">for</span> i, v := <span style="color: #859900; font-weight: bold;">range</span> a <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">if</span> i == 0 <span style="color: #268bd2;">{</span>
            a<span style="color: #6c71c4;">[</span>1<span style="color: #6c71c4;">]</span>, a<span style="color: #6c71c4;">[</span>2<span style="color: #6c71c4;">]</span> = 999, 999
            fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #6c71c4;">(</span>a<span style="color: #6c71c4;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">change a's value succesfully</span>
        <span style="color: #268bd2;">}</span>
        a<span style="color: #268bd2;">[</span>i<span style="color: #268bd2;">]</span> = v + 100 <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">use a's copied value to construct the final version</span>

    <span style="color: #b58900;">}</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>a<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 999 999]                                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[100 101 102]                                  //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>所以我们最好让range处理引用类型的容器,array的好基友slice就是引用类型的
"数组", 下面的例子中
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">slice here is reference type, no copy happened when ranging</span>
    s := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>1, 2, 3, 4, 5<span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">for</span> i, v := <span style="color: #859900; font-weight: bold;">range</span> s <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">if</span> i == 0 <span style="color: #268bd2;">{</span>
            <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">change s's size will not deduced the iteration times</span>
            s = s<span style="color: #6c71c4;">[</span>:3<span style="color: #6c71c4;">]</span>
            s<span style="color: #6c71c4;">[</span>2<span style="color: #6c71c4;">]</span> = 100
        <span style="color: #268bd2;">}</span>

        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span>i, v<span style="color: #268bd2;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">s[2] will changed</span>
    <span style="color: #b58900;">}</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">s[2] will changed</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0 1                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1 2                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2 100                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">3 4                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">4 5                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[1 2 100]                                      //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-4-4" class="outline-4">
<h4 id="sec-2-4-4">switch</h4>
<div class="outline-text-4" id="text-2-4-4">
<ul class="org-ul">
<li>switch表达式可以是任意类型,不限于常量:
<ul class="org-ul">
<li>可以省略break,默认自动终止
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    x := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>1, 2, 3<span style="color: #b58900;">}</span>
    i := 2

    <span style="color: #859900; font-weight: bold;">switch</span> i <span style="color: #b58900;">{</span>
    <span style="color: #859900; font-weight: bold;">case</span> x<span style="color: #268bd2;">[</span>1<span style="color: #268bd2;">]</span>:
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"a"</span><span style="color: #268bd2;">)</span>
    <span style="color: #859900; font-weight: bold;">case</span> 1, 3:
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"b"</span><span style="color: #268bd2;">)</span>
    <span style="color: #859900; font-weight: bold;">default</span>:
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"c"</span><span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">a                                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>可以继续下一个(不是全部)分支,使用fallthrough, 但是条件不再判断(也就是自
动运行下一个分支)
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    x := 10
    <span style="color: #859900; font-weight: bold;">switch</span> x <span style="color: #b58900;">{</span>
    <span style="color: #859900; font-weight: bold;">case</span> 10:
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"a"</span><span style="color: #268bd2;">)</span>
        <span style="color: #859900; font-weight: bold;">fallthrough</span>
    <span style="color: #859900; font-weight: bold;">case</span> 0:
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"b"</span><span style="color: #268bd2;">)</span>
    <span style="color: #859900; font-weight: bold;">case</span> -1:
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"c"</span><span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">a                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">b                                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</li>
<li>switch省略条件表达式,或者把条件表达式作为初始化条件,可以把switch作为if
elseif else来用
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">switch</span> <span style="color: #2aa198;">{</span>
<span style="color: #859900; font-weight: bold;">case</span> x<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> &gt; 0:
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"a"</span><span style="color: #b58900;">)</span>
<span style="color: #859900; font-weight: bold;">case</span> x<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> &lt; 0:
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"b"</span><span style="color: #b58900;">)</span>
<span style="color: #859900; font-weight: bold;">default</span>:
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"c"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-4-5" class="outline-4">
<h4 id="sec-2-4-5">goto, break, continue</h4>
<div class="outline-text-4" id="text-2-4-5">
<ul class="org-ul">
<li>goto和c里面差不多,只不过标签必须使用大写
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>

    <span style="color: #859900; font-weight: bold;">var</span> i int
    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #b58900;">{</span>
        fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #268bd2;">(</span>i<span style="color: #268bd2;">)</span>
        i++
        <span style="color: #859900; font-weight: bold;">if</span> i &gt; 2 <span style="color: #268bd2;">{</span>
            <span style="color: #859900; font-weight: bold;">goto</span> <span style="color: #859900; font-weight: bold;">break</span>
        <span style="color: #268bd2;">}</span>
    <span style="color: #b58900;">}</span>
<span style="color: #859900; font-weight: bold;">break</span>:
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"break"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">break                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>break用于在for, switch, select里面跳出当前循环, continue是进入下一次循环,
只能用于for循环
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">第三章 函数</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">函数定义</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>bgo首先去掉了几个不太实用的函数feature:
<ul class="org-ul">
<li>不支持嵌套(nested)
</li>
<li>不支持重载(overload)
</li>
<li>不支持默认参数(default parameter)
</li>
</ul>
</li>
<li>go函数有如下特点:
<ul class="org-ul">
<li>不需要声明原形
</li>
<li>支持不定长变参数
</li>
<li>支持多返回值
</li>
<li>支持命名返回参数
</li>
<li>支持匿名函数和闭包
</li>
</ul>
</li>
<li>使用func定义函数,格式你懂的
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">(</span>x, y <span style="color: #b58900;">int</span>, s <span style="color: #b58900;">string</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">(</span><span style="color: #b58900;">int</span>, <span style="color: #b58900;">string</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    n := x + y
    <span style="color: #859900; font-weight: bold;">return</span> n, fmt.<span style="color: #268bd2;">sprintf</span><span style="color: #b58900;">(</span>s, n<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>函数是first-class 对象.可以作为参数传递.可以使用type将复杂函数定义为函数类型
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">(</span>fn <span style="color: #859900; font-weight: bold;">func</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #b58900;">int</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2;">fn</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">formatfunc</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #2aa198;">(</span>s <span style="color: #b58900;">string</span>, x, y <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #b58900;">string</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">format</span><span style="color: #2aa198;">(</span>fn <span style="color: #b58900;">formatfunc</span>, s <span style="color: #b58900;">string</span>, x, y <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2;">fn</span><span style="color: #b58900;">(</span>s, x, y<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s1 := <span style="color: #268bd2;">test</span><span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">()</span> <span style="color: #b58900;">int</span> <span style="color: #268bd2;">{</span> <span style="color: #859900; font-weight: bold;">return</span> 100 <span style="color: #268bd2;">}</span><span style="color: #b58900;">)</span>
    s2 := <span style="color: #268bd2;">format</span><span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">(</span>s <span style="color: #b58900;">string</span>, x, y <span style="color: #b58900;">int</span><span style="color: #268bd2;">)</span> <span style="color: #b58900;">string</span> <span style="color: #268bd2;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">sprintf</span><span style="color: #6c71c4;">(</span>s, x, y<span style="color: #6c71c4;">)</span>
    <span style="color: #268bd2;">}</span>, <span style="color: #2aa198;">"%d, %d"</span>, 10, 20<span style="color: #b58900;">)</span>

    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>s1<span style="color: #b58900;">)</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>s2<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">100                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">10, 20                                         //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">变参类型</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>变参其实就是最后一个参数是slice(只能有一个),而且使用slice变量作为参数的时候,
得写成'x&#x2026;'
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">(</span>s <span style="color: #b58900;">string</span>, n ...<span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">var</span> x int
    <span style="color: #859900; font-weight: bold;">for</span> _, i := <span style="color: #859900; font-weight: bold;">range</span> n <span style="color: #b58900;">{</span>
        x += i
    <span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">sprintf</span><span style="color: #b58900;">(</span>s, x<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>

    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">test</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"sum: %d"</span>, 1, 2, 3<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
    s := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>1, 2, 3, 4, 5<span style="color: #b58900;">}</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">test</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"sum: %d"</span>, s...<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">sum: 6                                         //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">sum: 15                                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">返回值</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>不能使用容器接收多返回值,只能使用多个变量.不像要的参数使用"_"忽略
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">(</span><span style="color: #b58900;">int</span>, <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> 1, 2
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">error =&gt; multiple-value test() in single-value context</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">s := make([]int, 2)</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">s = test()</span>
    x, _ := <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>x<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1                                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>多返回值作为实参:
<ul class="org-ul">
<li>理所当然可以看成是slice,所以可以作为n&#x2026;类型的实参.
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">(</span><span style="color: #b58900;">int</span>, <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> 1, 2
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">sum</span><span style="color: #2aa198;">(</span>n ...<span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #b58900;">int</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">var</span> x int

    <span style="color: #859900; font-weight: bold;">for</span> _, i := <span style="color: #859900; font-weight: bold;">range</span> n <span style="color: #b58900;">{</span>
        x += i
    <span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">return</span> x
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">sum</span><span style="color: #268bd2;">(</span><span style="color: #268bd2;">test</span><span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">3                                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>参数有x,y int类型的情况下,也可以使用多返回值作为实参
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">(</span><span style="color: #b58900;">int</span>, <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> 1, 2
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">add</span><span style="color: #2aa198;">(</span>x, y <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #b58900;">int</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> x + y
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">add</span><span style="color: #268bd2;">(</span><span style="color: #268bd2;">test</span><span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">3                                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</li>
<li>如果返回值写"名字",那么就等同于设置了这个"名字"的局部变量,return后面啥都没
有的话,就是隐式返回.
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">add</span><span style="color: #2aa198;">(</span>x, y <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">(</span>z <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    z = x + y
    <span style="color: #859900; font-weight: bold;">return</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">add</span><span style="color: #268bd2;">(</span>1, 2<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">3                                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">匿名函数</h3>
<div class="outline-text-3" id="text-3-4">
<ul class="org-ul">
<li>匿名函数也是神通广大,可以:
<ul class="org-ul">
<li>赋值给变量:
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>

    fns := <span style="color: #b58900;">[](</span><span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">(</span>x <span style="color: #b58900;">int</span><span style="color: #268bd2;">)</span> <span style="color: #b58900;">int</span><span style="color: #b58900;">){</span>
        <span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">(</span>x <span style="color: #b58900;">int</span><span style="color: #268bd2;">)</span> <span style="color: #b58900;">int</span> <span style="color: #268bd2;">{</span> <span style="color: #859900; font-weight: bold;">return</span> x + 1 <span style="color: #268bd2;">}</span>,
        <span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">(</span>x <span style="color: #b58900;">int</span><span style="color: #268bd2;">)</span> <span style="color: #b58900;">int</span> <span style="color: #268bd2;">{</span> <span style="color: #859900; font-weight: bold;">return</span> x + 2 <span style="color: #268bd2;">}</span>,
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>fns<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">](</span>100<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">101                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>作为结构字段:
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    d := <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        fn <span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">()</span> <span style="color: #b58900;">string</span>
    <span style="color: #b58900;">}{</span>
        <span style="color: #268bd2; font-weight: bold;">fn</span>: <span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">()</span> <span style="color: #b58900;">string</span> <span style="color: #268bd2;">{</span> <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #2aa198;">"hello, world"</span> <span style="color: #268bd2;">}</span>,
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span>d.<span style="color: #268bd2;">fn</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">hello, world                                   //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>在channel里面传送:
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fc := <span style="color: #657b83; font-weight: bold;">make</span><span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">chan</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">()</span> <span style="color: #b58900;">string</span>, 2<span style="color: #b58900;">)</span>
    fc &lt;- <span style="color: #859900; font-weight: bold;">func</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">string</span> <span style="color: #b58900;">{</span> <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #2aa198;">"hello world"</span> <span style="color: #b58900;">}</span>
    fmt.<span style="color: #657b83; font-weight: bold;">println</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">(</span>&lt;-fc<span style="color: #268bd2;">)()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================output===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">hello world                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">延迟调用</h3>
<div class="outline-text-3" id="text-3-5">
<ul class="org-ul">
<li>关键字defer用于注册延迟调用,这些调用知道return之前才执行,通常用于释放资源或
错误处理
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">(</span>
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"os"</span>
<span style="color: #2aa198;">)</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">error</span> <span style="color: #2aa198;">{</span>
    f, err := os.<span style="color: #268bd2;">Create</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"test.txt"</span><span style="color: #b58900;">)</span>

    <span style="color: #859900; font-weight: bold;">if</span> err != <span style="color: #268bd2; font-weight: bold;">nil</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> err
    <span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">defer</span> f.<span style="color: #268bd2;">Close</span><span style="color: #b58900;">()</span>
    f.<span style="color: #268bd2;">WriteString</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Hello World"</span><span style="color: #b58900;">)</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">nil</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    err := <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
    <span style="color: #859900; font-weight: bold;">if</span> err != <span style="color: #268bd2; font-weight: bold;">nil</span> <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Error"</span><span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>可以使用下面的方法"延迟读取"
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    x, y := 10, 20

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">take x as parameter for anoymous function, saved x's value</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">as 10.</span>
    <span style="color: #859900; font-weight: bold;">defer</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #b58900;">(</span>i <span style="color: #b58900;">int</span><span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"defer:"</span>, i, y<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}(</span>x<span style="color: #b58900;">)</span>

    x += 10
    y += 100
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"x = "</span>, x, <span style="color: #2aa198;">"y = "</span>, y<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">x =  20 y =  120                               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">defer: 10 120                                  //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6">错误处理</h3>
<div class="outline-text-3" id="text-3-6">
<ul class="org-ul">
<li>没有结构化异常, 使用panic抛出错误,然后使用recover捕获错误
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">defer</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">if</span> err := <span style="color: #657b83; font-weight: bold;">recover</span><span style="color: #268bd2;">()</span>; err != <span style="color: #268bd2; font-weight: bold;">nil</span> <span style="color: #268bd2;">{</span>
            fmt.<span style="color: #268bd2;">Println</span><span style="color: #6c71c4;">(</span>err.<span style="color: #859900;">(</span><span style="color: #b58900;">string</span><span style="color: #859900;">)</span><span style="color: #6c71c4;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">err is interface{} type and now convert it to string</span>
        <span style="color: #268bd2;">}</span>
    <span style="color: #b58900;">}()</span>

    <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"panic error!"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">panic error!                                   //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>上面有err转化成string的部分,因为panic, recover的参数都是interface{}类型,因
此可以抛出任何类型的对象
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">func</span> <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #2aa198;">(</span>v <span style="color: #859900; font-weight: bold;">interface</span><span style="color: #b58900;">{}</span><span style="color: #2aa198;">)</span>
<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #657b83; font-weight: bold;">recover</span><span style="color: #2aa198;">()</span> <span style="color: #859900; font-weight: bold;">interface</span><span style="color: #2aa198;">{}</span>
</pre>
</div>
</li>
<li>延迟调用中引发的错误,可以被后续延迟调用捕获,但仅最后一个错误可以被捕获
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">defer</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span><span style="color: #657b83; font-weight: bold;">recover</span><span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}()</span>

    <span style="color: #859900; font-weight: bold;">defer</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"defer panic"</span><span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}()</span>

    <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"test panic"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">defer panic                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>捕获函数recover必须在两个地方:
<ul class="org-ul">
<li>匿名函数:
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">defer</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #657b83; font-weight: bold;">recover</span><span style="color: #268bd2;">()</span>
    <span style="color: #b58900;">}()</span>
    <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"test panic"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>函数体内才能起作用.
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">except</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #657b83; font-weight: bold;">recover</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">defer</span> <span style="color: #268bd2;">except</span><span style="color: #b58900;">()</span>
    <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"test panic"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
</ul>
</li>
<li>其他方式(不在函数里面,或者是两层函数),总是失败,recover()会返回nil
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">defer</span> <span style="color: #657b83; font-weight: bold;">recover</span><span style="color: #b58900;">()</span>
    <span style="color: #859900; font-weight: bold;">defer</span> fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span><span style="color: #657b83; font-weight: bold;">recover</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>

    <span style="color: #859900; font-weight: bold;">defer</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">()</span> <span style="color: #268bd2;">{</span>
            fmt.<span style="color: #268bd2;">Println</span><span style="color: #6c71c4;">(</span><span style="color: #2aa198;">"defer inner"</span><span style="color: #6c71c4;">)</span>
            <span style="color: #657b83; font-weight: bold;">recover</span><span style="color: #6c71c4;">()</span>
        <span style="color: #268bd2;">}()</span>
    <span style="color: #b58900;">}()</span>

    <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"test panic"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">test</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">defer inner                                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;nil&gt;                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">panic: test panic                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>除了使用panic引发中断性错误外,还可以使用error类型来返回错误,error类型其实是
一个接口,定义如下
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">error</span> <span style="color: #859900; font-weight: bold;">interface</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">Error</span><span style="color: #b58900;">()</span> string
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>我们可以使用errors.New来创建一个error类型的instance,使用方法如下
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>
<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"errors"</span>

<span style="color: #859900; font-weight: bold;">var</span> ErrDivByZero = errors.<span style="color: #268bd2;">New</span><span style="color: #2aa198;">(</span><span style="color: #2aa198;">"hfeng: division by zero"</span><span style="color: #2aa198;">)</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">div</span><span style="color: #2aa198;">(</span>x, y <span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">(</span><span style="color: #b58900;">int</span>, <span style="color: #b58900;">error</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">if</span> y == 0 <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> 0, ErrDivByZero
    <span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">return</span> x / y, <span style="color: #268bd2; font-weight: bold;">nil</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">switch</span> z, err := <span style="color: #268bd2;">div</span><span style="color: #b58900;">(</span>10, 0<span style="color: #b58900;">)</span>; err <span style="color: #b58900;">{</span>
    <span style="color: #859900; font-weight: bold;">case</span> <span style="color: #268bd2; font-weight: bold;">nil</span>:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span>z<span style="color: #268bd2;">)</span>
    <span style="color: #859900; font-weight: bold;">case</span> ErrDivByZero:
        <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #268bd2;">(</span>err<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">panic: hfeng: division by zero                 //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">第四章 数据</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Array</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>数组和以往认知的数组有很大的不同:
<ul class="org-ul">
<li>数组是值类型,赋值和传参数会复制整个数组,而不是指针(所以有时候传递数组给函
数的话,代价很大)
</li>
<li>数组长度必须是常量,且是类型的组成部分.int和int是不同类型
</li>
<li>支持"==", "!="操作符
</li>
<li>支持数组[n]*T, 数组指针*[n]T (这里看出类型在后的好处了)
</li>
</ul>
</li>
<li>和c语言相比,go的数组初始化方法非常的多样化
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    a := <span style="color: #b58900;">[</span>3<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>1, 2<span style="color: #b58900;">}</span>
    b := <span style="color: #b58900;">[</span>...<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>1, 2, 3, 4<span style="color: #b58900;">}</span>
    c := <span style="color: #b58900;">[</span>5<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>2: 100, 4: 200<span style="color: #b58900;">}</span>

    d := <span style="color: #b58900;">[</span>...<span style="color: #b58900;">]</span><span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        name string
        age  uint8
    <span style="color: #b58900;">}{</span>
        <span style="color: #268bd2;">{</span><span style="color: #2aa198;">"user1"</span>, 10<span style="color: #268bd2;">}</span>,
        <span style="color: #268bd2;">{</span><span style="color: #2aa198;">"user2"</span>, 20<span style="color: #268bd2;">}</span>,
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>a<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>b<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>c<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>d<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[1 2 0]                                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[1 2 3 4]                                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 0 100 0 200]                                //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[{user1 10} {user2 20}]                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>多维数组初始化方法如下, 需要注意的是,只支持第一维度的设置为"&#x2026;"
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    a := <span style="color: #b58900;">[</span>2<span style="color: #b58900;">][</span>3<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span><span style="color: #268bd2;">{</span>1, 2, 3<span style="color: #268bd2;">}</span>, <span style="color: #268bd2;">{</span>4, 5, 6<span style="color: #268bd2;">}</span><span style="color: #b58900;">}</span>
    b := <span style="color: #b58900;">[</span>...<span style="color: #b58900;">][</span>2<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span><span style="color: #268bd2;">{</span>1, 1<span style="color: #268bd2;">}</span>, <span style="color: #268bd2;">{</span>2, 2<span style="color: #268bd2;">}</span>, <span style="color: #268bd2;">{</span>3, 3<span style="color: #268bd2;">}</span><span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>a<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>b<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[[1 2 3] [4 5 6]]                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[[1 1] [2 2] [3 3]]                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>值拷贝行为会造成性能的下降,因为会复制整个数组
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">test</span><span style="color: #2aa198;">(</span>x <span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"x: %p\n"</span>, &amp;x<span style="color: #b58900;">)</span>
    x<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> = 1000
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    a := <span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{}</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"a: %p\n"</span>, &amp;a<span style="color: #b58900;">)</span>

    <span style="color: #268bd2;">test</span><span style="color: #b58900;">(</span>a<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>a<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">a: 0xc082008310                                //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">x: 0xc082008350                                //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 0]                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>内置的len和cap对于数组来说都是返回数组长度(元素数量),因为不可能有空间而不放
数据
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    a := <span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span><span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>a<span style="color: #268bd2;">)</span>, <span style="color: #657b83; font-weight: bold;">cap</span><span style="color: #268bd2;">(</span>a<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2 2                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Slice</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li>slice是go语言对于array的一种补充,因为array是值传递的,为了减少值传递作为参数
等情况下带来的性能问题,go特地发明了array的引用类型"替身"&#x2013;slice
</li>
<li>slice在go的源代码里面其实就是1指针数组2长度3容量的一个组合
<div class="org-src-container">

<pre class="src src-c"><span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">Slice</span>
<span style="color: #2aa198;">{</span>
    <span style="color: #b58900;">byte</span>* <span style="color: #268bd2;">array</span>;
    <span style="color: #b58900;">uintgo</span> <span style="color: #268bd2;">len</span>;
    <span style="color: #b58900;">uintgo</span> <span style="color: #268bd2;">cap</span>;
<span style="color: #2aa198;">}</span>;
</pre>
</div>
</li>
<li>我们通过下面一个例子来看看slice和其"被绑定"数组的关系:
<ul class="org-ul">
<li>先看源代码:
<div class="org-src-container">

<pre class="src src-go">data := <span style="color: #2aa198;">[</span>...<span style="color: #2aa198;">]</span><span style="color: #b58900;">int</span><span style="color: #2aa198;">{</span>0, 1, 2, 3, 4, 5, 6<span style="color: #2aa198;">}</span>
slice := data<span style="color: #2aa198;">[</span>1:4:5<span style="color: #2aa198;">]</span>            <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[low:high:max]</span>
</pre>
</div>
</li>
<li>再来看看两者的关系(图例)
<pre class="example">
              +- low   high -+    +- max                                   len = high - low
              |              |    |                                        cap = max  - low
      +---+---+---+---+---+---+---+           +---------+---------+---------+
data  | 0 | 1 | 2 | 3 | 4 | 5 | 6 |    slice  | pointer | len = 3 | cap = 4 |
      +---+---+---+---+---+---+---+           +---------+---------+---------+
              |&lt;--- len ----&gt;|    |                              |
              |                   |                              |
              |&lt;----- cap -------&gt;|                              |
              |                                                  |
              +-------&lt;&lt;&lt;-------- slice.array pointer ---&lt;&lt;&lt;-----+
</pre>
</li>
</ul>
</li>
<li>使用[low:high:max]方法从已有数组创建slice的情况,不一定每次都全面的提供low,
high, max.使用默认值的情况总计如下:
<ul class="org-ul">
<li>代码
<div class="org-src-container">

<pre class="src src-go">data := <span style="color: #2aa198;">[</span>...<span style="color: #2aa198;">]</span><span style="color: #b58900;">int</span><span style="color: #2aa198;">{</span>0, 1, 2, 3, 4, 5, 6, 7, 8, 9<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>从data创建slice的各种默认值组合
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="right" />

<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">expression</th>
<th scope="col" class="left">slice</th>
<th scope="col" class="right">len</th>
<th scope="col" class="right">cap</th>
<th scope="col" class="left">comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">data[:6:8]</td>
<td class="left">[0 1 2 3 4 5]</td>
<td class="right">6</td>
<td class="right">8</td>
<td class="left">low is array's low</td>
</tr>

<tr>
<td class="left">data[5:]</td>
<td class="left">[5 6 7 8 9]</td>
<td class="right">5</td>
<td class="right">5</td>
<td class="left">high is array's high, max is array{low, high}</td>
</tr>

<tr>
<td class="left">data[:3]</td>
<td class="left">[0 1 2]</td>
<td class="right">3</td>
<td class="right">10</td>
<td class="left">low is array's low, max is array{low, high}</td>
</tr>

<tr>
<td class="left">data[:]</td>
<td class="left">[0 1 2 3 4 5 6 7 8 9]</td>
<td class="right">10</td>
<td class="right">10</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li>如果slice是从某个数组创建的话,那么对于slice的读写操作其实就是对于底层数组的
读写
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    data := <span style="color: #b58900;">[</span>...<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2, 3, 4, 5<span style="color: #b58900;">}</span>

    s := data<span style="color: #b58900;">[</span>2:4<span style="color: #b58900;">]</span>
    s<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span> += 100
    s<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> += 200

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>data<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[102 203]                                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 102 203 4 5]                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>slice如果创建的时候还要带个拖油瓶的"数组"那用起来太麻烦了,go还是可以"直接创
建"slice的
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s1 := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2, 3, 8: 100<span style="color: #b58900;">}</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Note! there are nothing in []</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s1, <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>s1<span style="color: #268bd2;">)</span>, <span style="color: #657b83; font-weight: bold;">cap</span><span style="color: #268bd2;">(</span>s1<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

    s2 := <span style="color: #657b83; font-weight: bold;">make</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">[]</span><span style="color: #b58900;">int</span>, 6, 8<span style="color: #b58900;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">make to create, len and cap as parameter</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s2, <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>s1<span style="color: #268bd2;">)</span>, <span style="color: #657b83; font-weight: bold;">cap</span><span style="color: #268bd2;">(</span>s1<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

    s3 := <span style="color: #657b83; font-weight: bold;">make</span><span style="color: #b58900;">(</span><span style="color: #268bd2;">[]</span><span style="color: #b58900;">int</span>, 6<span style="color: #b58900;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">len == cap here</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s3, <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>s3<span style="color: #268bd2;">)</span>, <span style="color: #657b83; font-weight: bold;">cap</span><span style="color: #268bd2;">(</span>s3<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 2 3 0 0 0 0 100] 9 9                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 0 0 0 0 0] 9 9                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 0 0 0 0 0] 6 6                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>直接创建slice是非常"经济"的一件事情,因为大部分情况下都是用slice的,实在想使
用数组还可以使用指针来直接访问数组
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2, 3<span style="color: #b58900;">}</span>

    p := &amp;s<span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">*int, got underlying array pointer</span>
    *p += 100

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 102 3]                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>我们看到了[]里面没有东西是slice的特点,所以[][]T的类型是'[]T的数组'
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    data := <span style="color: #b58900;">[][]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>
        <span style="color: #268bd2;">[]</span><span style="color: #b58900;">int</span><span style="color: #268bd2;">{</span>1, 2, 3<span style="color: #268bd2;">}</span>,
        <span style="color: #268bd2;">[]</span><span style="color: #b58900;">int</span><span style="color: #268bd2;">{</span>100, 200<span style="color: #268bd2;">}</span>,
        <span style="color: #268bd2;">[]</span><span style="color: #b58900;">int</span><span style="color: #268bd2;">{</span>11, 22, 33, 44<span style="color: #268bd2;">}</span>,
    <span style="color: #b58900;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>data<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[[1 2 3] [100 200] [11 22 33 44]]              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>可以直接更改struct数组(或slice)的内部成员
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    d := <span style="color: #b58900;">[</span>5<span style="color: #b58900;">]</span><span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        x int
    <span style="color: #b58900;">}{}</span>

    s := d<span style="color: #b58900;">[</span>:<span style="color: #b58900;">]</span>

    d<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span>.x = 10
    s<span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span>.x = 20

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>d<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%p, %p\n"</span>, &amp;d, &amp;d<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[{0} {10} {20} {0} {0}]                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0xc082003f80, 0xc082003f80                     //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
<div id="outline-container-sec-4-2-1" class="outline-4">
<h4 id="sec-4-2-1">reslice</h4>
<div class="outline-text-4" id="text-4-2-1">
<ul class="org-ul">
<li>所谓reslice是基于已有slice创建新的slice对象.以便在cap允许范围内调整属性,每
次获得新的slice,其len,cap等属性都会变化:
<ul class="org-ul">
<li>代码如下:每次创建的新slice其[low,high,max]都会有所改动.
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2, 3, 4, 5, 6, 7, 8, 9<span style="color: #b58900;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s, <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>s<span style="color: #268bd2;">)</span>, <span style="color: #657b83; font-weight: bold;">cap</span><span style="color: #268bd2;">(</span>s<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

    s1 := s<span style="color: #b58900;">[</span>2:5<span style="color: #b58900;">]</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s1, <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>s1<span style="color: #268bd2;">)</span>, <span style="color: #657b83; font-weight: bold;">cap</span><span style="color: #268bd2;">(</span>s1<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
    s2 := s1<span style="color: #b58900;">[</span>2:6:7<span style="color: #b58900;">]</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s2, <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>s2<span style="color: #268bd2;">)</span>, <span style="color: #657b83; font-weight: bold;">cap</span><span style="color: #268bd2;">(</span>s2<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">s3 := s2[3:6]                    // Error out of range</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 2 3 4 5 6 7 8 9] 10 10                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[2 3 4] 3 8                                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[4 5 6 7] 4 5                                  //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>图例如下最后s2已经变成4,5,6,7, size为4, cap为7了,所以你的s3超过了我s2的cap
<pre class="example">
     +-+-+-+-+-+-+-+-+-+-+
data |0|1|2|3|4|5|6|7|8|9|
     +-+-+-+-+-+-+-+-+-+-+
         +-+-+-+-+-+-+-+-+
s1       |2|3|4| | | | | | len = 3, cap = 8
         +-+-+-+-+-+-+-+-+
             +-+-+-+-+-+
s2           |4|5|6|7| |   len = 4, cap = 5
             +-+-+-+-+-+
                   +-+-+-+
s3                 |7|8|X| error: slice bounds out of range
                   +-+-+-+
</pre>
</li>
</ul>
</li>
<li>新的对象,依然是指向底层数组
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    s := <span style="color: #b58900;">[]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2, 3, 4, 5, 6, 7, 8, 9<span style="color: #b58900;">}</span>

    s1 := s<span style="color: #b58900;">[</span>2:5<span style="color: #b58900;">]</span>
    s1<span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span> = 100

    s2 := s1<span style="color: #b58900;">[</span>2:6<span style="color: #b58900;">]</span>
    s2<span style="color: #b58900;">[</span>3<span style="color: #b58900;">]</span> = 200

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 2 3 100 5 6 200 8 9]                      //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-2-2" class="outline-4">
<h4 id="sec-4-2-2">append</h4>
<div class="outline-text-4" id="text-4-2-2">
<ul class="org-ul">
<li>向slice尾部添加数据,返回新的slice对象,简单点说,就是在array[high..cap]之间
写数据
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    data := <span style="color: #b58900;">[</span>...<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2, 3, 4, 5, 6, 7, 8, 9<span style="color: #b58900;">}</span>
    s := data<span style="color: #b58900;">[</span>:3<span style="color: #b58900;">]</span>
    s2 := <span style="color: #657b83; font-weight: bold;">append</span><span style="color: #b58900;">(</span>s, 100, 200<span style="color: #b58900;">)</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>data<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s2<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 2 100 200 5 6 7 8 9]                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 2]                                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 2 100 200]                                //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>我们也很容易想到,如果超过cap的限制,那么肯定不能再使用原来的数组了,而是要申
请新的数组,当然,这个过程是自动的
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    data := <span style="color: #b58900;">[</span>...<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2, 3, 4, 10: 0<span style="color: #b58900;">}</span>
    s := data<span style="color: #b58900;">[</span>:2:3<span style="color: #b58900;">]</span>

    s = <span style="color: #657b83; font-weight: bold;">append</span><span style="color: #b58900;">(</span>s, 100, 200<span style="color: #b58900;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">append two, exceed cap</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s, data<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>&amp;s<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span>, &amp;data<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 100 200] [0 1 2 3 4 0 0 0 0 0 0]          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x8201ea210 0x8201ee180                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-2-3" class="outline-4">
<h4 id="sec-4-2-3">copy</h4>
<div class="outline-text-4" id="text-4-2-3">
<ul class="org-ul">
<li>函数copy在两个slice之间复制数据.其实就是把srcSlice的底层数组保存一份到
destSlice的底层数组上,然后srcSlice就可以释放了
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    data1 := <span style="color: #b58900;">[</span>...<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>0, 1, 2, 3, 4, 5, 6, 7, 8, 9<span style="color: #b58900;">}</span>
    s1 := data1<span style="color: #b58900;">[</span>:<span style="color: #b58900;">]</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s1<span style="color: #b58900;">)</span>
    data2 := <span style="color: #b58900;">[</span>...<span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20<span style="color: #b58900;">}</span>
    s2 := data2<span style="color: #b58900;">[</span>:<span style="color: #b58900;">]</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s2<span style="color: #b58900;">)</span>

    <span style="color: #657b83; font-weight: bold;">copy</span><span style="color: #b58900;">(</span>s1, s2<span style="color: #b58900;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">copy s1 from s2</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s1<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s2<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[0 1 2 3 4 5 6 7 8 9]                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[10 11 12 13 14 15 16 17 18 19 20]             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[10 11 12 13 14 15 16 17 18 19]                //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[10 11 12 13 14 15 16 17 18 19 20]             //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">Map</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>map是引用类型.键是支持(==, !=)的类型(比如number, string, pointer, array,
struct), 值可以是任意类型
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    m := <span style="color: #859900; font-weight: bold;">map</span><span style="color: #b58900;">[</span><span style="color: #b58900;">int</span><span style="color: #b58900;">]</span><span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        name string
        age  int
    <span style="color: #b58900;">}{</span>
        <span style="color: #268bd2; font-weight: bold;">1</span>: <span style="color: #268bd2;">{</span><span style="color: #2aa198;">"user1"</span>, 10<span style="color: #268bd2;">}</span>,
        <span style="color: #268bd2; font-weight: bold;">2</span>: <span style="color: #268bd2;">{</span><span style="color: #2aa198;">"user2"</span>, 20<span style="color: #268bd2;">}</span>,
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m<span style="color: #268bd2;">[</span>1<span style="color: #268bd2;">]</span>.name<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">user1                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>预先给make函数一个合理的元素数量参数,有助于提高性能,因为这会事先分配一大块
内存,而不是后续频繁扩张
<div class="org-src-container">

<pre class="src src-go">m := <span style="color: #657b83; font-weight: bold;">make</span><span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">map</span><span style="color: #b58900;">[</span><span style="color: #b58900;">string</span><span style="color: #b58900;">]</span><span style="color: #b58900;">int</span>, 1000<span style="color: #2aa198;">)</span>
</pre>
</div>
</li>
<li>常见的查询(注意m["a"]是返回两个值的,不过通常不用第二个返回值error),删除等操
作如下
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    m := <span style="color: #859900; font-weight: bold;">map</span><span style="color: #b58900;">[</span><span style="color: #b58900;">string</span><span style="color: #b58900;">]</span><span style="color: #b58900;">int</span><span style="color: #b58900;">{</span>
        <span style="color: #2aa198;">"a"</span>: 1,
    <span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">if</span> v, ok := m<span style="color: #b58900;">[</span><span style="color: #2aa198;">"a"</span><span style="color: #b58900;">]</span>; ok <span style="color: #b58900;">{</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">m["a"] will return two value!</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span>v<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m<span style="color: #268bd2;">[</span><span style="color: #2aa198;">"c"</span><span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>

    m<span style="color: #b58900;">[</span><span style="color: #2aa198;">"b"</span><span style="color: #b58900;">]</span> = 2
    <span style="color: #657b83; font-weight: bold;">delete</span><span style="color: #b58900;">(</span>m, <span style="color: #2aa198;">"c"</span><span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span><span style="color: #657b83; font-weight: bold;">len</span><span style="color: #268bd2;">(</span>m<span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>

    <span style="color: #859900; font-weight: bold;">for</span> k, v := <span style="color: #859900; font-weight: bold;">range</span> m <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span>k, v<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">a 1                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">b 2                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>从map中取回的value是一个临时值,所以对其成员的修改是没有意义的, 所以更改map
内容的方法看起来有些奇怪
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">user</span> <span style="color: #859900; font-weight: bold;">struct</span><span style="color: #b58900;">{</span> name string <span style="color: #b58900;">}</span>

    m := <span style="color: #859900; font-weight: bold;">map</span><span style="color: #b58900;">[</span><span style="color: #b58900;">int</span><span style="color: #b58900;">]</span><span style="color: #b58900;">user</span><span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">1</span>: <span style="color: #268bd2;">{</span><span style="color: #2aa198;">"user1"</span><span style="color: #268bd2;">}</span>,
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m<span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">m[1].name = "Tom"            // cannot assign to m[1].name</span>
    u := m<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span>
    u.name = <span style="color: #2aa198;">"Tom"</span>
    m<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span> = u
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m<span style="color: #b58900;">)</span>

    m2 := <span style="color: #859900; font-weight: bold;">map</span><span style="color: #b58900;">[</span><span style="color: #b58900;">int</span><span style="color: #b58900;">]</span>*<span style="color: #b58900;">user</span><span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">1</span>: &amp;<span style="color: #b58900;">user</span><span style="color: #268bd2;">{</span><span style="color: #2aa198;">"user1"</span><span style="color: #268bd2;">}</span>,
    <span style="color: #b58900;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m2<span style="color: #268bd2;">[</span>1<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>

    m2<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span>.name = <span style="color: #2aa198;">"Jack"</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m2<span style="color: #268bd2;">[</span>1<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">map[1:{user1}]                                 //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">map[1:{Tom}]                                   //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&amp;{user1}                                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&amp;{Jack}                                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">Struct</h3>
<div class="outline-text-3" id="text-4-4">
<ul class="org-ul">
<li>struct也是值类型,赋值和传参数都会复制全部内容.可用'_'定义补位字段
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Node</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    _    int
    id   int
    data *byte
    next *Node
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    n1 := <span style="color: #b58900;">Node</span><span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">id</span>:   1,
        <span style="color: #268bd2; font-weight: bold;">data</span>: <span style="color: #268bd2; font-weight: bold;">nil</span>,
    <span style="color: #b58900;">}</span>

    n2 := <span style="color: #b58900;">Node</span><span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">id</span>:   2,
        <span style="color: #268bd2; font-weight: bold;">data</span>: <span style="color: #268bd2; font-weight: bold;">nil</span>,
        <span style="color: #268bd2; font-weight: bold;">next</span>: &amp;n1,
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>n1<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>n2<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{0 1 &lt;nil&gt; &lt;nil&gt;}                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{0 2 &lt;nil&gt; 0x82024a020}                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>初始化的时候,要包含全部的成员
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    name string
    age  int
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    u1 := <span style="color: #b58900;">User</span><span style="color: #b58900;">{</span><span style="color: #2aa198;">"Tom"</span>, 20<span style="color: #b58900;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>u1<span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">u2 := User{"Tom"} // too few values in struct initializer</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{Tom 20}                                       //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>struct里面还可以有匿名struct
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">File</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    name string
    size int
    attr <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        perm int
        ower int
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    f := <span style="color: #b58900;">File</span><span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">name</span>: <span style="color: #2aa198;">"test.txt"</span>,
        <span style="color: #268bd2; font-weight: bold;">size</span>: 1025,
    <span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">var</span> attr = <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #b58900;">{</span>
        perm int
        ower int
    <span style="color: #b58900;">}{</span>2, 0755<span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>f<span style="color: #b58900;">)</span>
    f.attr = attr
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>f<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{test.txt 1025 {0 0}}                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{test.txt 1025 {2 493}}                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
<div id="outline-container-sec-4-4-1" class="outline-4">
<h4 id="sec-4-4-1">匿名字段</h4>
<div class="outline-text-4" id="text-4-4-1">
<ul class="org-ul">
<li>匿名字段,就是某个struct里面的字段和"另外一个类型名字相同(可以是任意类型)"
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Manager</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    User
    title string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>

    m := <span style="color: #b58900;">Manager</span><span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">User</span>:  <span style="color: #b58900;">User</span><span style="color: #268bd2;">{</span><span style="color: #2aa198;">"Tom"</span><span style="color: #268bd2;">}</span>,
        <span style="color: #268bd2; font-weight: bold;">title</span>: <span style="color: #2aa198;">"Administrator"</span>,
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{{Tom} Administrator}                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>嵌套匿名类,访问起来,就是逐级访问
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Resource</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Classify</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id int
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    Resource
    Classify
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    u := <span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>
        <span style="color: #b58900;">Resource</span><span style="color: #268bd2;">{</span>1, <span style="color: #2aa198;">"people"</span><span style="color: #268bd2;">}</span>,
        <span style="color: #b58900;">Classify</span><span style="color: #268bd2;">{</span>100<span style="color: #268bd2;">}</span>,
        <span style="color: #2aa198;">"Jack"</span>,
    <span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>u.name<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>u.Resource.name<span style="color: #b58900;">)</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">fmt.Println(u.id)            //  ambiguous selector u.id</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>u.Classify.id<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Jack                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">people                                         //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">100                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>不能同时嵌套同一类型和其指针类型,因为他们名字相同
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Resource</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id int
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    *Resource
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Resource // Error: duplicate field Resource</span>
    name string
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-4-2" class="outline-4">
<h4 id="sec-4-4-2">面向对象</h4>
<div class="outline-text-4" id="text-4-4-2">
<ul class="org-ul">
<li>面向对象的三大特征(继承,多肽,封装)里面, GO仅仅支持封装
</li>
<li>尽管匿名字段的内存布局和行为特征,类似继承,但是没有class关键字,也没有多肽,继承
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Manager</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    User
    title string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>

    m := <span style="color: #b58900;">Manager</span><span style="color: #b58900;">{</span><span style="color: #b58900;">User</span><span style="color: #268bd2;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #268bd2;">}</span>, <span style="color: #2aa198;">"Administrator"</span><span style="color: #b58900;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m<span style="color: #b58900;">)</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">cannot use m (type Manager) as type User in assignment,</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">no Polymorphism here</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">var u User = m</span>

<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{{1 Tom} Administrator}                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">第五章 方法</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">方法定义</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>方法总是绑定对象实例,并将这个实例作为第一实际参数(receiver)
</li>
<li>方法有其如下特点:
<ul class="org-ul">
<li>只能为当前包内存在的命名类型定义方法
</li>
<li>参数receiver可任意命名,如方法中没有使用这个receiver,也可以只定义不给名字
</li>
<li>参数receiver可以是类型T或是T* (其中T不能是接口或者指针)
</li>
<li>不支持方法重载
</li>
<li>可用实例value或者pointer调用全部方法,编译器自动转换
</li>
</ul>
</li>
<li>go没有ctor和dtor,一般使用"简单工厂模式"返回对象实例
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Queue</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    elements <span style="color: #b58900;">[]</span><span style="color: #859900; font-weight: bold;">interface</span><span style="color: #b58900;">{}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">NewQueue</span><span style="color: #2aa198;">()</span> *<span style="color: #b58900;">Queue</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> &amp;<span style="color: #b58900;">Queue</span><span style="color: #b58900;">{</span><span style="color: #657b83; font-weight: bold;">make</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">[]</span><span style="color: #859900; font-weight: bold;">interface</span><span style="color: #6c71c4;">{}</span>, 10<span style="color: #268bd2;">)</span><span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>*<span style="color: #b58900;">Queue</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">Push</span><span style="color: #2aa198;">(</span>e <span style="color: #859900; font-weight: bold;">interface</span><span style="color: #b58900;">{}</span><span style="color: #2aa198;">)</span> <span style="color: #b58900;">error</span> <span style="color: #2aa198;">{</span>
    <span style="color: #657b83; font-weight: bold;">panic</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"not implemented"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">Queue</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">length</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">int</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #657b83; font-weight: bold;">len</span><span style="color: #b58900;">(</span>self.elements<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    q := <span style="color: #268bd2;">NewQueue</span><span style="color: #b58900;">()</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%d\n"</span>, q.<span style="color: #268bd2;">length</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">10                                             //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>方法其实就是"第一个参数为receiver的函数", 而且receiver为T的时候是copy by value
而receiver为T*的时候,是copy by reference
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Data</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    x int
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self <span style="color: #b58900;">Data</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">ValueTest</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Pass by Value, &amp;self is changing</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Value: %p\n"</span>, &amp;self<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">Data</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">PointerTest</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Pass by reference, self is always the same</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Pointer: %p\n"</span>, self<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    d := <span style="color: #b58900;">Data</span><span style="color: #b58900;">{}</span>
    p := &amp;d
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Data: %p\n"</span>, p<span style="color: #b58900;">)</span>

    d.<span style="color: #268bd2;">ValueTest</span><span style="color: #b58900;">()</span>
    d.<span style="color: #268bd2;">PointerTest</span><span style="color: #b58900;">()</span>

    p.<span style="color: #268bd2;">ValueTest</span><span style="color: #b58900;">()</span>
    p.<span style="color: #268bd2;">PointerTest</span><span style="color: #b58900;">()</span>

<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Data: 0x82024c220                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Value: 0x82024c240                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Pointer: 0x82024c220                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Value: 0x82024c250                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Pointer: 0x82024c220                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">匿名字段</h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li>一个struct内部有匿名字段的话,这个struct可以直接访问这个匿名字段的函数,就像
访问自己的函数一样.(用组合的方式实现了继承)
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Manager</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    User
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">ToString</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">Sprintf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"User: %p, %v"</span>, self, self<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    m := <span style="color: #b58900;">Manager</span><span style="color: #b58900;">{</span><span style="color: #b58900;">User</span><span style="color: #268bd2;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #268bd2;">}</span><span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Manager: %p\n"</span>, &amp;m<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m.<span style="color: #268bd2;">ToString</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Manager: 0x820258000                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">User: 0x820258000, &amp;{1 Tom}                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>继承的好处当然就是可以override 函数,我们通过为两个不同的struct(两者有相互包
含的关系)定义名字相同的方法来实现了override
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Manager</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    User
    title string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">ToString</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">Sprintf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"User: %p, %v"</span>, self, self<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">Manager</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">ToString</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">Sprintf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Manager: %p, %v"</span>, self, self<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    m := <span style="color: #b58900;">Manager</span><span style="color: #b58900;">{</span><span style="color: #b58900;">User</span><span style="color: #268bd2;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #268bd2;">}</span>, <span style="color: #2aa198;">"Administrator"</span><span style="color: #b58900;">}</span>

    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m.<span style="color: #268bd2;">ToString</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>m.User.<span style="color: #268bd2;">ToString</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Manager: 0x8201ec0c0, &amp;{{1 Tom} Administrator} //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">User: 0x8201ec0c0, &amp;{1 Tom}                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">方法集</h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li>每个类型和其方法之间的关系:
<ul class="org-ul">
<li>类型T方法集包含全部receiver T方法
</li>
<li>类型*T方法集包含全部receiver T + *T方法
</li>
<li>如果类型S包含匿名字段T,则S方法包含T 方法
</li>
<li>如果类型S包含匿名字段*T,则S方法包含T + *T方法
</li>
<li>不管嵌入T或者*T, *S方法总能包含T + *T方法
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">表达式</h3>
<div class="outline-text-3" id="text-5-4">
<ul class="org-ul">
<li>方法有如下两种"等价"的表达方式
<ul class="org-ul">
<li>instance.method(args&#x2026;)
</li>
<li>&lt;type&gt;.func(instance, args)
</li>
</ul>
</li>
<li>其实也很好理解,因为方法定义的时候,就和func一样(只不过前面多个type,可以是T也
可以是*T), 而调用的时候,则可以一来instance.method, 二来&lt;T&gt;.func(instance)
</li>
<li>method的调用例子如下:
<ul class="org-ul">
<li>使用*T的情况:
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
id   int
name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">Test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%p, %v\n"</span>, self, self<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
u := <span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #b58900;">}</span>
u.<span style="color: #268bd2;">Test</span><span style="color: #b58900;">()</span>

mValue := u.Test
<span style="color: #268bd2;">mValue</span><span style="color: #b58900;">()</span>

<span style="color: #93a1a1;">//</span><span style="color: #93a1a1;">use *T</span>
mExpression := <span style="color: #b58900;">(</span>*User<span style="color: #b58900;">)</span>.Test
<span style="color: #93a1a1;">//</span><span style="color: #93a1a1;">&amp;u is the intance of (*T)</span>
<span style="color: #268bd2;">mExpression</span><span style="color: #b58900;">(</span>&amp;u<span style="color: #b58900;">)</span>

<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x8201e41a0, &amp;{1 Tom}                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x8201e41a0, &amp;{1 Tom}                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x8201e41a0, &amp;{1 Tom}                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>使用T的情况, 我们可以看到这种情况下是pass-by-value
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self <span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">Test</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%p, %v\n"</span>, &amp;self, self<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    u := <span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>2, <span style="color: #2aa198;">"Jacky"</span><span style="color: #b58900;">}</span>
    u.<span style="color: #268bd2;">Test</span><span style="color: #b58900;">()</span>

    mValue := u.Test
    <span style="color: #268bd2;">mValue</span><span style="color: #b58900;">()</span>

    mExpression := <span style="color: #b58900;">(</span>User<span style="color: #b58900;">)</span>.Test
    <span style="color: #268bd2;">mExpression</span><span style="color: #b58900;">(</span>u<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x8201e41a0, {2 Jacky}                         //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x8201e4200, {2 Jacky}                         //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0x8201e4240, {2 Jacky}                         //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">第六章 接口</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">接口定义</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>接口是一个或者多个方法签名的集合
</li>
<li>任何类型的方法只要拥有与接口A"相同的"全部方法,就表示它"实现"了这个接口.注意,
实现某接口并不需要在该类型上显示添加接口声明
</li>
<li>判断两个方法是否相同.主要是看:
<ul class="org-ul">
<li>名称相同
</li>
<li>参数列表相同
</li>
<li>返回值相同
</li>
</ul>
</li>
<li>go里面的接口也有如下的特点:
<ul class="org-ul">
<li>接口命名是以er结尾
</li>
<li>接口只有方法签名,没有实现
</li>
<li>接口没有数据字段
</li>
<li>接口中可以嵌入其他接口
</li>
<li>类型可以"实现"多个接口
</li>
</ul>
</li>
<li>下面是一个接口的例子
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Stringer</span> <span style="color: #859900; font-weight: bold;">interface</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">String</span><span style="color: #b58900;">()</span> string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Printer</span> <span style="color: #859900; font-weight: bold;">interface</span> <span style="color: #2aa198;">{</span>
    Stringer
    <span style="color: #268bd2;">Print</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">String</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">Sprintf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"user %d, %s"</span>, self.id, self.name<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">Print</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>self.<span style="color: #268bd2;">String</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">var</span> t Printer = &amp;<span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #b58900;">}</span>
    t.<span style="color: #268bd2;">Print</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">user 1, Tom                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>空接口interface{}没有任何方法的签名,这也就意味着任何的类型都是实现了空接口.
其作用类似面向对象语言中的根对象object (也类似c语言里面的void*)
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">Print</span><span style="color: #2aa198;">(</span>v <span style="color: #859900; font-weight: bold;">interface</span><span style="color: #b58900;">{}</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%T: %v\n"</span>, v, v<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">Print</span><span style="color: #b58900;">(</span>1<span style="color: #b58900;">)</span>
    <span style="color: #268bd2;">Print</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Hello World!"</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">int: 1                                         //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">string: Hello World!                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>匿名接口可以作为变量类型, 变量类型也可以是strcut的一部分, 下面例子中匿名
interface类型类型的变量s是Tester的唯一成员. 而User实现了这个interface的唯一
函数String(),那么就我们说s和User的类型是一样的
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Tester</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    s <span style="color: #859900; font-weight: bold;">interface</span> <span style="color: #b58900;">{</span>
        <span style="color: #268bd2;">String</span><span style="color: #268bd2;">()</span> string
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">String</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">Sprintf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"user %d, %s"</span>, self.id, self.name<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    t := <span style="color: #b58900;">Tester</span><span style="color: #b58900;">{</span>&amp;<span style="color: #b58900;">User</span><span style="color: #268bd2;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #268bd2;">}</span><span style="color: #b58900;">}</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>t.s.<span style="color: #268bd2;">String</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">user 1, Tom                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2">执行机制</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>接口对象由两个指针组成:
<ul class="org-ul">
<li>接口返回临时对象, 数据指针持有的是目标对象的只读复制品,比如下例中的i其为
interface u直接返回的临时对象.更改原interface不会影响i
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    u := <span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">var</span> i <span style="color: #859900; font-weight: bold;">interface</span><span style="color: #b58900;">{}</span> = u

    u.id = 2
    u.name = <span style="color: #2aa198;">"Jack"</span>

    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%v\n"</span>, u<span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%v\n"</span>, i.<span style="color: #268bd2;">(</span><span style="color: #b58900;">User</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{2 Jack}                                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{1 Tom}                                        //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>只有使用指针才能修改其状态
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    u := <span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">var</span> vi, pi <span style="color: #859900; font-weight: bold;">interface</span><span style="color: #b58900;">{}</span> = u, &amp;u

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">vi.(User).name = "Jack" // Error: cannot assign to vi.(User).name</span>
    pi.<span style="color: #b58900;">(</span>*<span style="color: #b58900;">User</span><span style="color: #b58900;">)</span>.name = <span style="color: #2aa198;">"Jack"</span>

    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%v\n"</span>, vi.<span style="color: #268bd2;">(</span><span style="color: #b58900;">User</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
    fmt.<span style="color: #268bd2;">Printf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%v\n"</span>, pi.<span style="color: #268bd2;">(</span>*<span style="color: #b58900;">User</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{1 Tom}                                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&amp;{1 Jack}                                      //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3">接口转换</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>利用类型推断,可以判断某个对象是否"实现"了某个接口
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">String</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">Sprintf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%d, %s"</span>, self.id, self.name<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">var</span> o <span style="color: #859900; font-weight: bold;">interface</span><span style="color: #b58900;">{}</span> = &amp;<span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #b58900;">}</span>

    <span style="color: #93a1a1;">//////////////////////////////////</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Source Code for golang       //</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">type Stringer interface {    //</span>
    <span style="color: #93a1a1;">//  </span><span style="color: #93a1a1;">String() string             //</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">}                            //</span>
    <span style="color: #93a1a1;">//////////////////////////////////</span>

    <span style="color: #859900; font-weight: bold;">if</span> i, ok := o.<span style="color: #b58900;">(</span><span style="color: #b58900;">fmt.Stringer</span><span style="color: #b58900;">)</span>; ok <span style="color: #b58900;">{</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span>i<span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>

    u := o.<span style="color: #b58900;">(</span>*<span style="color: #b58900;">User</span><span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">u := o.(User)  // panic: interface conversion: interface is *main.User, not main.User</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>u<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1, Tom                                         //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1, Tom                                         //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>还可以使用switch做批量类型判断
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">var</span> o <span style="color: #859900; font-weight: bold;">interface</span><span style="color: #b58900;">{}</span> = &amp;<span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">switch</span> v := o.<span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">type</span><span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
    <span style="color: #859900; font-weight: bold;">case</span> <span style="color: #268bd2; font-weight: bold;">nil</span>:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"nil"</span><span style="color: #268bd2;">)</span>
    <span style="color: #859900; font-weight: bold;">case</span> fmt.Stringer: <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">interface</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span>v<span style="color: #268bd2;">)</span>
    <span style="color: #859900; font-weight: bold;">case</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">()</span> <span style="color: #b58900;">string</span>: <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">func</span>
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span><span style="color: #268bd2;">v</span><span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span>
    <span style="color: #859900; font-weight: bold;">case</span> *User: <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">struct</span>
        fmt.<span style="color: #268bd2;">Printf</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"%d, %s\n"</span>, v.id, v.name<span style="color: #268bd2;">)</span>
    <span style="color: #859900; font-weight: bold;">default</span>:
        fmt.<span style="color: #268bd2;">Println</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">"unknown"</span><span style="color: #268bd2;">)</span>
    <span style="color: #b58900;">}</span>

<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1, Tom                                         //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>超集接口(父类)可以转换为子集接口(子类),这也是模仿OO的特性
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Stringer</span> <span style="color: #859900; font-weight: bold;">interface</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">String</span><span style="color: #b58900;">()</span> string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Printer</span> <span style="color: #859900; font-weight: bold;">interface</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">String</span><span style="color: #b58900;">()</span> string
    <span style="color: #268bd2;">Print</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">User</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id   int
    name string
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">String</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> fmt.<span style="color: #268bd2;">Sprintf</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"%d, %v"</span>, self.id, self.name<span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self *<span style="color: #b58900;">User</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">Print</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>self.<span style="color: #268bd2;">String</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">var</span> o Printer = &amp;<span style="color: #b58900;">User</span><span style="color: #b58900;">{</span>1, <span style="color: #2aa198;">"Tom"</span><span style="color: #b58900;">}</span>
    <span style="color: #859900; font-weight: bold;">var</span> s Stringer = o
    fmt.<span style="color: #268bd2;">Println</span><span style="color: #b58900;">(</span>s.<span style="color: #268bd2;">String</span><span style="color: #268bd2;">()</span><span style="color: #b58900;">)</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1, Tom                                         //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4">接口检查</h3>
<div class="outline-text-3" id="text-6-4">
<ul class="org-ul">
<li>可以使用如下的办法(转换nil 为Data类型的nil)来检查Data类型到底实现了Stringer没有
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Data</span> <span style="color: #859900; font-weight: bold;">struct</span> <span style="color: #2aa198;">{</span>
    id int
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self <span style="color: #b58900;">Data</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">String</span><span style="color: #2aa198;">()</span> <span style="color: #b58900;">string</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #2aa198;">""</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">fmt.Stringer is interface type, _ is variable, but we don't</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">care about it.</span>
    <span style="color: #859900; font-weight: bold;">var</span> _ fmt.Stringer = <span style="color: #b58900;">(</span>*Data<span style="color: #b58900;">)(</span><span style="color: #268bd2; font-weight: bold;">nil</span><span style="color: #b58900;">)</span>

    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">IF String() is not implemented =&gt;</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">*Data does not implement fmt.Stringer (missing String method)</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>还可以让函数"typedef"成type,然后来"实现"接口.很绕口的使用方法
<div class="org-src-container">

<pre class="src src-go"><span style="color: #859900; font-weight: bold;">package</span> main

<span style="color: #859900; font-weight: bold;">import</span> <span style="color: #2aa198;">"fmt"</span>

<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">Tester</span> <span style="color: #859900; font-weight: bold;">interface</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">Do</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Regard function AS type</span>
<span style="color: #859900; font-weight: bold;">type</span> <span style="color: #b58900;">FuncDo</span> <span style="color: #859900; font-weight: bold;">func</span><span style="color: #2aa198;">()</span>

<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">the function implement the interface!</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">then call itself!</span>
<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #2aa198;">(</span>self <span style="color: #b58900;">FuncDo</span><span style="color: #2aa198;">)</span> <span style="color: #268bd2;">Do</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span> <span style="color: #268bd2;">self</span><span style="color: #b58900;">()</span> <span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">func</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">t is Tester type</span>
    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">FuncDo implement the Do(), it is also the Tester type</span>
    <span style="color: #859900; font-weight: bold;">var</span> t Tester = <span style="color: #268bd2;">FuncDo</span><span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">func</span><span style="color: #268bd2;">()</span> <span style="color: #268bd2;">{</span> fmt.<span style="color: #268bd2;">Println</span><span style="color: #6c71c4;">(</span><span style="color: #2aa198;">"Hello World"</span><span style="color: #6c71c4;">)</span> <span style="color: #268bd2;">}</span><span style="color: #b58900;">)</span>
    t.<span style="color: #268bd2;">Do</span><span style="color: #b58900;">()</span>
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hello World                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

         <!-- Disqus Comment BEGIN -->
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              var disqus_shortname = 'harrifeng';

              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

         <!-- Disqus Comment END -->
</div>
</body>
</html>
