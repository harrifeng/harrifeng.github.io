<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>part3</title>
<!-- 2017-05-02 Tue 10:46 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="your name" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>

         <link href="http://fonts.googleapis.com/css?family=Droid+Sans+Mono|Galdeano|Open+Sans:600italic,400,600|Roboto+Condensed:400,700" rel="stylesheet" type="text/css">
         <link rel="stylesheet" type="text/css" href="/static/css/main.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="http://harrifeng.github.io/sitemap.html"> UP </a>
 |
 <a accesskey="H" href="http://harrifeng.github.io/index.html"> HOME </a>
</div><div id="preamble" class="status">

         <div id="header">
            <div id="header-top">
                <div id="blog-title">Harrifeng's Path</div>
                <div id="blog-sub-title">纸上得来终觉浅,绝知此事要Coding</div>
            </div>
            <div id="nav">
                <ul>
                    <li><a href="/">首页</a></li>
                    <li><a href="/about.html">About Me</a></li>
                    <li>
                    </li>
                </ul>
            </div>
         </div>
</div>
<div id="content">
<h1 class="title">part3</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Chapter 7: Object orientation with prototypes</a>
<ul>
<li><a href="#sec-1-1">Understanding prototypes</a></li>
<li><a href="#sec-1-2">Object construction and prototypes</a>
<ul>
<li><a href="#sec-1-2-1">Instance properties</a></li>
<li><a href="#sec-1-2-2">Side effects of the synamic nature of JavaScript</a></li>
<li><a href="#sec-1-2-3">Object typing via constructors</a></li>
</ul>
</li>
<li><a href="#sec-1-3">Achieving inheritance</a></li>
<li><a href="#sec-1-4">Using JavaScript "classes" in ES6</a></li>
</ul>
</li>
<li><a href="#sec-2">Chapter 8: Controlling acces to objects</a>
<ul>
<li><a href="#sec-2-1">Controlling access to properties with getters and setters</a>
<ul>
<li><a href="#sec-2-1-1">Defining getters and setters</a></li>
<li><a href="#sec-2-1-2">Using getters and setters to validate property values</a></li>
</ul>
</li>
<li><a href="#sec-2-2">Using proxies to control access</a>
<ul>
<li><a href="#sec-2-2-1">Using proxie for logging</a></li>
<li><a href="#sec-2-2-2">Using proxies for measuring performance</a></li>
<li><a href="#sec-2-2-3">Using proxies to autopopulate properties</a></li>
<li><a href="#sec-2-2-4">Using proxies to implement negative array Indexes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">Chapter 9: Dealing with collections</a>
<ul>
<li><a href="#sec-3-1">Arrays</a>
<ul>
<li><a href="#sec-3-1-1">Creating arrays</a></li>
<li><a href="#sec-3-1-2">Adding and removing Items at either end of an array</a></li>
<li><a href="#sec-3-1-3">Adding and removing items at any array location</a></li>
<li><a href="#sec-3-1-4">Common operations on arrays</a>
<ul>
<li><a href="#sec-3-1-4-1">ITERATING OVER ARRAYS</a></li>
<li><a href="#sec-3-1-4-2">MAPPING ARRAYS</a></li>
<li><a href="#sec-3-1-4-3">AGGREGATING ARRAY ITEMS</a></li>
<li><a href="#sec-3-1-4-4">TESTING ARRAY ITEMS</a></li>
<li><a href="#sec-3-1-4-5">SEARCHING ARRAYS</a></li>
<li><a href="#sec-3-1-4-6">SORTING ARRAYS</a></li>
</ul>
</li>
<li><a href="#sec-3-1-5">Resuing built-in array functions</a></li>
</ul>
</li>
<li><a href="#sec-3-2">Maps</a>
<ul>
<li><a href="#sec-3-2-1">Creating our first map</a></li>
<li><a href="#sec-3-2-2">Iterating over maps</a></li>
</ul>
</li>
<li><a href="#sec-3-3">Sets</a></li>
</ul>
</li>
<li><a href="#sec-4">Chapter 10: Wrangling regular expresions</a>
<ul>
<li><a href="#sec-4-1">Why regular expressions rock</a></li>
</ul>
</li>
<li><a href="#sec-5">Chapter 11: Code modularization techniques</a>
<ul>
<li><a href="#sec-5-1">Modularizing code in pre-ES6 JavaScript</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Chapter 7: Object orientation with prototypes</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>你已经了解到了function是js里面的first-class,做到first-class还依靠了closure的
灵活性
</li>
<li>现在,你要了解js另外一个重要的特性了,就是object prototype
</li>
<li>首先,prototype是一个object,别的普通object可以把寻找某个specific property的任
务代理给prototype.
</li>
<li>我们其实可以把property看做是其他oo语言里面的class的作用
<pre class="example">
Prototypes serve a similar purpose to that of classes in classical
object-oriented languages
</pre>
</li>
</ul>
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Understanding prototypes</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>在js里面,object就是一系列property和value的组合体,value可以是:
<ul class="org-ul">
<li>simple value
</li>
<li>function
</li>
<li>another object
</li>
</ul>
</li>
<li>例子如下
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">obj</span> = <span style="color: #2aa198;">{</span>
    prop1: 1,
    <span style="color: #268bd2;">prop2</span>: <span style="color: #859900; font-weight: bold;">function</span><span style="color: #b58900;">(){}</span>,
    prop3: <span style="color: #b58900;">{}</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>我们还可以几乎不受控制的对object进行"增删改查"
<div class="org-src-container">

<pre class="src src-js">obj.prop1 = 1;
obj.prop1 = <span style="color: #2aa198;">[]</span>;
<span style="color: #859900; font-weight: bold;">delete</span> obj.prop2;
obj.prop4 = <span style="color: #2aa198;">"Hello"</span>;
</pre>
</div>
</li>
<li>得到结果如下
<div class="org-src-container">

<pre class="src src-js"><span style="color: #2aa198;">{</span>
    prop1: <span style="color: #b58900;">[]</span>,
    prop3: <span style="color: #b58900;">{}</span>,
    prop4: <span style="color: #2aa198;">"Hello"</span>
<span style="color: #2aa198;">}</span>;
</pre>
</div>
</li>
<li>继承,是oo编程的重要概念,能够极大的减少代码的重复.js正是通过prototype来实现
了继承.我们前面说过,prototype说白了也是一个object,那我们如何使用object来完
成inheritance呢?
</li>
<li>原理在于js重新定义了property search技术, 对于一个property的寻找:
<ul class="org-ul">
<li>首先在自己的object体内寻找,如果找到就用
</li>
<li>如果不在自己体内,就去'自己体内一个特殊的object'里面去寻找,这个'特殊的object'
就是prototype
</li>
</ul>
</li>
<li>通过下面的例子,那就可以发现,prototyp'只不过是一个普通object',只是被其他object
设置为'plan B'的property寻找地
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">yoshi</span> = <span style="color: #2aa198;">{</span>
    skulk: <span style="color: #268bd2; font-weight: bold;">true</span>
<span style="color: #2aa198;">}</span>;
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">hattori</span> = <span style="color: #2aa198;">{</span>
    sneak: <span style="color: #268bd2; font-weight: bold;">true</span>
<span style="color: #2aa198;">}</span>;
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">kuma</span> = <span style="color: #2aa198;">{</span>
    creep: <span style="color: #268bd2; font-weight: bold;">true</span>
<span style="color: #2aa198;">}</span>;

console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"skulk"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"sneak"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"creep"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'------------------------'</span><span style="color: #2aa198;">)</span>;

Object.setPrototypeOf<span style="color: #2aa198;">(</span>yoshi, hattori<span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"skulk"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"sneak"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"creep"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'------------------------'</span><span style="color: #2aa198;">)</span>;

Object.setPrototypeOf<span style="color: #2aa198;">(</span>yoshi, kuma<span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"skulk"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"sneak"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"creep"</span> <span style="color: #859900; font-weight: bold;">in</span> yoshi<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">------------------------                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">------------------------                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>js里面, 某个object的prototype 也是一个property,而且这个property是普通人看不
到的,不能直接访问的,被记做\[\[prototype\]\]
</li>
<li>通过Object.setPrototypeOf的帮助,我们可以在自己'体内'找不到property的情况下,
去\[\[prototype\]\]指定的object里面去寻找,如下图
<pre class="example">
+---------------+           +---------------+
|     yoshi     |           |    hattori    |
|               |           |               |
|skulk: true    +----------&gt;|sneak: true    |
|[[prototype]]  |           |               |
+---------------+           +---------------+
</pre>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Object construction and prototypes</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>js里面创建一个object是很简单的,对其操作也是可以直接的
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">warrior</span> = <span style="color: #2aa198;">{}</span>;

warrior.name = <span style="color: #2aa198;">'Saito'</span>;
warrior.occupation = <span style="color: #2aa198;">'marksman'</span>;
</pre>
</div>
</li>
<li>oo背景的人,会非常想念class的概念,在创建'某一类'特别相似的object的时候,使用
class会极大的减少复杂度.js也提供了继承的概念,但是不是使用class,而是使用ctor
然后用new来调用ctor,就模拟了oo语言里面new一个class
</li>
<li>使用new + ctor创建一个object,然后ctor里面'建设'这个object,是我们前面学到的,
但是我们前面没学到的是:
<pre class="example">
ctor的名字叫prototype的property,会被自动设置为新创建object的[[prototype]].
</pre>
</li>
<li>前面说过,每个object都有\[\[prototype\]\],但是它不能去直接操作,但是如果这个
object来自某个ctor,这个ctor是可以替它操作\[\[prototype\]\]的.
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">(){}</span>

Ninja.<span style="color: #268bd2; font-weight: bold;">prototype</span>.swingSword = <span style="color: #859900; font-weight: bold;">function</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">true</span>;
<span style="color: #2aa198;">}</span>;

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja1</span> = Ninja<span style="color: #2aa198;">()</span>;         <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">none new</span>
console.log<span style="color: #2aa198;">(</span>ninja1<span style="color: #2aa198;">)</span>;

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja2</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"swingSword"</span> <span style="color: #859900; font-weight: bold;">in</span> ninja2<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">undefined                                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>上面的例子中,我们直接使用了Ninja.prototype, 这是因为prototype(不加[])是每个
function都有的property(因为每个function都是个"潜力股",都可以被new调用), 这个
property作为一个object,其实也是有自带的一个property的,就是constructor,指向
包含它的函数也就是Ninja.换句话说,Ninja和prototype是"双向链接"的
<pre class="example">
                   +--------------------+
                   | function Ninja(){} |
                   | prototype:---+     |&lt;-----------+
                   +--------------+-----+            |
                                  |                  |
                                  |                  |
                                  v                  |
+---------------+           +-------------------+    |
|     ninja2    |           |  Ninja prototype  |    |
|     ------    |           |  ---------------  |    |
|               |           |  constructor------+----+      +-------------+
| [[prototype]]-+----------&gt;|  swingSword ------+----------&gt;|function(){} |
+---------------+           +-------------------+           +-------------+
</pre>
</li>
<li>注意,只有object的prototype property是加[]的,内置的.函数的prototype就是普通
的property
</li>
</ul>
</div>
<div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1">Instance properties</h4>
<div class="outline-text-4" id="text-1-2-1">
<ul class="org-ul">
<li>我们知道,一个object寻找method的过程被分成了两部分:
<ul class="org-ul">
<li>从ctor的method里面寻找
</li>
<li>从自己的<i>prototype</i>里面去寻找
</li>
</ul>
</li>
<li>如果两个部分里面都有名字相同的函数(我们知道js是没有overload的)的话,我们选
哪个呢?看例子
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2; font-weight: bold;">this</span>.swingSword = <span style="color: #859900; font-weight: bold;">function</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        console.log<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"in the ctor"</span><span style="color: #268bd2;">)</span>;
    <span style="color: #b58900;">}</span>;
<span style="color: #2aa198;">}</span>

Ninja.<span style="color: #268bd2; font-weight: bold;">prototype</span>.swingSword = <span style="color: #859900; font-weight: bold;">function</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    console.log<span style="color: #b58900;">(</span><span style="color: #2aa198;">"in the ctor's prototype"</span><span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>;

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;
ninja.swingSword<span style="color: #2aa198;">()</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">in the ctor                                    //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>结果证明,ctor里面的函数有更高的优先权.那是不是method要更主要的放在ctor里面
呢?
</li>
<li>结果恰恰相反:
<ul class="org-ul">
<li>如果是为了使用定义在ctor里面的method和variable来实现getter和setter private
variable的话,我们只能把method定义在ctor里面
</li>
<li>其他所有的其他情况下,我们都要尽量把method定义在cotr的prototype里面.原因
如下,如果我们有多个ninja instance的情况下,ctor的property都会维护一份自己
的拷贝, 对于value来说比较正常,对于method来说,就显得重复,因为函数是一种不
带有"副作用"的操作,定义一份就可以了
<pre class="example">
                    +---------------+           +-------------------+
                    |    ninja1     |           |function Ninja(){} |
+------------+      |    ------     |           |prototype:---+     |&lt;-----+
|function(){}|&lt;-----+-swingWord     |           +-------------+-----+      |
+------------+      | [[prototype]]-+-----+                   |            |
                    +---------------+     |                   |            |
                                          |     +-------------------+      |
                                          |     | Ninja prototype   |      |
                    +---------------+     |---&gt; | ---------------   |      |
                    |    ninja1     |     |     | constructor ------+------|
+------------+      |    ------     |     |     | swingSword  ------+-+
|function(){}|&lt;-----+--wingWord     |     |     +-------------------+ |
+------------+      | [[prototype]]-+-----+                           |
                    +---------------+     |                           |
                                          |                           |
                                          |                           |
                    +---------------+     |                           |
                    |    ninja1     |     |                           |
+------------+      |    ------     |     |                           |   +------------+
|function(){}|&lt;-----+--wingWord     |     |                           +-&gt; |function(){}|
+------------+      | [[prototype]]-+-----+                               +------------+
                    +---------------+
</pre>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2-2" class="outline-4">
<h4 id="sec-1-2-2">Side effects of the synamic nature of JavaScript</h4>
<div class="outline-text-4" id="text-1-2-2">
<ul class="org-ul">
<li>作为动态语言,一个object的property可以随意的被"增删改查",prototype也是一个
property,所以也免不了相同的命运.
</li>
<li>而这种动态的特性会引入很多的问题,如果不熟悉的话,会感到很困惑,比如下面的例子
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2; font-weight: bold;">this</span>.swung = <span style="color: #268bd2; font-weight: bold;">true</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja1</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;

Ninja.<span style="color: #268bd2; font-weight: bold;">prototype</span>.swingSword = <span style="color: #859900; font-weight: bold;">function</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">this</span>.swung;
<span style="color: #2aa198;">}</span>;

<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">the method is added after the object creation</span>
console.log<span style="color: #2aa198;">(</span>ninja1.swingSword<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span>;

<span style="color: #b58900;">Ninja</span>.<span style="color: #268bd2; font-weight: bold;">prototype</span> = <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2;">pierce</span>:<span style="color: #859900; font-weight: bold;">function</span><span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">true</span>;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>;

<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">still see the method, as we keep the ref to old prototype</span>
console.log<span style="color: #2aa198;">(</span>ninja1.swingSword<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">newly created ninjas refer to new prototyp, forget about swing</span>
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja2</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"pierce"</span> <span style="color: #859900; font-weight: bold;">in</span> ninja2<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"swingSword"</span> <span style="color: #859900; font-weight: bold;">in</span> ninja2<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2-3" class="outline-4">
<h4 id="sec-1-2-3">Object typing via constructors</h4>
<div class="outline-text-4" id="text-1-2-3">
<ul class="org-ul">
<li>我们前面就说到过,我们可以通过一个叫做constructor的property(存储在object的
<i>prototype</i>里面)来找到我们的object是从哪个ctor创建来的
</li>
<li>这个constructor property能够让我们使用instanceof来判断自己的类型
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{}</span>
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;

console.log<span style="color: #2aa198;">(</span>ninja.constructor<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja.constructor === Ninja<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja <span style="color: #859900; font-weight: bold;">instanceof</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[Function: Ninja]                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Achieving inheritance</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>在es6之前,想要做到"继承"非常的麻烦,因为js模拟oo语言的机制涉及到两个变量:
<ul class="org-ul">
<li>propertype
</li>
<li>constructor
</li>
</ul>
</li>
<li>所以我们要"手动"设置这两个变量,代码看起来就非常的麻烦
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Person</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{}</span>
Person.<span style="color: #268bd2; font-weight: bold;">prototype</span>.dance = <span style="color: #859900; font-weight: bold;">function</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{}</span>;

<span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{}</span>
Ninja.<span style="color: #268bd2; font-weight: bold;">prototype</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Person</span><span style="color: #2aa198;">()</span>;

Object.defineProperty<span style="color: #2aa198;">(</span>Ninja.<span style="color: #268bd2; font-weight: bold;">prototype</span>, <span style="color: #2aa198;">"constructor"</span>, <span style="color: #b58900;">{</span>
    enumerable: <span style="color: #268bd2; font-weight: bold;">false</span>,
    value: Ninja,
    writable: <span style="color: #268bd2; font-weight: bold;">true</span>
<span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>;

<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;

console.log<span style="color: #2aa198;">(</span>ninja.constructor === Ninja<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"dance"</span> <span style="color: #859900; font-weight: bold;">in</span> Ninja.<span style="color: #268bd2; font-weight: bold;">prototype</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">Using JavaScript "classes" in ES6</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>如此麻烦的代码,让人无法忍受,所以es6引入了class这个概念,因为javascript为了赶
时髦,故意模仿java,所以把所有java的关键字都作为了自己的关键字.这样一来,引入
新的关键字毫无压力
</li>
<li>但是class并没有新的架构,只不过是语法糖罢了:
<ul class="org-ul">
<li>一个简单的class例子:
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">class</span> Ninja<span style="color: #2aa198;">{</span>
    constructor<span style="color: #b58900;">(</span>name<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">this</span>.name = name;
    <span style="color: #b58900;">}</span>
    swingSword<span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">true</span>;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>其实就相当于如下:
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">(</span><span style="color: #268bd2;">name</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2; font-weight: bold;">this</span>.name = name;
<span style="color: #2aa198;">}</span>

Ninja.<span style="color: #268bd2; font-weight: bold;">prototype</span>.swingSword = <span style="color: #859900; font-weight: bold;">function</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">true</span>;
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
</ul>
</li>
<li>其实总结起来很简单:
<ul class="org-ul">
<li>原来在ctor里面写的,现在写在constructor里面
</li>
<li>原来在prototype里面写的,现在写在{}里面
</li>
</ul>
</li>
<li>现在还可以写static函数:
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">class</span> Ninja <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">static</span> compare<span style="color: #b58900;">(</span>ninja1, ninja2<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
        <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">...</span>
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>其实就是原来ctor的函数的"函数property"
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{}</span>
Ninja.compare = <span style="color: #859900; font-weight: bold;">function</span><span style="color: #2aa198;">(</span><span style="color: #268bd2;">ninja1</span>, <span style="color: #268bd2;">ninja2</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>...<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>class的引入更重要的是让"继承"更加简单了
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">class</span> Person <span style="color: #2aa198;">{</span>
    constructor<span style="color: #b58900;">(</span>name<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">this</span>.name = name;
    <span style="color: #b58900;">}</span>

    dance<span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">true</span>;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">class</span> Ninja <span style="color: #859900; font-weight: bold;">extends</span> Person <span style="color: #2aa198;">{</span>
    constructor<span style="color: #b58900;">(</span>name, weapon<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">super</span><span style="color: #268bd2;">(</span>name<span style="color: #268bd2;">)</span>;
        <span style="color: #268bd2; font-weight: bold;">this</span>.weapon = weapon;
    <span style="color: #b58900;">}</span>

    wieldWeapon<span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">true</span>;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">person</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Person</span><span style="color: #2aa198;">(</span><span style="color: #2aa198;">"Bob"</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>person <span style="color: #859900; font-weight: bold;">instanceof</span> <span style="color: #b58900;">Person</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>person.dance<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>person.name<span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"---------------------------"</span><span style="color: #2aa198;">)</span>;

<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">(</span><span style="color: #2aa198;">"Yoshi"</span>, <span style="color: #2aa198;">"Wakizashi"</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja <span style="color: #859900; font-weight: bold;">instanceof</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja.wieldWeapon<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja <span style="color: #859900; font-weight: bold;">instanceof</span> <span style="color: #b58900;">Person</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja.dance<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja.name<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Bob                                            //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">---------------------------                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yoshi                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Chapter 8: Controlling acces to objects</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>通过前面的章节,我们了解到,在js里面,object非常的灵活,可以增加更改,甚至删除object
的property,本章我们学习管理我们object的办法(控制访问,监督改变,等等)
</li>
</ul>
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Controlling access to properties with getters and setters</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>先看下面的代码
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">(</span><span style="color: #268bd2;">level</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    <span style="color: #268bd2; font-weight: bold;">this</span>.skillLevel = level;
<span style="color: #2aa198;">}</span>
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">(</span>100<span style="color: #2aa198;">)</span>;
</pre>
</div>
</li>
<li>这里,我们定义了ctor,在初始化object ninja的时候,我们赋予了这个object一个100,
作为初始化值来初始化object的内部state: skillLevel.如果我们想更改object的内
部state,我们可以使用最简单的代码,如下
<div class="org-src-container">

<pre class="src src-js">ninja.skillLevel = 20;
</pre>
</div>
</li>
<li>上面的做法过于的随意,所以我们希望能够做到如下的'限制':
<ul class="org-ul">
<li>我们希望能够正确的设置property,比如我们不希望把level设置成字符串,比如
<div class="org-src-container">

<pre class="src src-js">ninja.skillLevel = <span style="color: #2aa198;">"high"</span>
</pre>
</div>
</li>
<li>我们希望log所有对于skillLevel的改动
</li>
<li>我们要能可以获得skillLevel的值
</li>
</ul>
</li>
<li>满足上面三个'限制'要求的,其实就是传统意义上的getter和setter,我们来看看如何
实现一个最naive的版本
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">skillLevel</span>;

    <span style="color: #268bd2; font-weight: bold;">this</span>.getSkillLevel = <span style="color: #b58900;">()</span> =&gt; skillLevel;

    <span style="color: #268bd2; font-weight: bold;">this</span>.setSkillLevel = value =&gt; <span style="color: #b58900;">{</span>
        skillLevel = value;
    <span style="color: #b58900;">}</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;
ninja.setSkillLevel<span style="color: #2aa198;">(</span>100<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja.getSkillLevel<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">100                                            //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>把skillLevel设置成"private"从而只能使用getter和setter访问,这是我们前面学到
过的知识了,而如果我们想log所有的访问,也很简单:在setter和getter里面log就可以
了,因为所有的访问只能通过做两个函数
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">skillLevel</span>;
    <span style="color: #268bd2; font-weight: bold;">this</span>.getSkillLevel = <span style="color: #b58900;">()</span> =&gt; <span style="color: #b58900;">{</span>
        console.log<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Getting skill level value"</span><span style="color: #268bd2;">)</span>;
        <span style="color: #859900; font-weight: bold;">return</span> skillLevel;
    <span style="color: #b58900;">}</span>;

    <span style="color: #268bd2; font-weight: bold;">this</span>.setSkillLevel = value =&gt; <span style="color: #b58900;">{</span>
        console.log<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Modifying skillLevel property from: "</span>,
            skillLevel, <span style="color: #2aa198;">"to: "</span>, value<span style="color: #268bd2;">)</span>;
        skillLevel = value;
    <span style="color: #b58900;">}</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;
ninja.setSkillLevel<span style="color: #2aa198;">(</span>100<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja.getSkillLevel<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">/////////////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt;          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Modifying skillLevel property from:  undefined to:  100 //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Getting skill level value                               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">100                                                     //</span>
<span style="color: #93a1a1;">/////////////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>这看起来很完美了,但是用户希望更简洁的方式使用setter和getter,就是使用一个
ninja.skillLevel来进行set和get.但是同时还希望保留比如log这种功能.这个时候js
就设计出了"实际上是函数(所以可以在里面写log)",但"用起来当property一样"的"理
想型"的setter getter
</li>
</ul>
</div>
<div id="outline-container-sec-2-1-1" class="outline-4">
<h4 id="sec-2-1-1">Defining getters and setters</h4>
<div class="outline-text-4" id="text-2-1-1">
<ul class="org-ul">
<li>在js里面,上面我们提到的"理想型的"setter和getter可以使用如下两种方式定义:
<ul class="org-ul">
<li>在object里面,使用object literal(或者ES6的class语法)
</li>
<li>使用内置的一个叫做Object.defineProperty的方法
</li>
</ul>
</li>
<li>首先看看object literal的方式
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjaCollection</span> = <span style="color: #2aa198;">{</span>
    ninjas: <span style="color: #b58900;">[</span><span style="color: #2aa198;">"Yoshi"</span>, <span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span><span style="color: #b58900;">]</span>,
    get firstNinja<span style="color: #b58900;">(){</span>
        console.log<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Getting firstNinja"</span><span style="color: #268bd2;">)</span>;
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">this</span>.ninjas<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span>;
    <span style="color: #b58900;">}</span>,
    set firstNinja<span style="color: #b58900;">(</span>value<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
        console.log<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Setting firstNinja"</span><span style="color: #268bd2;">)</span>;
        <span style="color: #268bd2; font-weight: bold;">this</span>.ninjas<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span> = value;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>;

console.log<span style="color: #2aa198;">(</span>ninjaCollection.firstNinja<span style="color: #2aa198;">)</span>;

ninjaCollection.firstNinja = <span style="color: #2aa198;">"Hachi"</span>;

console.log<span style="color: #2aa198;">(</span>ninjaCollection.firstNinja<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjaCollection.ninjas<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Getting firstNinja                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yoshi                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Setting firstNinja                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Getting firstNinja                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hachi                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hachi                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>好,我们再看看使用ES6的class语法,效果如下
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">class</span> NinjaCollection <span style="color: #2aa198;">{</span>
    constructor<span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #268bd2; font-weight: bold;">this</span>.ninjas = <span style="color: #268bd2;">[</span><span style="color: #2aa198;">"Yoshi"</span>, <span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span><span style="color: #268bd2;">]</span>;
    <span style="color: #b58900;">}</span>
    get firstNinja<span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        console.log<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Getting firstNinja"</span><span style="color: #268bd2;">)</span>;
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">this</span>.ninjas<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span>;
    <span style="color: #b58900;">}</span>
    set firstNinja<span style="color: #b58900;">(</span>value<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
        console.log<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Setting firstNinja"</span><span style="color: #268bd2;">)</span>;
        <span style="color: #268bd2; font-weight: bold;">this</span>.ninjas<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span> = value;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>;

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjaCollection</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">NinjaCollection</span><span style="color: #2aa198;">()</span>;

console.log<span style="color: #2aa198;">(</span>ninjaCollection.firstNinja<span style="color: #2aa198;">)</span>;

ninjaCollection.firstNinja = <span style="color: #2aa198;">"Hachi"</span>;

console.log<span style="color: #2aa198;">(</span>ninjaCollection.firstNinja<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjaCollection.ninjas<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Getting firstNinja                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yoshi                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Setting firstNinja                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Getting firstNinja                             //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hachi                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hachi                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>object literal和es6 class中定义setter和getter的语法其实是一致的.我们同时还
知道,在class里面定义函数,其实就相当于在proptype里面定义函数,定义的函数是'无
法访问function的private variable'的,所以我们前面的使用closure来模拟private
variable的方法在这里行不通!需要其他的手段
</li>
<li>其他的手段就是Object.defineProperty方法啦
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">_skillLevel</span> = 0;

    Object.defineProperty<span style="color: #b58900;">(</span><span style="color: #268bd2; font-weight: bold;">this</span>, <span style="color: #2aa198;">'skillLevel'</span>, <span style="color: #268bd2;">{</span>
        get: <span style="color: #6c71c4;">()</span> =&gt; <span style="color: #6c71c4;">{</span>
            console.log<span style="color: #859900;">(</span><span style="color: #2aa198;">"The get method is called"</span><span style="color: #859900;">)</span>;
            <span style="color: #859900; font-weight: bold;">return</span> _skillLevel;
        <span style="color: #6c71c4;">}</span>,
        set: value =&gt; <span style="color: #6c71c4;">{</span>
            console.log<span style="color: #859900;">(</span><span style="color: #2aa198;">"The set method is called"</span><span style="color: #859900;">)</span>;
            _skillLevel = value;
        <span style="color: #6c71c4;">}</span>
    <span style="color: #268bd2;">}</span><span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;

console.log<span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">typeof</span> ninja._skillLevel<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninja.skillLevel<span style="color: #2aa198;">)</span>;
ninja.skillLevel = 10;
console.log<span style="color: #2aa198;">(</span>ninja.skillLevel<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">undefined                                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">The get method is called                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">The set method is called                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">The get method is called                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">10                                             //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>使用defineProperty的方法定义函数和'object literal以及class'的不同,就在于他
们和'private variable'定义在同一个scope(function scope),所以可以看到并访问
'private variable'
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-1-2" class="outline-4">
<h4 id="sec-2-1-2">Using getters and setters to validate property values</h4>
<div class="outline-text-4" id="text-2-1-2">
<ul class="org-ul">
<li>我们知道,getter和setter设置了以后,会成为我们访问'内部state'是唯一的方式,那
么,我们就可以在这一条"必经之路"上做些文章,比如validate传入的数据
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">Ninja</span><span style="color: #2aa198;">()</span> <span style="color: #2aa198;">{</span>
    <span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">_skillLevel</span> = 0;

    Object.defineProperty<span style="color: #b58900;">(</span><span style="color: #268bd2; font-weight: bold;">this</span>, <span style="color: #2aa198;">'skillLevel'</span>, <span style="color: #268bd2;">{</span>
        get: <span style="color: #6c71c4;">()</span> =&gt; _skillLevel,
        set: value =&gt; <span style="color: #6c71c4;">{</span>
            <span style="color: #859900; font-weight: bold;">if</span><span style="color: #859900;">(</span>!Number.isInteger<span style="color: #b58900;">(</span>value<span style="color: #b58900;">)</span><span style="color: #859900;">)</span> <span style="color: #859900;">{</span>
                <span style="color: #859900; font-weight: bold;">throw</span> <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">TypeError</span><span style="color: #b58900;">(</span><span style="color: #2aa198;">"Skill level should be a number"</span><span style="color: #b58900;">)</span>;
            <span style="color: #859900;">}</span>
            _skillLevel = value;
        <span style="color: #6c71c4;">}</span>
    <span style="color: #268bd2;">}</span><span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Ninja</span><span style="color: #2aa198;">()</span>;

ninja.skillLevel = 10;
console.log<span style="color: #2aa198;">(</span>ninja.skillLevel<span style="color: #2aa198;">)</span>;

<span style="color: #859900; font-weight: bold;">try</span> <span style="color: #2aa198;">{</span>
    ninja.skillLevel = <span style="color: #2aa198;">"Great"</span>;
    console.log<span style="color: #b58900;">(</span><span style="color: #2aa198;">"Failed!, should not be here"</span><span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span> <span style="color: #859900; font-weight: bold;">catch</span><span style="color: #2aa198;">(</span>e<span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    console.log<span style="color: #b58900;">(</span><span style="color: #2aa198;">"Passed! setting a non-integer value throws an exception"</span><span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">/////////////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt;          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">10                                                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Passed! setting a non-integer value throws an exception //</span>
<span style="color: #93a1a1;">/////////////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>getter和setter还有一种用法,就是计算computed property:不是简单的设置和返回
内部的state,而是把内部的state进行'计算'后返回或设置
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">shogun</span> = <span style="color: #2aa198;">{</span>
    name: <span style="color: #2aa198;">"Yoshiaki"</span>,
    clan: <span style="color: #2aa198;">"Ashikaga"</span>,

    get fullTitle<span style="color: #b58900;">()</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">this</span>.name + <span style="color: #2aa198;">" "</span> + <span style="color: #268bd2; font-weight: bold;">this</span>.clan;
    <span style="color: #b58900;">}</span>,

    set fullTitle<span style="color: #b58900;">(</span>value<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">segments</span> = value.split<span style="color: #268bd2;">(</span><span style="color: #2aa198;">" "</span><span style="color: #268bd2;">)</span>;
        <span style="color: #268bd2; font-weight: bold;">this</span>.name = segments<span style="color: #268bd2;">[</span>0<span style="color: #268bd2;">]</span>;
        <span style="color: #268bd2; font-weight: bold;">this</span>.clan = segments<span style="color: #268bd2;">[</span>1<span style="color: #268bd2;">]</span>;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>;

console.log<span style="color: #2aa198;">(</span>shogun.name<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>shogun.clan<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>shogun.fullTitle<span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"----------------"</span><span style="color: #2aa198;">)</span>;
shogun.fullTitle = <span style="color: #2aa198;">"Leyasu Tokugawa"</span>;

console.log<span style="color: #2aa198;">(</span>shogun.name<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>shogun.clan<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>shogun.fullTitle<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yoshiaki                                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Ashikaga                                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yoshiaki Ashikaga                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">----------------                               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Leyasu                                         //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Tokugawa                                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Leyasu Tokugawa                                //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Using proxies to control access</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>我们的getter和setter都是去保护对一个object的'读取和吸入',从更广义上来讲'proxy'
这个概念是能保护'所有的访问,包括读取和写入', 公司内网都是通过proxy和外部接
触的,从而保护内网的机器
</li>
<li>es6在js里面也引入了proxy这个概念,用来"保护所有对object的访问", 包括:
<ul class="org-ul">
<li>读取
</li>
<li>写入
</li>
<li>method call
</li>
</ul>
</li>
<li>我们先来看看一个proxy的例子
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">emperor</span> = <span style="color: #2aa198;">{</span>
    name: <span style="color: #2aa198;">"Komei"</span>
<span style="color: #2aa198;">}</span>;
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">representative</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Proxy</span><span style="color: #2aa198;">(</span>emperor, <span style="color: #b58900;">{</span>
    get: <span style="color: #268bd2;">(</span>target, key<span style="color: #268bd2;">)</span> =&gt; <span style="color: #268bd2;">{</span>
        console.log<span style="color: #6c71c4;">(</span><span style="color: #2aa198;">"Reading "</span> + key + <span style="color: #2aa198;">" through a proxy"</span><span style="color: #6c71c4;">)</span>;
        <span style="color: #859900; font-weight: bold;">return</span> key <span style="color: #859900; font-weight: bold;">in</span> target ? target<span style="color: #6c71c4;">[</span>key<span style="color: #6c71c4;">]</span> :
            <span style="color: #2aa198;">"Don't bother the emperor!"</span>;
    <span style="color: #268bd2;">}</span>,
    set: <span style="color: #268bd2;">(</span>target, key, value<span style="color: #268bd2;">)</span> =&gt; <span style="color: #268bd2;">{</span>
        console.log<span style="color: #6c71c4;">(</span><span style="color: #2aa198;">"Writing "</span> + key + <span style="color: #2aa198;">" through a proxy"</span><span style="color: #6c71c4;">)</span>;
        target<span style="color: #6c71c4;">[</span>key<span style="color: #6c71c4;">]</span> = value;
    <span style="color: #268bd2;">}</span>
<span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>emperor.name<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"--------------------------------"</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>representative.name<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"--------------------------------"</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>emperor.nickname<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"--------------------------------"</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>representative.nickname<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"--------------------------------"</span><span style="color: #2aa198;">)</span>;
representative.nickname = <span style="color: #2aa198;">"Tenno"</span>;
console.log<span style="color: #2aa198;">(</span>emperor.nickname<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"--------------------------------"</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>representative.nickname<span style="color: #2aa198;">)</span>;


<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Komei                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">--------------------------------               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Reading name through a proxy                   //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Komei                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">--------------------------------               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">undefined                                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">--------------------------------               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Reading nickname through a proxy               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Don't bother the emperor!                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">--------------------------------               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Writing nickname through a proxy               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Tenno                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">--------------------------------               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Reading nickname through a proxy               //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Tenno                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
<div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1">Using proxie for logging</h4>
<div class="outline-text-4" id="text-2-2-1">
<ul class="org-ul">
<li>todo
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2-2" class="outline-4">
<h4 id="sec-2-2-2">Using proxies for measuring performance</h4>
<div class="outline-text-4" id="text-2-2-2">
<ul class="org-ul">
<li>todo
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2-3" class="outline-4">
<h4 id="sec-2-2-3">Using proxies to autopopulate properties</h4>
<div class="outline-text-4" id="text-2-2-3">
<ul class="org-ul">
<li>todo
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2-4" class="outline-4">
<h4 id="sec-2-2-4">Using proxies to implement negative array Indexes</h4>
<div class="outline-text-4" id="text-2-2-4">
<ul class="org-ul">
<li>todo
</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Chapter 9: Dealing with collections</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Arrays</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>数组是最常见的数据结构了,基本所有的语言里面都有数组
</li>
<li>在javascript里面,数组其实就是一个object:
<ul class="org-ul">
<li>这一方面会降低数组的性能
</li>
<li>这另一方面能让数组有些function可供调用
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-sec-3-1-1" class="outline-4">
<h4 id="sec-3-1-1">Creating arrays</h4>
<div class="outline-text-4" id="text-3-1-1">
<ul class="org-ul">
<li>主要有两种方法来创建array:
<ul class="org-ul">
<li>使用内置的Array constructor
</li>
<li>使用literals []
</li>
</ul>
</li>
<li>例子如下
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #2aa198;">[</span><span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span>, <span style="color: #2aa198;">"Yagyu"</span><span style="color: #2aa198;">]</span>;
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">samurai</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Array</span><span style="color: #2aa198;">(</span><span style="color: #2aa198;">"Oda"</span>, <span style="color: #2aa198;">"Tomoe"</span><span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>ninjas.length<span style="color: #2aa198;">)</span>;     <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">3</span>
console.log<span style="color: #2aa198;">(</span>samurai.length<span style="color: #2aa198;">)</span>;    <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2</span>

console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;         <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Kuma</span>
console.log<span style="color: #2aa198;">(</span>samurai<span style="color: #b58900;">[</span>samurai.length-1<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>; <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Tomoe</span>

console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>4<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;         <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">undefined</span>
ninjas<span style="color: #2aa198;">[</span>4<span style="color: #2aa198;">]</span> = <span style="color: #2aa198;">"Ishi"</span>;
console.log<span style="color: #2aa198;">(</span>ninjas.length<span style="color: #2aa198;">)</span>;     <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">5</span>

ninjas.length = 2;
console.log<span style="color: #2aa198;">(</span>ninjas.length<span style="color: #2aa198;">)</span>;     <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2</span>
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;         <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Kuma</span>
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;         <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">undefined</span>

ninjas.length = 5;
console.log<span style="color: #2aa198;">(</span>ninjas.length<span style="color: #2aa198;">)</span>;     <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">5</span>
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;         <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Kuma</span>
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;         <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">undefined</span>
</pre>
</div>
</li>
<li>这个例子最令我们震撼的是,我们竟然可以通过设置数组的长度来去掉后面某些item,
注意,这里不是像c语言一样会把内存放在那里不去清理,一旦设置了length,后面的内
存就被收走了"Yagyu"再也找不到了
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-2" class="outline-4">
<h4 id="sec-3-1-2">Adding and removing Items at either end of an array</h4>
<div class="outline-text-4" id="text-3-1-2">
<ul class="org-ul">
<li>添加删除数组的成员从两头都可以:
<ul class="org-ul">
<li>push() adds an item to the end of array
</li>
<li>pop() removes an item from the end of array
</li>
<li>unshift() add an item to the beginning of the array
</li>
<li>shift() removes an item from the beginning of the array.
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-3" class="outline-4">
<h4 id="sec-3-1-3">Adding and removing items at any array location</h4>
<div class="outline-text-4" id="text-3-1-3">
<ul class="org-ul">
<li>js里面的delete函数很特别,它其实不是其他语言里面删除一个数组成员,而是把某个
成员设置成undefined
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #2aa198;">[</span><span style="color: #2aa198;">"Yagyu"</span>, <span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span>, <span style="color: #2aa198;">"Fuma"</span><span style="color: #2aa198;">]</span>;

<span style="color: #859900; font-weight: bold;">delete</span> ninjas<span style="color: #2aa198;">[</span>1<span style="color: #2aa198;">]</span>;

console.log<span style="color: #2aa198;">(</span>ninjas.length<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #b58900;">[</span>3<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">4                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yagyu                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">undefined                                      //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hattori                                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Fuma                                           //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>上面的例子用图画表示就是
<pre class="example">
const ninjas = ["Yagyu", "Kuma", "Hattori", "Fuma"];
+-----------+-----------+-----------+-----------+
|   Yagyu   |    Kuma   |  Hattori  |    Fuma   |
+-----------+-----------+-----------+-----------+

delete ninjas[1];
+-----------+-----------+-----------+-----------+
|   Yagyu   | undefined |  Hattori  |    Fuma   |
+-----------+-----------+-----------+-----------+
</pre>
</li>
<li>js里面真正起到删除作用的是splice, 它的返回值就是'真正删除掉的sub数组'
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #2aa198;">[</span><span style="color: #2aa198;">"Yagyu"</span>, <span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span>, <span style="color: #2aa198;">"Fuma"</span><span style="color: #2aa198;">]</span>;

<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">removedItems</span> = ninjas.splice<span style="color: #2aa198;">(</span>1, 1<span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>removedItems<span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>ninjas.length<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 'Kuma' ]                                     //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">3                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 'Yagyu', 'Hattori', 'Fuma' ]                 //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>splice还可以"在删除的同时,在删除的位置再添加数据",返回值还是删除了的子数组
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #2aa198;">[</span><span style="color: #2aa198;">"Yagyu"</span>, <span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span>, <span style="color: #2aa198;">"Fuma"</span><span style="color: #2aa198;">]</span>;

<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">removedItems</span> = ninjas.splice<span style="color: #2aa198;">(</span>1, 2, <span style="color: #2aa198;">"Mochizuki"</span>, <span style="color: #2aa198;">"Yoshi"</span>, <span style="color: #2aa198;">"Momochi"</span><span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>removedItems<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjas<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">//////////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt;       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 'Kuma', 'Hattori' ]                                //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 'Yagyu', 'Mochizuki', 'Yoshi', 'Momochi', 'Fuma' ] //</span>
<span style="color: #93a1a1;">//////////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-4" class="outline-4">
<h4 id="sec-3-1-4">Common operations on arrays</h4>
<div class="outline-text-4" id="text-3-1-4">
</div><div id="outline-container-sec-3-1-4-1" class="outline-5">
<h5 id="sec-3-1-4-1">ITERATING OVER ARRAYS</h5>
<div class="outline-text-5" id="text-3-1-4-1">
<ul class="org-ul">
<li>对数组来说,遍历是最常见的操作,最开始的时候js是使用和c差不多的循环进行遍历
的:
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #2aa198;">[</span><span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span>, <span style="color: #2aa198;">"Yagyu"</span><span style="color: #2aa198;">]</span>;

<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">i</span> = 0; i &lt; ninjas.length; i++<span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
    console.log<span style="color: #b58900;">(</span>ninjas<span style="color: #268bd2;">[</span>i<span style="color: #268bd2;">]</span><span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Kuma                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hattori                                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yagyu                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>后来js引入了更加functional的forEach,参数是一个"马上被调用"的callback
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #2aa198;">[</span><span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span>, <span style="color: #2aa198;">"Yagyu"</span><span style="color: #2aa198;">]</span>;

ninjas.forEach<span style="color: #2aa198;">(</span>ninja =&gt; <span style="color: #b58900;">{</span>
    console.log<span style="color: #268bd2;">(</span>ninja<span style="color: #268bd2;">)</span>;
<span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Kuma                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hattori                                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yagyu                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-4-2" class="outline-5">
<h5 id="sec-3-1-4-2">MAPPING ARRAYS</h5>
<div class="outline-text-5" id="text-3-1-4-2">
<ul class="org-ul">
<li>map reduce也是functional语言里面的重要概念,js也引入了.引入方法和forEach一
样:得益于array就是一个object,直接在Array.propotype里面添加这个函数,那么所
有的array就都可以调用这个函数了
</li>
<li>来看看map的调用例子
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #2aa198;">[</span><span style="color: #b58900;">{</span>
    name: <span style="color: #2aa198;">"Yagyu"</span>,
    weapon: <span style="color: #2aa198;">"shuriken"</span>
<span style="color: #b58900;">}</span>, <span style="color: #b58900;">{</span>
    name: <span style="color: #2aa198;">"Yoshi"</span>,
    weapon: <span style="color: #2aa198;">"katana"</span>
<span style="color: #b58900;">}</span>, <span style="color: #b58900;">{</span>
    name: <span style="color: #2aa198;">"Kuma"</span>,
    weapon: <span style="color: #2aa198;">"wakizashi"</span>
<span style="color: #b58900;">}</span><span style="color: #2aa198;">]</span>;

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">weapons</span> = ninjas.map<span style="color: #2aa198;">(</span>ninja =&gt; ninja.weapon<span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>weapons<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 'shuriken', 'katana', 'wakizashi' ]          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-4-3" class="outline-5">
<h5 id="sec-3-1-4-3">AGGREGATING ARRAY ITEMS</h5>
<div class="outline-text-5" id="text-3-1-4-3">
<ul class="org-ul">
<li>有了map, reduce还远么
<div class="org-src-container">

<pre class="src src-js"><span style="color: #2aa198;">[</span>1, 3, 5, 7, 2, 4, 6<span style="color: #2aa198;">]</span>.reduce<span style="color: #2aa198;">(</span><span style="color: #b58900;">(</span>sum, cur<span style="color: #b58900;">)</span> =&gt; sum + cur<span style="color: #2aa198;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">28</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-4-4" class="outline-5">
<h5 id="sec-3-1-4-4">TESTING ARRAY ITEMS</h5>
<div class="outline-text-5" id="text-3-1-4-4">
<ul class="org-ul">
<li>ruby里面有个叫做all?的函数,就是通过一个block来判断数组的每个成员是不是都
是满足block里面的要求
<div class="org-src-container">

<pre class="src src-ruby"><span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.all? <span style="color: #2aa198;">{</span> |one| one &gt;= 1 <span style="color: #2aa198;">}</span> <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">=&gt; true</span>
<span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.all? <span style="color: #2aa198;">{</span> |one| one &gt; 1 <span style="color: #2aa198;">}</span> <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">=&gt; false</span>
</pre>
</div>
</li>
<li>js里面借鉴这个all?的功能,设计了一个Array.propotype.every()
<div class="org-src-container">

<pre class="src src-js"><span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.every<span style="color: #2aa198;">(</span>one =&gt; one &gt;= 1<span style="color: #2aa198;">)</span>; <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true</span>
<span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.every<span style="color: #2aa198;">(</span>one =&gt; one &gt; 1<span style="color: #2aa198;">)</span>; <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false</span>
</pre>
</div>
</li>
<li>同样的ruby里面还有一个判断某个成员满足要求的any?
<div class="org-src-container">

<pre class="src src-ruby"><span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.any? <span style="color: #2aa198;">{</span> |one| one &gt;= 5 <span style="color: #2aa198;">}</span> <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">=&gt; true</span>
<span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.any? <span style="color: #2aa198;">{</span> |one| one &gt; 5 <span style="color: #2aa198;">}</span> <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">=&gt; false</span>
</pre>
</div>
</li>
<li>js的对应者是some()
<div class="org-src-container">

<pre class="src src-js"><span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.some<span style="color: #2aa198;">(</span>one =&gt; one &gt;= 5<span style="color: #2aa198;">)</span>; <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true</span>
<span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.some<span style="color: #2aa198;">(</span>one =&gt; one &gt; 5<span style="color: #2aa198;">)</span>; <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-4-5" class="outline-5">
<h5 id="sec-3-1-4-5">SEARCHING ARRAYS</h5>
<div class="outline-text-5" id="text-3-1-4-5">
<ul class="org-ul">
<li>ruby里面就有find(也叫detect)命令
<div class="org-src-container">

<pre class="src src-ruby"><span style="color: #2aa198;">(</span>1..10<span style="color: #2aa198;">)</span>.detect   <span style="color: #2aa198;">{</span> |i| i % 5 == 0 <span style="color: #859900; font-weight: bold;">and</span> i % 7 == 0 <span style="color: #2aa198;">}</span>   <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">=&gt; nil</span>
<span style="color: #2aa198;">(</span>1..100<span style="color: #2aa198;">)</span>.find    <span style="color: #2aa198;">{</span> |i| i % 5 == 0 <span style="color: #859900; font-weight: bold;">and</span> i % 7 == 0 <span style="color: #2aa198;">}</span>   <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">=&gt; 35</span>
</pre>
</div>
</li>
<li>js的对应还是find
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #2aa198;">[</span>
    <span style="color: #b58900;">{</span>name: <span style="color: #2aa198;">"Yagyu"</span>, weapon: <span style="color: #2aa198;">"shuriken"</span><span style="color: #b58900;">}</span>,
    <span style="color: #b58900;">{</span>name: <span style="color: #2aa198;">"Yoshi"</span><span style="color: #b58900;">}</span>,
    <span style="color: #b58900;">{</span>name: <span style="color: #2aa198;">"Kuma"</span>, weapon: <span style="color: #2aa198;">"wakizashi"</span><span style="color: #b58900;">}</span>
<span style="color: #2aa198;">]</span>;

console.log<span style="color: #2aa198;">(</span>ninjas.find<span style="color: #b58900;">(</span>ninja =&gt; ninja.weapon === <span style="color: #2aa198;">"wakizashi"</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{ name: 'Kuma', weapon: 'wakizashi' }          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>find命令(无论ruby还是js)都是只返回一个结果,如果想返回多个结果:
<ul class="org-ul">
<li>ruby里面是select
<div class="org-src-container">

<pre class="src src-ruby"><span style="color: #2aa198;">[</span>1,2,3,4,5<span style="color: #2aa198;">]</span>.select <span style="color: #2aa198;">{</span> |num|  num.even?  <span style="color: #2aa198;">}</span>   <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">=&gt; [2, 4]</span>
</pre>
</div>
</li>
<li>js里面是filter
<div class="org-src-container">

<pre class="src src-js"><span style="color: #2aa198;">[</span>1, 2, 3, 4, 5<span style="color: #2aa198;">]</span>.filter<span style="color: #2aa198;">(</span>one =&gt; one % 2 === 0<span style="color: #2aa198;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 2, 4 ]</span>
</pre>
</div>
</li>
</ul>
</li>
<li>寻找array成员的index使用indexOf和lastIndexOf
<div class="org-src-container">

<pre class="src src-js"><span style="color: #2aa198;">[</span>1, 2, 3, 4, 5, 1<span style="color: #2aa198;">]</span>.indexOf<span style="color: #2aa198;">(</span>1<span style="color: #2aa198;">)</span>   <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">0</span>
<span style="color: #2aa198;">[</span>1, 2, 3, 4, 5, 1<span style="color: #2aa198;">]</span>.lastIndexOf<span style="color: #2aa198;">(</span>1<span style="color: #2aa198;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">5</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-4-6" class="outline-5">
<h5 id="sec-3-1-4-6">SORTING ARRAYS</h5>
<div class="outline-text-5" id="text-3-1-4-6">
<ul class="org-ul">
<li>sorting是经常拿来举例子的功能,相比大家非常熟悉:
<div class="org-src-container">

<pre class="src src-js"><span style="color: #2aa198;">[</span>1, 3, 5, 7, 2, 4, 6<span style="color: #2aa198;">]</span>.sort<span style="color: #2aa198;">(</span><span style="color: #b58900;">(</span>a, b<span style="color: #b58900;">)</span> =&gt; a - b<span style="color: #2aa198;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 1, 2, 3, 4, 5, 6, 7 ]</span>
</pre>
</div>
</li>
<li>js的sort有一定的内在逻辑:
<ul class="org-ul">
<li>如果callback返回值小于0,那么a就b前面(自然顺序)
</li>
<li>如果callback返回值为0,a和b是平等的
</li>
<li>如果callback返回值大于0,那么a就在b后面
</li>
</ul>
</li>
<li>所以如果想逆序排序呢,就是后面减去前面
<div class="org-src-container">

<pre class="src src-js"><span style="color: #2aa198;">[</span>1, 3, 5, 7, 2, 4, 6<span style="color: #2aa198;">]</span>.sort<span style="color: #2aa198;">(</span><span style="color: #b58900;">(</span>a, b<span style="color: #b58900;">)</span> =&gt; b - a<span style="color: #2aa198;">)</span> <span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 7, 6, 5, 4, 3, 2, 1 ]</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-3-1-5" class="outline-4">
<h4 id="sec-3-1-5">Resuing built-in array functions</h4>
<div class="outline-text-4" id="text-3-1-5">
<ul class="org-ul">
<li>我们完全可以使用object来模拟数组,但是不推荐
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Maps</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>在以前,当我们要使用map这种数据结构的时候,object看起来是一个天然的map
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">dictionary</span> = <span style="color: #2aa198;">{</span>
  <span style="color: #2aa198;">"one"</span>: 1,
  <span style="color: #2aa198;">"two"</span>: 2,
  <span style="color: #2aa198;">"three"</span>: 3
<span style="color: #2aa198;">}</span>;
</pre>
</div>
</li>
<li>这种"看起来没什么问题"的例子却隐藏着很多问题,比如我们试图访问dictionary的域
constructor,本来应该返回undefined,却返回了function值!
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">dictionary</span> = <span style="color: #2aa198;">{</span>
  <span style="color: #2aa198;">"one"</span>: 1,
  <span style="color: #2aa198;">"two"</span>: 2,
  <span style="color: #2aa198;">"three"</span>: 3
<span style="color: #2aa198;">}</span>;


console.log<span style="color: #2aa198;">(</span>dictionary<span style="color: #b58900;">[</span><span style="color: #2aa198;">"constructor"</span><span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[Function: Object]                             //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
<li>原因很简单, 所有的objects都会有prototype, 刚好constructor是这个dictionary的
prototype里面"内置"的几个property
</li>
<li>使用object作为Map的另外一个问题,就是object的key,只能是string,所以有时候你的
key不是string的话,会强制调用toString(),这不是我们想要的
</li>
</ul>
</div>
<div id="outline-container-sec-3-2-1" class="outline-4">
<h4 id="sec-3-2-1">Creating our first map</h4>
<div class="outline-text-4" id="text-3-2-1">
<ul class="org-ul">
<li>针对object作为map的各种弊端,我们的es6推出了一个新的内置的容器:map
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjaIslandMap</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Map</span><span style="color: #2aa198;">()</span>;

<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja1</span> = <span style="color: #2aa198;">{</span> name: <span style="color: #2aa198;">"Yoshi"</span><span style="color: #2aa198;">}</span>;
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja2</span> = <span style="color: #2aa198;">{</span> name: <span style="color: #2aa198;">"Hattori"</span><span style="color: #2aa198;">}</span>;
<span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninja3</span> = <span style="color: #2aa198;">{</span> name: <span style="color: #2aa198;">"Kuma"</span><span style="color: #2aa198;">}</span>;

ninjaIslandMap.set<span style="color: #2aa198;">(</span>ninja1, <span style="color: #b58900;">{</span>homeIsland: <span style="color: #2aa198;">"Honshu"</span><span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>;
ninjaIslandMap.set<span style="color: #2aa198;">(</span>ninja2, <span style="color: #b58900;">{</span>homeIsland: <span style="color: #2aa198;">"Hokkaido"</span><span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>ninjaIslandMap.get<span style="color: #b58900;">(</span>ninja1<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjaIslandMap.get<span style="color: #b58900;">(</span>ninja2<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>;


console.log<span style="color: #2aa198;">(</span>ninjaIslandMap.has<span style="color: #b58900;">(</span>ninja1<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjaIslandMap.has<span style="color: #b58900;">(</span>ninja3<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjaIslandMap.size<span style="color: #2aa198;">)</span>;
ninjaIslandMap.<span style="color: #859900; font-weight: bold;">delete</span><span style="color: #2aa198;">(</span>ninja1<span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjaIslandMap.size<span style="color: #2aa198;">)</span>;

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{ homeIsland: 'Honshu' }                       //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">{ homeIsland: 'Hokkaido' }                     //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">2                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">1                                              //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-2-2" class="outline-4">
<h4 id="sec-3-2-2">Iterating over maps</h4>
<div class="outline-text-4" id="text-3-2-2">
<ul class="org-ul">
<li>我们可以使用所有对数组奏效的循环手段,外加map增加了两个函数:
<ul class="org-ul">
<li>keys()返回所有的key作为一个数组访问
</li>
<li>values()返回所有的value作为一个数组访问
</li>
</ul>
</li>
<li>例子如下
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">directory</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Map</span><span style="color: #2aa198;">()</span>;

directory.set<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"Yoshi"</span>, <span style="color: #2aa198;">"+81 26 6462"</span><span style="color: #2aa198;">)</span>;
directory.set<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"+81 522378 6462"</span><span style="color: #2aa198;">)</span>;
directory.set<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"Hiro"</span>, <span style="color: #2aa198;">"+81 76 277 46"</span><span style="color: #2aa198;">)</span>;

<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">item</span> of directory<span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
  console.log<span style="color: #b58900;">(</span>item<span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">key</span> of directory.keys<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
  console.log<span style="color: #b58900;">(</span>key<span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">value</span> of directory.values<span style="color: #b58900;">()</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
  console.log<span style="color: #b58900;">(</span>value<span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 'Yoshi', '+81 26 6462' ]                     //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 'Kuma', '+81 522378 6462' ]                  //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">[ 'Hiro', '+81 76 277 46' ]                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yoshi                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Kuma                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hiro                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">+81 26 6462                                    //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">+81 522378 6462                                //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">+81 76 277 46                                  //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Sets</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>set 也是es6的新feature,使用方法和map也差不多
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">const</span> <span style="color: #268bd2;">ninjas</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Set</span><span style="color: #2aa198;">(</span><span style="color: #b58900;">[</span><span style="color: #2aa198;">"Kuma"</span>, <span style="color: #2aa198;">"Hattori"</span>, <span style="color: #2aa198;">"Yagyu"</span>, <span style="color: #2aa198;">"Hattori"</span><span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>ninjas.has<span style="color: #b58900;">(</span><span style="color: #2aa198;">"Hattori"</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjas.size<span style="color: #2aa198;">)</span>;

console.log<span style="color: #2aa198;">(</span>ninjas.has<span style="color: #b58900;">(</span><span style="color: #2aa198;">"YoShi"</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>;
ninjas.add<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"YoShi"</span><span style="color: #2aa198;">)</span>;
console.log<span style="color: #2aa198;">(</span>ninjas.size<span style="color: #2aa198;">)</span>;

<span style="color: #859900; font-weight: bold;">for</span> <span style="color: #2aa198;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">ninja</span> of ninjas<span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
  console.log<span style="color: #b58900;">(</span>ninja<span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">&lt;===================OUTPUT===================&gt; //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">true                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">3                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">false                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">4                                              //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Kuma                                           //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Hattori                                        //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">Yagyu                                          //</span>
<span style="color: #93a1a1;">// </span><span style="color: #93a1a1;">YoShi                                          //</span>
<span style="color: #93a1a1;">////////////////////////////////////////////////////</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Chapter 10: Wrangling regular expresions</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>现在的程序开发完全离不开正则表达式,虽然可以避免使用正则表达式,但是很多长达半
页的代码可能只需要一行正则表达式来进行处理
</li>
<li>打开每一个js的库,你都会发现,在如下的几种任务中,正则表达式的应用最为流行:
<ul class="org-ul">
<li>处理HTML nodes字符串
</li>
<li>在CSS selector表达式中定位某些selector
</li>
<li>确定某个element时候具有一个特定的classname
</li>
<li>input validation
</li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Why regular expressions rock</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>先看一个正则表达式的例子,我们要验证用户在form里面的输入是不是符合US的九位邮
政编码.postal code(也叫ZIP code)的格式如下
<pre class="example">
99999-9999
</pre>
</li>
<li>我们先来看看,"半页"的很容易写出bug的代码
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">isThisAZipCode</span><span style="color: #2aa198;">(</span><span style="color: #268bd2;">candidate</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
  <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">typeof</span> candidate !== <span style="color: #2aa198;">"string"</span> ||
      candidate.length != 1<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
    <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">false</span>;
  <span style="color: #b58900;">}</span>

  <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #b58900;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">n</span> = 0; n &lt; candidate.length; n++<span style="color: #b58900;">)</span> <span style="color: #b58900;">{</span>
    <span style="color: #859900; font-weight: bold;">let</span> <span style="color: #268bd2;">c</span> = candidate<span style="color: #268bd2;">[</span>n<span style="color: #268bd2;">]</span>;
    <span style="color: #859900; font-weight: bold;">switch</span><span style="color: #268bd2;">(</span>n<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">{</span>
    <span style="color: #859900; font-weight: bold;">case</span> 0: <span style="color: #859900; font-weight: bold;">case</span> 1: <span style="color: #859900; font-weight: bold;">case</span> 2: <span style="color: #859900; font-weight: bold;">case</span> 3: <span style="color: #859900; font-weight: bold;">case</span> 4:
    <span style="color: #859900; font-weight: bold;">case</span> 6: <span style="color: #859900; font-weight: bold;">case</span> 7: <span style="color: #859900; font-weight: bold;">case</span> 8: <span style="color: #859900; font-weight: bold;">case</span> 9:
      <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span> c &lt; <span style="color: #2aa198;">'0'</span> || c &gt; <span style="color: #2aa198;">'9'</span><span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">{</span>
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">false</span>;
      <span style="color: #6c71c4;">}</span>
    <span style="color: #859900; font-weight: bold;">case</span> 5:
      <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span>c != <span style="color: #2aa198;">'-'</span><span style="color: #6c71c4;">)</span> <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">false</span>;
      <span style="color: #859900; font-weight: bold;">break</span>;
    <span style="color: #268bd2;">}</span>
  <span style="color: #b58900;">}</span>
  <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">true</span>;
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>然后我们再来看看我们的"一行"正则表达式. 高下立判
<div class="org-src-container">

<pre class="src src-js"><span style="color: #859900; font-weight: bold;">function</span> <span style="color: #268bd2;">isThisAZipCode</span><span style="color: #2aa198;">(</span><span style="color: #268bd2;">candidate</span><span style="color: #2aa198;">)</span> <span style="color: #2aa198;">{</span>
  <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #2aa198;">/^\d{5}-\d{4}$/</span>.test<span style="color: #b58900;">(</span>candidate<span style="color: #b58900;">)</span>;
<span style="color: #2aa198;">}</span>
</pre>
</div>
</li>
<li>TODO
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Chapter 11: Code modularization techniques</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>目前为止,我们已经了解了javascript的主要特性,比如function, object, collection,
regular expression
</li>
<li>这些特性可以帮助我们解决一个特定的问题, 但是,当我们的代码急剧膨胀的时候,我们
迫切的需要一种方法来帮助我们组织管理代码.
</li>
<li>现代的代码管理系统已经证明,一个大的代码库不利于对代码的理解.所以推荐的方法是
把代码分成相对独立的模块(module),模块间的耦合要松
</li>
<li>如果把object和function看做是我们管理代码的小的单元的话,那么module就是一个比
较大的管理代码的单元
</li>
<li>如果你了解js的话,你会发现js原来在global vairable上面的使用太多了.每当我们在
全局使用var定义一个变量,或者在function里面忘记使用var来定义'局部变量'的时候,
总会产生一个全局变量
</li>
<li>全局变量在软件工程上面被看做是一个anti-pattern,因为代码库任何地方的代码都可
以去更改这个变量
</li>
</ul>
</div>
<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">Modularizing code in pre-ES6 JavaScript</h3>
</div>
</div>
</div>
<div id="postamble" class="status">

         <!-- Disqus Comment BEGIN -->
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              var disqus_shortname = 'harrifeng';

              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

         <!-- Disqus Comment END -->
</div>
</body>
</html>
